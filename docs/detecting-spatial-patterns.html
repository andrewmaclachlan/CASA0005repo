<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Detecting spatial patterns | CASA0005 Geographic Information Systems and Science</title>
  <meta name="description" content="The CASA0005 Geographic Information Systems and Science practical book" />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Detecting spatial patterns | CASA0005 Geographic Information Systems and Science" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://andrewmaclachlan.github.io/CASA0005repo//general_images/casa_logo.png" />
  <meta property="og:description" content="The CASA0005 Geographic Information Systems and Science practical book" />
  <meta name="github-repo" content="andrewmaclachlan/CASA0005repo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Detecting spatial patterns | CASA0005 Geographic Information Systems and Science" />
  
  <meta name="twitter:description" content="The CASA0005 Geographic Information Systems and Science practical book" />
  <meta name="twitter:image" content="https://andrewmaclachlan.github.io/CASA0005repo//general_images/casa_logo.png" />

<meta name="author" content="Andy MacLachlan, Adam Dennett and Claire Dooley" />


<meta name="date" content="2025-07-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="assets/apple-touch-icon.png" />
  <link rel="shortcut icon" href="assets/favicon.ico" type="image/x-icon" />
<link rel="prev" href="map-making.html"/>
<link rel="next" href="spatial-autocorrelation.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet" />
<link href="libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet" />
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.33/datatables.js"></script>
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet" />
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet" />
<script src="libs/selectize-0.12.0/selectize.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<script src="libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.2.2/leaflet.js"></script>
<script src="libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.2.2/leaflet-providers-plugin.js"></script>
<script src="libs/logodeps-1.0.0/logo.js"></script>
<script src="libs/clipboard-0.0.1/setClipboardText.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-151934476-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-151934476-1');
</script>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-7M7GJR768X"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-7M7GJR768X');
</script>
<script src="assets/book.js"></script>

<script>
/* ========================================================================
 * Bootstrap: transition.js v3.3.7
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // CSS TRANSITION SUPPORT (Shoutout: http://www.modernizr.com/)
  // ============================================================

  function transitionEnd() {
    var el = document.createElement('bootstrap')

    var transEndEventNames = {
      WebkitTransition : 'webkitTransitionEnd',
      MozTransition    : 'transitionend',
      OTransition      : 'oTransitionEnd otransitionend',
      transition       : 'transitionend'
    }

    for (var name in transEndEventNames) {
      if (el.style[name] !== undefined) {
        return { end: transEndEventNames[name] }
      }
    }

    return false // explicit for ie8 (  ._.)
  }

  // http://blog.alexmaccaw.com/css-transitions
  $.fn.emulateTransitionEnd = function (duration) {
    var called = false
    var $el = this
    $(this).one('bsTransitionEnd', function () { called = true })
    var callback = function () { if (!called) $($el).trigger($.support.transition.end) }
    setTimeout(callback, duration)
    return this
  }

  $(function () {
    $.support.transition = transitionEnd()

    if (!$.support.transition) return

    $.event.special.bsTransitionEnd = {
      bindType: $.support.transition.end,
      delegateType: $.support.transition.end,
      handle: function (e) {
        if ($(e.target).is(this)) return e.handleObj.handler.apply(this, arguments)
      }
    }
  })

}(jQuery);
</script>
<script>
/* ========================================================================
 * Bootstrap: collapse.js v3.3.7
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* jshint latedef: false */

+function ($) {
  'use strict';

  // COLLAPSE PUBLIC CLASS DEFINITION
  // ================================

  var Collapse = function (element, options) {
    this.$element      = $(element)
    this.options       = $.extend({}, Collapse.DEFAULTS, options)
    this.$trigger      = $('[data-toggle="collapse"][href="#' + element.id + '"],' +
                           '[data-toggle="collapse"][data-target="#' + element.id + '"]')
    this.transitioning = null

    if (this.options.parent) {
      this.$parent = this.getParent()
    } else {
      this.addAriaAndCollapsedClass(this.$element, this.$trigger)
    }

    if (this.options.toggle) this.toggle()
  }

  Collapse.VERSION  = '3.3.7'

  Collapse.TRANSITION_DURATION = 350

  Collapse.DEFAULTS = {
    toggle: true
  }

  Collapse.prototype.dimension = function () {
    var hasWidth = this.$element.hasClass('width')
    return hasWidth ? 'width' : 'height'
  }

  Collapse.prototype.show = function () {
    if (this.transitioning || this.$element.hasClass('in')) return

    var activesData
    var actives = this.$parent && this.$parent.children('.panel').children('.in, .collapsing')

    if (actives && actives.length) {
      activesData = actives.data('bs.collapse')
      if (activesData && activesData.transitioning) return
    }

    var startEvent = $.Event('show.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    if (actives && actives.length) {
      Plugin.call(actives, 'hide')
      activesData || actives.data('bs.collapse', null)
    }

    var dimension = this.dimension()

    this.$element
      .removeClass('collapse')
      .addClass('collapsing')[dimension](0)
      .attr('aria-expanded', true)

    this.$trigger
      .removeClass('collapsed')
      .attr('aria-expanded', true)

    this.transitioning = 1

    var complete = function () {
      this.$element
        .removeClass('collapsing')
        .addClass('collapse in')[dimension]('')
      this.transitioning = 0
      this.$element
        .trigger('shown.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    var scrollSize = $.camelCase(['scroll', dimension].join('-'))

    this.$element
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])
  }

  Collapse.prototype.hide = function () {
    if (this.transitioning || !this.$element.hasClass('in')) return

    var startEvent = $.Event('hide.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    var dimension = this.dimension()

    this.$element[dimension](this.$element[dimension]())[0].offsetHeight

    this.$element
      .addClass('collapsing')
      .removeClass('collapse in')
      .attr('aria-expanded', false)

    this.$trigger
      .addClass('collapsed')
      .attr('aria-expanded', false)

    this.transitioning = 1

    var complete = function () {
      this.transitioning = 0
      this.$element
        .removeClass('collapsing')
        .addClass('collapse')
        .trigger('hidden.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    this.$element
      [dimension](0)
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)
  }

  Collapse.prototype.toggle = function () {
    this[this.$element.hasClass('in') ? 'hide' : 'show']()
  }

  Collapse.prototype.getParent = function () {
    return $(this.options.parent)
      .find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]')
      .each($.proxy(function (i, element) {
        var $element = $(element)
        this.addAriaAndCollapsedClass(getTargetFromTrigger($element), $element)
      }, this))
      .end()
  }

  Collapse.prototype.addAriaAndCollapsedClass = function ($element, $trigger) {
    var isOpen = $element.hasClass('in')

    $element.attr('aria-expanded', isOpen)
    $trigger
      .toggleClass('collapsed', !isOpen)
      .attr('aria-expanded', isOpen)
  }

  function getTargetFromTrigger($trigger) {
    var href
    var target = $trigger.attr('data-target')
      || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '') // strip for ie7

    return $(target)
  }


  // COLLAPSE PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.collapse')
      var options = $.extend({}, Collapse.DEFAULTS, $this.data(), typeof option == 'object' && option)

      if (!data && options.toggle && /show|hide/.test(option)) options.toggle = false
      if (!data) $this.data('bs.collapse', (data = new Collapse(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.collapse

  $.fn.collapse             = Plugin
  $.fn.collapse.Constructor = Collapse


  // COLLAPSE NO CONFLICT
  // ====================

  $.fn.collapse.noConflict = function () {
    $.fn.collapse = old
    return this
  }


  // COLLAPSE DATA-API
  // =================

  $(document).on('click.bs.collapse.data-api', '[data-toggle="collapse"]', function (e) {
    var $this   = $(this)

    if (!$this.attr('data-target')) e.preventDefault()

    var $target = getTargetFromTrigger($this)
    var data    = $target.data('bs.collapse')
    var option  = data ? 'toggle' : $this.data()

    Plugin.call($target, option)
  })

}(jQuery);
</script>
<script>
window.initializeCodeFolding = function(show) {

  // handlers for show-all and hide all
  $("#rmd-show-all-code").click(function() {
    // close the dropdown menu when an option is clicked
    $("#allCodeButton").dropdown("toggle");
    $('div.r-code-collapse').each(function() {
      $(this).collapse('show');
    });
  });
  $("#rmd-hide-all-code").click(function() {
    // close the dropdown menu when an option is clicked
    $("#allCodeButton").dropdown("toggle");
    $('div.r-code-collapse').each(function() {
      $(this).collapse('hide');
    });
  });

  // index for unique code element ids
  var currentIndex = 1;

  // select all R code blocks
  var rCodeBlocks = $('pre.sourceCode, pre.r, pre.python, pre.bash, pre.sql, pre.cpp, pre.stan');
  rCodeBlocks.each(function() {

    // if code block has been labeled with class `fold-show`, show the code on init!
    var classList = $(this).attr('class').split(/\s+/);
    for (var i = 0; i < classList.length; i++) {
    if (classList[i] === 'fold-show') {
        show = true;
      }
    }

    // create a collapsable div to wrap the code in
    var div = $('<div class="collapse r-code-collapse"></div>');
    if (show)
      div.addClass('in');
    var id = 'rcode-643E0F36' + currentIndex++;
    div.attr('id', id);
    $(this).before(div);
    $(this).detach().appendTo(div);

    // add a show code button right above
    var showCodeText = $('<span>' + (show ? 'Hide' : 'Code') + '</span>');
    var showCodeButton = $('<button type="button" class="btn btn-default btn-xs code-folding-btn pull-right"></button>');
    showCodeButton.append(showCodeText);
    showCodeButton
        .attr('data-toggle', 'collapse')
        .attr('data-target', '#' + id)
        .attr('aria-expanded', show)
        .attr('aria-controls', id);

    var buttonRow = $('<div class="row"></div>');
    var buttonCol = $('<div class="col-md-12"></div>');

    buttonCol.append(showCodeButton);
    buttonRow.append(buttonCol);

    div.before(buttonRow);

    // hack: return show to false, otherwise all next codeBlocks will be shown!
    show = false;

    // update state of button on show/hide
    div.on('hidden.bs.collapse', function () {
      showCodeText.text('Code');
    });
    div.on('show.bs.collapse', function () {
      showCodeText.text('Hide');
    });
  });

}
</script>
<script>
/* ========================================================================
 * Bootstrap: dropdown.js v3.3.7
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // DROPDOWN CLASS DEFINITION
  // =========================

  var backdrop = '.dropdown-backdrop'
  var toggle   = '[data-toggle="dropdown"]'
  var Dropdown = function (element) {
    $(element).on('click.bs.dropdown', this.toggle)
  }

  Dropdown.VERSION = '3.3.7'

  function getParent($this) {
    var selector = $this.attr('data-target')

    if (!selector) {
      selector = $this.attr('href')
      selector = selector && /#[A-Za-z]/.test(selector) && selector.replace(/.*(?=#[^\s]*$)/, '') // strip for ie7
    }

    var $parent = selector && $(selector)

    return $parent && $parent.length ? $parent : $this.parent()
  }

  function clearMenus(e) {
    if (e && e.which === 3) return
    $(backdrop).remove()
    $(toggle).each(function () {
      var $this         = $(this)
      var $parent       = getParent($this)
      var relatedTarget = { relatedTarget: this }

      if (!$parent.hasClass('open')) return

      if (e && e.type == 'click' && /input|textarea/i.test(e.target.tagName) && $.contains($parent[0], e.target)) return

      $parent.trigger(e = $.Event('hide.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this.attr('aria-expanded', 'false')
      $parent.removeClass('open').trigger($.Event('hidden.bs.dropdown', relatedTarget))
    })
  }

  Dropdown.prototype.toggle = function (e) {
    var $this = $(this)

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    clearMenus()

    if (!isActive) {
      if ('ontouchstart' in document.documentElement && !$parent.closest('.navbar-nav').length) {
        // if mobile we use a backdrop because click events don't delegate
        $(document.createElement('div'))
          .addClass('dropdown-backdrop')
          .insertAfter($(this))
          .on('click', clearMenus)
      }

      var relatedTarget = { relatedTarget: this }
      $parent.trigger(e = $.Event('show.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this
        .trigger('focus')
        .attr('aria-expanded', 'true')

      $parent
        .toggleClass('open')
        .trigger($.Event('shown.bs.dropdown', relatedTarget))
    }

    return false
  }

  Dropdown.prototype.keydown = function (e) {
    if (!/(38|40|27|32)/.test(e.which) || /input|textarea/i.test(e.target.tagName)) return

    var $this = $(this)

    e.preventDefault()
    e.stopPropagation()

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    if (!isActive && e.which != 27 || isActive && e.which == 27) {
      if (e.which == 27) $parent.find(toggle).trigger('focus')
      return $this.trigger('click')
    }

    var desc = ' li:not(.disabled):visible a'
    var $items = $parent.find('.dropdown-menu' + desc)

    if (!$items.length) return

    var index = $items.index(e.target)

    if (e.which == 38 && index > 0)                 index--         // up
    if (e.which == 40 && index < $items.length - 1) index++         // down
    if (!~index)                                    index = 0

    $items.eq(index).trigger('focus')
  }


  // DROPDOWN PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this = $(this)
      var data  = $this.data('bs.dropdown')

      if (!data) $this.data('bs.dropdown', (data = new Dropdown(this)))
      if (typeof option == 'string') data[option].call($this)
    })
  }

  var old = $.fn.dropdown

  $.fn.dropdown             = Plugin
  $.fn.dropdown.Constructor = Dropdown


  // DROPDOWN NO CONFLICT
  // ====================

  $.fn.dropdown.noConflict = function () {
    $.fn.dropdown = old
    return this
  }


  // APPLY TO STANDARD DROPDOWN ELEMENTS
  // ===================================

  $(document)
    .on('click.bs.dropdown.data-api', clearMenus)
    .on('click.bs.dropdown.data-api', '.dropdown form', function (e) { e.stopPropagation() })
    .on('click.bs.dropdown.data-api', toggle, Dropdown.prototype.toggle)
    .on('keydown.bs.dropdown.data-api', toggle, Dropdown.prototype.keydown)
    .on('keydown.bs.dropdown.data-api', '.dropdown-menu', Dropdown.prototype.keydown)

}(jQuery);
</script>
<style type="text/css">
.code-folding-btn {
  margin-bottom: 4px;
}

.row { display: flex; }
.collapse { display: none; }
.in { display:block }
.pull-right > .dropdown-menu {
    right: 0;
    left: auto;
}

.dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0;
    z-index: 1000;
    display: none;
    float: left;
    min-width: 160px;
    padding: 5px 0;
    margin: 2px 0 0;
    font-size: 14px;
    text-align: left;
    list-style: none;
    background-color: #fff;
    -webkit-background-clip: padding-box;
    background-clip: padding-box;
    border: 1px solid #ccc;
    border: 1px solid rgba(0,0,0,.15);
    border-radius: 4px;
    -webkit-box-shadow: 0 6px 12px rgba(0,0,0,.175);
    box-shadow: 0 6px 12px rgba(0,0,0,.175);
}

.open > .dropdown-menu {
    display: block;
    color: #ffffff;
    background-color: #ffffff;
    background-image: none;
    border-color: #92897e;
}

.dropdown-menu > li > a {
  display: block;
  padding: 3px 20px;
  clear: both;
  font-weight: 400;
  line-height: 1.42857143;
  color: #000000;
  white-space: nowrap;
}

.dropdown-menu > li > a:hover,
.dropdown-menu > li > a:focus {
  color: #ffffff;
  text-decoration: none;
  background-color: #e95420;
}

.dropdown-menu > .active > a,
.dropdown-menu > .active > a:hover,
.dropdown-menu > .active > a:focus {
  color: #ffffff;
  text-decoration: none;
  background-color: #e95420;
  outline: 0;
}
.dropdown-menu > .disabled > a,
.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  color: #aea79f;
}

.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  text-decoration: none;
  cursor: not-allowed;
  background-color: transparent;
  background-image: none;
  filter: progid:DXImageTransform.Microsoft.gradient(enabled = false);
}

.btn {
  display: inline-block;
  margin-bottom: 1;
  font-weight: normal;
  text-align: center;
  white-space: nowrap;
  vertical-align: middle;
  -ms-touch-action: manipulation;
      touch-action: manipulation;
  cursor: pointer;
  background-image: none;
  border: 1px solid transparent;
  padding: 4px 8px;
  font-size: 14px;
  line-height: 1.42857143;
  border-radius: 4px;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.btn:focus,
.btn:active:focus,
.btn.active:focus,
.btn.focus,
.btn:active.focus,
.btn.active.focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
.btn:hover,
.btn:focus,
.btn.focus {
  color: #ffffff;
  text-decoration: none;
}
.btn:active,
.btn.active {
  background-image: none;
  outline: 0;
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn.disabled,
.btn[disabled],
fieldset[disabled] .btn {
  cursor: not-allowed;
  filter: alpha(opacity=65);
  opacity: 0.65;
  box-shadow: none;
}
a.btn.disabled,
fieldset[disabled] a.btn {
  pointer-events: none;
}
.btn-default {
  color: #ffffff;
  background-color: #aea79f; #important
  border-color: #aea79f;
}

.btn-default:focus,
.btn-default.focus {
  color: #ffffff;
  background-color: #978e83;
  border-color: #6f675e;
}

.btn-default:hover {
  color: #ffffff;
  background-color: #978e83;
  border-color: #92897e;
}
.btn-default:active,
.btn-default.active,
.btn-group > .btn:not(:first-child):not(:last-child):not(.dropdown-toggle) {
  border-radius: 0;
}
.btn-group > .btn:first-child {
  margin-left: 0;
}
.btn-group > .btn:first-child:not(:last-child):not(.dropdown-toggle) {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}
.btn-group > .btn:last-child:not(:first-child),
.btn-group > .dropdown-toggle:not(:first-child) {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group > .btn-group {
  float: left;
}
.btn-group > .btn-group:not(:first-child):not(:last-child) > .btn {
  border-radius: 0;
}
.btn-group > .btn-group:first-child:not(:last-child) > .btn:last-child,
.btn-group > .btn-group:first-child:not(:last-child) > .dropdown-toggle {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}
.btn-group > .btn-group:last-child:not(:first-child) > .btn:first-child {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group .dropdown-toggle:active,
.btn-group.open .dropdown-toggle {
  outline: 0;
}
.btn-group > .btn + .dropdown-toggle {
  padding-right: 8px;
  padding-left: 8px;
}
.btn-group > .btn-lg + .dropdown-toggle {
  padding-right: 12px;
  padding-left: 12px;
}
.btn-group.open .dropdown-toggle {
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn-group.open .dropdown-toggle.btn-link {
  box-shadow: none;
}

</style>
<script>
var str = '<div class="btn-group pull-right" style="position: fixed; right: 50px; top: 10px; z-index: 200"><button type="button" class="btn btn-default btn-xs dropdown-toggle" id="allCodeButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" data-_extension-text-contrast=""><span>Code</span> <span class="caret"></span></button><ul class="dropdown-menu" style="min-width: 50px;"><li><a id="rmd-show-all-code" href="#">Show All Code</a></li><li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li></ul></div>';
document.write(str);
</script>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "hide");
});
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="assets/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="https://www.ucl.ac.uk/module-catalogue/modules/geographic-information-systems-and-science-CASA0005"><img src="general_images/casa_logo.jpg"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgement"><i class="fa fa-check"></i>Acknowledgement</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#citation"><i class="fa fa-check"></i>Citation</a></li>
</ul></li>
<li class="part"><span><b>Course information</b></span></li>
<li class="chapter" data-level="" data-path="hello-gis.html"><a href="hello-gis.html"><i class="fa fa-check"></i>Hello GIS</a>
<ul>
<li class="chapter" data-level="" data-path="hello-gis.html"><a href="hello-gis.html#intended-course-learning-outcomes"><i class="fa fa-check"></i>Intended course learning outcomes</a></li>
<li class="chapter" data-level="" data-path="hello-gis.html"><a href="hello-gis.html#how-to-use-this-book"><i class="fa fa-check"></i>How to use this book</a></li>
<li class="chapter" data-level="" data-path="hello-gis.html"><a href="hello-gis.html#getting-started"><i class="fa fa-check"></i>Getting started</a></li>
<li class="chapter" data-level="" data-path="hello-gis.html"><a href="hello-gis.html#self-guided-learning"><i class="fa fa-check"></i>Self guided learning</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="software-installation.html"><a href="software-installation.html"><i class="fa fa-check"></i>Software installation</a>
<ul>
<li class="chapter" data-level="" data-path="software-installation.html"><a href="software-installation.html#qgis"><i class="fa fa-check"></i>QGIS</a></li>
<li class="chapter" data-level="" data-path="software-installation.html"><a href="software-installation.html#r"><i class="fa fa-check"></i>R</a>
<ul>
<li class="chapter" data-level="" data-path="software-installation.html"><a href="software-installation.html#r-java"><i class="fa fa-check"></i>R Java</a></li>
<li class="chapter" data-level="" data-path="software-installation.html"><a href="software-installation.html#basics"><i class="fa fa-check"></i>Basics</a></li>
<li class="chapter" data-level="" data-path="software-installation.html"><a href="software-installation.html#packages"><i class="fa fa-check"></i>Packages</a></li>
<li class="chapter" data-level="" data-path="software-installation.html"><a href="software-installation.html#macs"><i class="fa fa-check"></i>Macs</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="software-installation.html"><a href="software-installation.html#arcgis"><i class="fa fa-check"></i>ArcGIS</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="external-usage.html"><a href="external-usage.html"><i class="fa fa-check"></i>External usage</a>
<ul>
<li class="chapter" data-level="" data-path="external-usage.html"><a href="external-usage.html#how-to-adopt-this-course"><i class="fa fa-check"></i>How to adopt this course</a></li>
<li class="chapter" data-level="" data-path="external-usage.html"><a href="external-usage.html#how-to-contribute"><i class="fa fa-check"></i>How to contribute</a></li>
<li class="chapter" data-level="" data-path="external-usage.html"><a href="external-usage.html#supporting-the-module"><i class="fa fa-check"></i>Supporting the module</a></li>
<li class="chapter" data-level="" data-path="external-usage.html"><a href="external-usage.html#license"><i class="fa fa-check"></i>License</a></li>
<li class="chapter" data-level="" data-path="external-usage.html"><a href="external-usage.html#updates"><i class="fa fa-check"></i>Updates</a></li>
<li class="chapter" data-level="" data-path="external-usage.html"><a href="external-usage.html#packages-1"><i class="fa fa-check"></i>Packages</a></li>
</ul></li>
<li class="part"><span><b>I GIS tools</b></span></li>
<li class="chapter" data-level="1" data-path="geographic-information.html"><a href="geographic-information.html"><i class="fa fa-check"></i><b>1</b> Geographic Information</a>
<ul>
<li class="chapter" data-level="1.1" data-path="geographic-information.html"><a href="geographic-information.html#learning-outcomes"><i class="fa fa-check"></i><b>1.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="1.2" data-path="geographic-information.html"><a href="geographic-information.html#homework"><i class="fa fa-check"></i><b>1.2</b> Homework</a></li>
<li class="chapter" data-level="1.3" data-path="geographic-information.html"><a href="geographic-information.html#recommended-listening"><i class="fa fa-check"></i><b>1.3</b> Recommended listening 🎧</a></li>
<li class="chapter" data-level="1.4" data-path="geographic-information.html"><a href="geographic-information.html#the-basics-of-geographic-information"><i class="fa fa-check"></i><b>1.4</b> The Basics of Geographic Information</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="geographic-information.html"><a href="geographic-information.html#data-types-in-statistics"><i class="fa fa-check"></i><b>1.4.1</b> Data types in statistics</a></li>
<li class="chapter" data-level="1.4.2" data-path="geographic-information.html"><a href="geographic-information.html#important-gis-data-formats"><i class="fa fa-check"></i><b>1.4.2</b> Important GIS data formats</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="geographic-information.html"><a href="geographic-information.html#general-data-flow"><i class="fa fa-check"></i><b>1.5</b> General data flow</a></li>
<li class="chapter" data-level="1.6" data-path="geographic-information.html"><a href="geographic-information.html#data"><i class="fa fa-check"></i><b>1.6</b> Data</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="geographic-information.html"><a href="geographic-information.html#file-paths"><i class="fa fa-check"></i><b>1.6.1</b> File paths</a></li>
<li class="chapter" data-level="1.6.2" data-path="geographic-information.html"><a href="geographic-information.html#data-download"><i class="fa fa-check"></i><b>1.6.2</b> Data download</a></li>
<li class="chapter" data-level="1.6.3" data-path="geographic-information.html"><a href="geographic-information.html#data-pre-processing"><i class="fa fa-check"></i><b>1.6.3</b> Data pre-processing</a></li>
<li class="chapter" data-level="1.6.4" data-path="geographic-information.html"><a href="geographic-information.html#qgis-1"><i class="fa fa-check"></i><b>1.6.4</b> QGIS</a></li>
<li class="chapter" data-level="1.6.5" data-path="geographic-information.html"><a href="geographic-information.html#r-1"><i class="fa fa-check"></i><b>1.6.5</b> R</a></li>
<li class="chapter" data-level="1.6.6" data-path="geographic-information.html"><a href="geographic-information.html#export-data-1"><i class="fa fa-check"></i><b>1.6.6</b> Export data</a></li>
<li class="chapter" data-level="1.6.7" data-path="geographic-information.html"><a href="geographic-information.html#what-will-i-use-1"><i class="fa fa-check"></i><b>1.6.7</b> What will I use</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="geographic-information.html"><a href="geographic-information.html#data-sources-and-task"><i class="fa fa-check"></i><b>1.7</b> Data sources and task</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="geographic-information.html"><a href="geographic-information.html#uk-data-service"><i class="fa fa-check"></i><b>1.7.1</b> UK Data Service</a></li>
<li class="chapter" data-level="1.7.2" data-path="geographic-information.html"><a href="geographic-information.html#ons"><i class="fa fa-check"></i><b>1.7.2</b> ONS</a></li>
<li class="chapter" data-level="1.7.3" data-path="geographic-information.html"><a href="geographic-information.html#nomis"><i class="fa fa-check"></i><b>1.7.3</b> nomis</a></li>
<li class="chapter" data-level="1.7.4" data-path="geographic-information.html"><a href="geographic-information.html#os"><i class="fa fa-check"></i><b>1.7.4</b> OS</a></li>
<li class="chapter" data-level="1.7.5" data-path="geographic-information.html"><a href="geographic-information.html#edina-digimap"><i class="fa fa-check"></i><b>1.7.5</b> Edina Digimap</a></li>
<li class="chapter" data-level="1.7.6" data-path="geographic-information.html"><a href="geographic-information.html#osm"><i class="fa fa-check"></i><b>1.7.6</b> OSM</a></li>
<li class="chapter" data-level="1.7.7" data-path="geographic-information.html"><a href="geographic-information.html#defra"><i class="fa fa-check"></i><b>1.7.7</b> DEFRA</a></li>
<li class="chapter" data-level="1.7.8" data-path="geographic-information.html"><a href="geographic-information.html#data-lists"><i class="fa fa-check"></i><b>1.7.8</b> Data lists</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="geographic-information.html"><a href="geographic-information.html#summary"><i class="fa fa-check"></i><b>1.8</b> Summary</a></li>
<li class="chapter" data-level="1.9" data-path="geographic-information.html"><a href="geographic-information.html#feedback"><i class="fa fa-check"></i><b>1.9</b> Feedback</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><b>2</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#learning-outcomes-1"><i class="fa fa-check"></i><b>2.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#homework-1"><i class="fa fa-check"></i><b>2.2</b> Homework</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#recommended-listening-1"><i class="fa fa-check"></i><b>2.3</b> Recommended listening 🎧</a></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#introduction-1"><i class="fa fa-check"></i><b>2.4</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#online-forums-are-your-friend"><i class="fa fa-check"></i><b>2.4.1</b> Online forums are your friend!!</a></li>
<li class="chapter" data-level="2.4.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#health-warning"><i class="fa fa-check"></i><b>2.4.2</b> Health warning</a></li>
<li class="chapter" data-level="2.4.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#r-and-rstudio"><i class="fa fa-check"></i><b>2.4.3</b> R and RStudio</a></li>
<li class="chapter" data-level="2.4.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#getting-started-1"><i class="fa fa-check"></i><b>2.4.4</b> Getting started</a></li>
<li class="chapter" data-level="2.4.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#basics-1"><i class="fa fa-check"></i><b>2.4.5</b> Basics</a></li>
<li class="chapter" data-level="2.4.6" data-path="introduction-to-r.html"><a href="introduction-to-r.html#scripts-and-some-basic-commands"><i class="fa fa-check"></i><b>2.4.6</b> Scripts and some basic commands</a></li>
<li class="chapter" data-level="2.4.7" data-path="introduction-to-r.html"><a href="introduction-to-r.html#functions"><i class="fa fa-check"></i><b>2.4.7</b> Functions</a></li>
<li class="chapter" data-level="2.4.8" data-path="introduction-to-r.html"><a href="introduction-to-r.html#basic-plotting"><i class="fa fa-check"></i><b>2.4.8</b> Basic plotting</a></li>
<li class="chapter" data-level="2.4.9" data-path="introduction-to-r.html"><a href="introduction-to-r.html#help"><i class="fa fa-check"></i><b>2.4.9</b> Help</a></li>
<li class="chapter" data-level="2.4.10" data-path="introduction-to-r.html"><a href="introduction-to-r.html#data-structures"><i class="fa fa-check"></i><b>2.4.10</b> Data structures</a></li>
<li class="chapter" data-level="2.4.11" data-path="introduction-to-r.html"><a href="introduction-to-r.html#elements-of-a-data-frame"><i class="fa fa-check"></i><b>2.4.11</b> Elements of a data frame</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#reading-data-into-r"><i class="fa fa-check"></i><b>2.5</b> Reading data into R</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#old-skool-cleaning"><i class="fa fa-check"></i><b>2.5.1</b> Old skool cleaning</a></li>
<li class="chapter" data-level="2.5.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#here"><i class="fa fa-check"></i><b>2.5.2</b> Here</a></li>
<li class="chapter" data-level="2.5.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#new-skool-cleaning"><i class="fa fa-check"></i><b>2.5.3</b> New skool cleaning</a></li>
<li class="chapter" data-level="2.5.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#examining-your-new-data"><i class="fa fa-check"></i><b>2.5.4</b> Examining your new data</a></li>
<li class="chapter" data-level="2.5.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#data-manipulation-in-r"><i class="fa fa-check"></i><b>2.5.5</b> Data manipulation in R</a></li>
<li class="chapter" data-level="2.5.6" data-path="introduction-to-r.html"><a href="introduction-to-r.html#plotting"><i class="fa fa-check"></i><b>2.5.6</b> Plotting</a></li>
<li class="chapter" data-level="2.5.7" data-path="introduction-to-r.html"><a href="introduction-to-r.html#pimp-my-graph"><i class="fa fa-check"></i><b>2.5.7</b> Pimp my graph!</a></li>
<li class="chapter" data-level="2.5.8" data-path="introduction-to-r.html"><a href="introduction-to-r.html#spatial-data-in-r"><i class="fa fa-check"></i><b>2.5.8</b> Spatial Data in R</a></li>
<li class="chapter" data-level="2.5.9" data-path="introduction-to-r.html"><a href="introduction-to-r.html#simple-mapping"><i class="fa fa-check"></i><b>2.5.9</b> Simple mapping</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="introduction-to-r.html"><a href="introduction-to-r.html#tidying-data"><i class="fa fa-check"></i><b>2.6</b> Tidying data</a></li>
<li class="chapter" data-level="2.7" data-path="introduction-to-r.html"><a href="introduction-to-r.html#feedback-1"><i class="fa fa-check"></i><b>2.7</b> Feedback</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html"><i class="fa fa-check"></i><b>3</b> Spatial descriptive statistics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html#learning-outcomes-2"><i class="fa fa-check"></i><b>3.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="3.2" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html#homework-2"><i class="fa fa-check"></i><b>3.2</b> Homework</a></li>
<li class="chapter" data-level="3.3" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html#recommended-listening-2"><i class="fa fa-check"></i><b>3.3</b> Recommended listening 🎧</a></li>
<li class="chapter" data-level="3.4" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html#introduction-2"><i class="fa fa-check"></i><b>3.4</b> Introduction</a></li>
<li class="chapter" data-level="3.5" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html#part-1-projections"><i class="fa fa-check"></i><b>3.5</b> Part 1 projections</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html#changing-projections"><i class="fa fa-check"></i><b>3.5.1</b> Changing projections</a></li>
<li class="chapter" data-level="3.5.2" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html#worldclim-data"><i class="fa fa-check"></i><b>3.5.2</b> WorldClim data</a></li>
<li class="chapter" data-level="3.5.3" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html#data-loading"><i class="fa fa-check"></i><b>3.5.3</b> Data loading</a></li>
<li class="chapter" data-level="3.5.4" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html#raster-location"><i class="fa fa-check"></i><b>3.5.4</b> Raster location</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html#part-2-descriptive-statistics"><i class="fa fa-check"></i><b>3.6</b> Part 2 descriptive statistics</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html#data-preparation"><i class="fa fa-check"></i><b>3.6.1</b> Data preparation</a></li>
<li class="chapter" data-level="3.6.2" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html#histogram"><i class="fa fa-check"></i><b>3.6.2</b> Histogram</a></li>
<li class="chapter" data-level="3.6.3" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html#using-more-data"><i class="fa fa-check"></i><b>3.6.3</b> Using more data</a></li>
<li class="chapter" data-level="3.6.4" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html#histogram-with-ggplot"><i class="fa fa-check"></i><b>3.6.4</b> Histogram with ggplot</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html#feedback-2"><i class="fa fa-check"></i><b>3.7</b> Feedback</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html"><i class="fa fa-check"></i><b>4</b> Git, GitHub and RMarkdown</a>
<ul>
<li class="chapter" data-level="4.1" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#learning-outcomes-3"><i class="fa fa-check"></i><b>4.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="4.2" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#homework-3"><i class="fa fa-check"></i><b>4.2</b> Homework</a></li>
<li class="chapter" data-level="4.3" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#recommended-listening-3"><i class="fa fa-check"></i><b>4.3</b> Recommended listening 🎧</a></li>
<li class="chapter" data-level="4.4" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#introduction-3"><i class="fa fa-check"></i><b>4.4</b> Introduction</a></li>
<li class="chapter" data-level="4.5" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#git-and-github"><i class="fa fa-check"></i><b>4.5</b> Git and GitHub</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#the-three-ways"><i class="fa fa-check"></i><b>4.5.1</b> The three ways</a></li>
<li class="chapter" data-level="4.5.2" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#set-up-your-github"><i class="fa fa-check"></i><b>4.5.2</b> Set up your GitHub</a></li>
<li class="chapter" data-level="4.5.3" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#using-rstudio-with-git"><i class="fa fa-check"></i><b>4.5.3</b> Using RStudio with Git</a></li>
<li class="chapter" data-level="4.5.4" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#using-the-git-gui---way-1"><i class="fa fa-check"></i><b>4.5.4</b> Using the Git GUI - way 1</a></li>
<li class="chapter" data-level="4.5.5" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#create-a-new-version-control-in-rstudio---way-2"><i class="fa fa-check"></i><b>4.5.5</b> Create a new version control in RStudio - way 2</a></li>
<li class="chapter" data-level="4.5.6" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#if-have-an-existing-project---way-3"><i class="fa fa-check"></i><b>4.5.6</b> If have an existing project - way 3</a></li>
<li class="chapter" data-level="4.5.7" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#commiting-to-git"><i class="fa fa-check"></i><b>4.5.7</b> Commiting to Git</a></li>
<li class="chapter" data-level="4.5.8" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#push-to-github"><i class="fa fa-check"></i><b>4.5.8</b> Push to Github</a></li>
<li class="chapter" data-level="4.5.9" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#pull-from-github"><i class="fa fa-check"></i><b>4.5.9</b> Pull from GitHub</a></li>
<li class="chapter" data-level="4.5.10" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#using-git-outside-rstudio"><i class="fa fa-check"></i><b>4.5.10</b> Using Git outside RStudio</a></li>
<li class="chapter" data-level="4.5.11" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#troubleshooting"><i class="fa fa-check"></i><b>4.5.11</b> Troubleshooting</a></li>
<li class="chapter" data-level="4.5.12" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#fork-a-repository"><i class="fa fa-check"></i><b>4.5.12</b> Fork a repository</a></li>
<li class="chapter" data-level="4.5.13" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#branches"><i class="fa fa-check"></i><b>4.5.13</b> Branches</a></li>
<li class="chapter" data-level="4.5.14" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#health-warning-1"><i class="fa fa-check"></i><b>4.5.14</b> Health warning</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#rmarkdown"><i class="fa fa-check"></i><b>4.6</b> RMarkdown</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#html"><i class="fa fa-check"></i><b>4.6.1</b> HTML</a></li>
<li class="chapter" data-level="4.6.2" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#knit-options"><i class="fa fa-check"></i><b>4.6.2</b> Knit options</a></li>
<li class="chapter" data-level="4.6.3" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#shortcuts"><i class="fa fa-check"></i><b>4.6.3</b> Shortcuts</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#further-reading"><i class="fa fa-check"></i><b>4.7</b> Further reading</a></li>
<li class="chapter" data-level="4.8" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#feedback-3"><i class="fa fa-check"></i><b>4.8</b> Feedback</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="map-making.html"><a href="map-making.html"><i class="fa fa-check"></i><b>5</b> Map making</a>
<ul>
<li class="chapter" data-level="5.1" data-path="map-making.html"><a href="map-making.html#learning-outcomes-4"><i class="fa fa-check"></i><b>5.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="5.2" data-path="map-making.html"><a href="map-making.html#homework-4"><i class="fa fa-check"></i><b>5.2</b> Homework</a></li>
<li class="chapter" data-level="5.3" data-path="map-making.html"><a href="map-making.html#recommended-listening-4"><i class="fa fa-check"></i><b>5.3</b> Recommended listening 🎧</a></li>
<li class="chapter" data-level="5.4" data-path="map-making.html"><a href="map-making.html#introduction-4"><i class="fa fa-check"></i><b>5.4</b> Introduction</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="map-making.html"><a href="map-making.html#osm-1"><i class="fa fa-check"></i><b>5.4.1</b> OSM</a></li>
<li class="chapter" data-level="5.4.2" data-path="map-making.html"><a href="map-making.html#airbnb"><i class="fa fa-check"></i><b>5.4.2</b> Airbnb</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="map-making.html"><a href="map-making.html#data-1"><i class="fa fa-check"></i><b>5.5</b> Data</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="map-making.html"><a href="map-making.html#osm-2"><i class="fa fa-check"></i><b>5.5.1</b> OSM</a></li>
<li class="chapter" data-level="5.5.2" data-path="map-making.html"><a href="map-making.html#london-boroughs"><i class="fa fa-check"></i><b>5.5.2</b> London boroughs</a></li>
<li class="chapter" data-level="5.5.3" data-path="map-making.html"><a href="map-making.html#world-cities"><i class="fa fa-check"></i><b>5.5.3</b> World cities</a></li>
<li class="chapter" data-level="5.5.4" data-path="map-making.html"><a href="map-making.html#uk-outline"><i class="fa fa-check"></i><b>5.5.4</b> Uk outline</a></li>
<li class="chapter" data-level="5.5.5" data-path="map-making.html"><a href="map-making.html#airbnb-1"><i class="fa fa-check"></i><b>5.5.5</b> Airbnb</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="map-making.html"><a href="map-making.html#plan"><i class="fa fa-check"></i><b>5.6</b> Plan</a></li>
<li class="chapter" data-level="5.7" data-path="map-making.html"><a href="map-making.html#crs-and-filter"><i class="fa fa-check"></i><b>5.7</b> CRS and filter</a></li>
<li class="chapter" data-level="5.8" data-path="map-making.html"><a href="map-making.html#join-and-sum"><i class="fa fa-check"></i><b>5.8</b> Join and sum</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="map-making.html"><a href="map-making.html#key-advice"><i class="fa fa-check"></i><b>5.8.1</b> Key advice</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="map-making.html"><a href="map-making.html#mapping"><i class="fa fa-check"></i><b>5.9</b> Mapping</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="map-making.html"><a href="map-making.html#tmap-syntax"><i class="fa fa-check"></i><b>5.9.1</b> tmap syntax</a></li>
<li class="chapter" data-level="5.9.2" data-path="map-making.html"><a href="map-making.html#complete-map"><i class="fa fa-check"></i><b>5.9.2</b> Complete map</a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="map-making.html"><a href="map-making.html#bad-maps"><i class="fa fa-check"></i><b>5.10</b> Bad maps</a></li>
<li class="chapter" data-level="5.11" data-path="map-making.html"><a href="map-making.html#feedback-4"><i class="fa fa-check"></i><b>5.11</b> Feedback</a></li>
</ul></li>
<li class="part"><span><b>II GIS analysis</b></span></li>
<li class="chapter" data-level="6" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html"><i class="fa fa-check"></i><b>6</b> Detecting spatial patterns</a>
<ul>
<li class="chapter" data-level="6.1" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#learning-outcomes-5"><i class="fa fa-check"></i><b>6.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="6.2" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#homework-5"><i class="fa fa-check"></i><b>6.2</b> Homework</a></li>
<li class="chapter" data-level="6.3" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#recommended-listening-5"><i class="fa fa-check"></i><b>6.3</b> Recommended listening 🎧</a></li>
<li class="chapter" data-level="6.4" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#introduction-5"><i class="fa fa-check"></i><b>6.4</b> Introduction</a></li>
<li class="chapter" data-level="6.5" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#setting-up-your-data"><i class="fa fa-check"></i><b>6.5</b> Setting up your data</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#data-cleaning"><i class="fa fa-check"></i><b>6.5.1</b> Data cleaning</a></li>
<li class="chapter" data-level="6.5.2" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#spatial-subsetting"><i class="fa fa-check"></i><b>6.5.2</b> Spatial subsetting</a></li>
<li class="chapter" data-level="6.5.3" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#spatial-clipping"><i class="fa fa-check"></i><b>6.5.3</b> Spatial clipping</a></li>
<li class="chapter" data-level="6.5.4" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#key-advice-1"><i class="fa fa-check"></i><b>6.5.4</b> Key advice</a></li>
<li class="chapter" data-level="6.5.5" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#study-area-1"><i class="fa fa-check"></i><b>6.5.5</b> Study area</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#point-pattern-analysis"><i class="fa fa-check"></i><b>6.6</b> Point pattern analysis</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#kernel-density-estimation"><i class="fa fa-check"></i><b>6.6.1</b> Kernel Density Estimation</a></li>
<li class="chapter" data-level="6.6.2" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#quadrat-analysis"><i class="fa fa-check"></i><b>6.6.2</b> Quadrat Analysis</a></li>
<li class="chapter" data-level="6.6.3" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#try-experimenting"><i class="fa fa-check"></i><b>6.6.3</b> Try experimenting…</a></li>
<li class="chapter" data-level="6.6.4" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#ripleys-k"><i class="fa fa-check"></i><b>6.6.4</b> Ripley’s K</a></li>
<li class="chapter" data-level="6.6.5" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#alternatives-to-ripleys-k"><i class="fa fa-check"></i><b>6.6.5</b> Alternatives to Ripley’s K</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#density-based-spatial-clustering-of-applications-with-noise-dbscan"><i class="fa fa-check"></i><b>6.7</b> Density-based spatial clustering of applications with noise: DBSCAN</a></li>
<li class="chapter" data-level="6.8" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#point-pattern-analysis-summary"><i class="fa fa-check"></i><b>6.8</b> Point pattern analysis summary</a></li>
<li class="chapter" data-level="6.9" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#feedback-5"><i class="fa fa-check"></i><b>6.9</b> Feedback</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html"><i class="fa fa-check"></i><b>7</b> Spatial autocorrelation</a>
<ul>
<li class="chapter" data-level="7.1" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#learning-outcomes-6"><i class="fa fa-check"></i><b>7.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="7.2" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#homework-6"><i class="fa fa-check"></i><b>7.2</b> Homework</a></li>
<li class="chapter" data-level="7.3" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#recommended-listening-6"><i class="fa fa-check"></i><b>7.3</b> Recommended listening 🎧</a></li>
<li class="chapter" data-level="7.4" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#introduction-6"><i class="fa fa-check"></i><b>7.4</b> Introduction</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#analysing-spatial-autocorrelation-with-morans-i-lisa-and-friends"><i class="fa fa-check"></i><b>7.4.1</b> Analysing Spatial Autocorrelation with Moran’s I, LISA and friends</a></li>
<li class="chapter" data-level="7.4.2" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#data-download-1"><i class="fa fa-check"></i><b>7.4.2</b> Data download</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#data-cleaning-1"><i class="fa fa-check"></i><b>7.5</b> Data cleaning</a></li>
<li class="chapter" data-level="7.6" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#data-manipulation"><i class="fa fa-check"></i><b>7.6</b> Data manipulation</a></li>
<li class="chapter" data-level="7.7" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#weight-matrix"><i class="fa fa-check"></i><b>7.7</b> Weight matrix</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#matrix-style"><i class="fa fa-check"></i><b>7.7.1</b> Matrix style</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#autocorrelation"><i class="fa fa-check"></i><b>7.8</b> Autocorrelation</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#morans-i"><i class="fa fa-check"></i><b>7.8.1</b> Moran’s I</a></li>
<li class="chapter" data-level="7.8.2" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#gearys-c"><i class="fa fa-check"></i><b>7.8.2</b> Geary’s C</a></li>
<li class="chapter" data-level="7.8.3" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#getis-ord"><i class="fa fa-check"></i><b>7.8.3</b> Getis Ord</a></li>
<li class="chapter" data-level="7.8.4" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#summary-1"><i class="fa fa-check"></i><b>7.8.4</b> Summary</a></li>
<li class="chapter" data-level="7.8.5" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#local-morans-i"><i class="fa fa-check"></i><b>7.8.5</b> Local Moran’s I</a></li>
<li class="chapter" data-level="7.8.6" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#local-getis-ord-g_i"><i class="fa fa-check"></i><b>7.8.6</b> Local Getis Ord <span class="math inline">\(G_{i}^{*}\)</span></a></li>
<li class="chapter" data-level="7.8.7" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#summary-2"><i class="fa fa-check"></i><b>7.8.7</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#other-variables"><i class="fa fa-check"></i><b>7.9</b> Other variables</a></li>
<li class="chapter" data-level="7.10" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#feedback-6"><i class="fa fa-check"></i><b>7.10</b> Feedback</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html"><i class="fa fa-check"></i><b>8</b> Explaining spatial patterns</a>
<ul>
<li class="chapter" data-level="8.1" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#learning-objectives"><i class="fa fa-check"></i><b>8.1</b> Learning objectives</a></li>
<li class="chapter" data-level="8.2" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#homework-7"><i class="fa fa-check"></i><b>8.2</b> Homework</a></li>
<li class="chapter" data-level="8.3" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#recommended-listening-7"><i class="fa fa-check"></i><b>8.3</b> Recommended listening 🎧</a></li>
<li class="chapter" data-level="8.4" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#introduction-7"><i class="fa fa-check"></i><b>8.4</b> Introduction</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#setting-up-your-data-1"><i class="fa fa-check"></i><b>8.4.1</b> Setting up your Data</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#analysing-gcse-exam-performance---testing-a-research-hypothesis"><i class="fa fa-check"></i><b>8.5</b> Analysing GCSE exam performance - testing a research hypothesis</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#research-question-and-hypothesis"><i class="fa fa-check"></i><b>8.5.1</b> Research Question and Hypothesis</a></li>
<li class="chapter" data-level="8.5.2" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#regression-basics"><i class="fa fa-check"></i><b>8.5.2</b> Regression Basics</a></li>
<li class="chapter" data-level="8.5.3" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#running-a-regression-model-in-r"><i class="fa fa-check"></i><b>8.5.3</b> Running a Regression Model in R</a></li>
<li class="chapter" data-level="8.5.4" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#tidymodels"><i class="fa fa-check"></i><b>8.5.4</b> tidymodels</a></li>
<li class="chapter" data-level="8.5.5" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#bootstrap-resampling"><i class="fa fa-check"></i><b>8.5.5</b> Bootstrap resampling</a></li>
<li class="chapter" data-level="8.5.6" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#variables"><i class="fa fa-check"></i><b>8.5.6</b> Variables</a></li>
<li class="chapter" data-level="8.5.7" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#assumptions-underpinning-linear-regression"><i class="fa fa-check"></i><b>8.5.7</b> Assumptions Underpinning Linear Regression</a></li>
<li class="chapter" data-level="8.5.8" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#assumption-1---there-is-a-linear-relationship-between-the-dependent-and-independent-variables"><i class="fa fa-check"></i><b>8.5.8</b> Assumption 1 - There is a linear relationship between the dependent and independent variables</a></li>
<li class="chapter" data-level="8.5.9" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#assumption-2---the-residuals-in-your-model-should-be-normally-distributed"><i class="fa fa-check"></i><b>8.5.9</b> Assumption 2 - The residuals in your model should be normally distributed</a></li>
<li class="chapter" data-level="8.5.10" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#assumption-3---no-multicolinearity-in-the-independent-variables"><i class="fa fa-check"></i><b>8.5.10</b> Assumption 3 - No Multicolinearity in the independent variables</a></li>
<li class="chapter" data-level="8.5.11" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#assumption-4---homoscedasticity"><i class="fa fa-check"></i><b>8.5.11</b> Assumption 4 - Homoscedasticity</a></li>
<li class="chapter" data-level="8.5.12" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#assumption-5---independence-of-errors"><i class="fa fa-check"></i><b>8.5.12</b> Assumption 5 - Independence of Errors</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#spatial-regression-models"><i class="fa fa-check"></i><b>8.6</b> Spatial Regression Models</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#dealing-with-spatially-autocorrelated-residuals---spatial-lag-and-spatial-error-models"><i class="fa fa-check"></i><b>8.6.1</b> Dealing with Spatially Autocorrelated Residuals - Spatial Lag and Spatial Error models</a></li>
<li class="chapter" data-level="8.6.2" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#key-advice-2"><i class="fa fa-check"></i><b>8.6.2</b> Key advice</a></li>
<li class="chapter" data-level="8.6.3" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#which-model-to-use"><i class="fa fa-check"></i><b>8.6.3</b> Which model to use</a></li>
<li class="chapter" data-level="8.6.4" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#more-data"><i class="fa fa-check"></i><b>8.6.4</b> More data</a></li>
<li class="chapter" data-level="8.6.5" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#extending-your-regression-model---dummy-variables"><i class="fa fa-check"></i><b>8.6.5</b> Extending your regression model - Dummy Variables</a></li>
<li class="chapter" data-level="8.6.6" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#task-investigating-further---adding-more-explanatory-variables-into-a-multiple-regression-model"><i class="fa fa-check"></i><b>8.6.6</b> TASK: Investigating Further - Adding More Explanatory Variables into a multiple regression model</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#task-3---spatial-non-stationarity-and-geographically-weighted-regression-models-gwr"><i class="fa fa-check"></i><b>8.7</b> Task 3 - Spatial Non-stationarity and Geographically Weighted Regression Models (GWR)</a></li>
<li class="chapter" data-level="8.8" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#feedback-7"><i class="fa fa-check"></i><b>8.8</b> Feedback</a></li>
</ul></li>
<li class="part"><span><b>Extra</b></span></li>
<li class="chapter" data-level="" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html"><i class="fa fa-check"></i>Multiple Linear Regression</a></li>
<li class="chapter" data-level="" data-path="module-resources.html"><a href="module-resources.html"><i class="fa fa-check"></i>Module resources</a>
<ul>
<li class="chapter" data-level="8.9" data-path="module-resources.html"><a href="module-resources.html#markscheme"><i class="fa fa-check"></i><b>8.9</b> Markscheme</a></li>
<li class="chapter" data-level="8.10" data-path="module-resources.html"><a href="module-resources.html#old-practicals"><i class="fa fa-check"></i><b>8.10</b> Old practicals</a></li>
<li class="chapter" data-level="8.11" data-path="module-resources.html"><a href="module-resources.html#events-meet-other-spatial-data-professionals"><i class="fa fa-check"></i><b>8.11</b> Events / meet other spatial data professionals</a></li>
<li class="chapter" data-level="8.12" data-path="module-resources.html"><a href="module-resources.html#cool-stuff-to-explore"><i class="fa fa-check"></i><b>8.12</b> Cool stuff to explore</a></li>
<li class="chapter" data-level="8.13" data-path="module-resources.html"><a href="module-resources.html#booksreading-resources"><i class="fa fa-check"></i><b>8.13</b> Books/reading resources</a></li>
<li class="chapter" data-level="8.14" data-path="module-resources.html"><a href="module-resources.html#new-developments"><i class="fa fa-check"></i><b>8.14</b> New developments</a>
<ul>
<li class="chapter" data-level="8.14.1" data-path="module-resources.html"><a href="module-resources.html#twitter"><i class="fa fa-check"></i><b>8.14.1</b> Twitter</a></li>
</ul></li>
<li class="chapter" data-level="8.15" data-path="module-resources.html"><a href="module-resources.html#data-2"><i class="fa fa-check"></i><b>8.15</b> Data</a></li>
<li class="chapter" data-level="8.16" data-path="module-resources.html"><a href="module-resources.html#data-lists-1"><i class="fa fa-check"></i><b>8.16</b> Data lists</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="extra-reproducibility.html"><a href="extra-reproducibility.html"><i class="fa fa-check"></i>Extra reproducibility</a>
<ul>
<li class="chapter" data-level="8.17" data-path="extra-reproducibility.html"><a href="extra-reproducibility.html#git-and-github-1"><i class="fa fa-check"></i><b>8.17</b> Git and GitHub</a>
<ul>
<li class="chapter" data-level="8.17.1" data-path="extra-reproducibility.html"><a href="extra-reproducibility.html#back-in-time"><i class="fa fa-check"></i><b>8.17.1</b> Back in time</a></li>
</ul></li>
<li class="chapter" data-level="8.18" data-path="extra-reproducibility.html"><a href="extra-reproducibility.html#renv"><i class="fa fa-check"></i><b>8.18</b> renv</a></li>
<li class="chapter" data-level="8.19" data-path="extra-reproducibility.html"><a href="extra-reproducibility.html#referencing-and-more"><i class="fa fa-check"></i><b>8.19</b> Referencing and more</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="qgis-maps.html"><a href="qgis-maps.html"><i class="fa fa-check"></i>QGIS Maps</a>
<ul>
<li class="chapter" data-level="8.20" data-path="qgis-maps.html"><a href="qgis-maps.html#load-data-2"><i class="fa fa-check"></i><b>8.20</b> Load data</a></li>
<li class="chapter" data-level="8.21" data-path="qgis-maps.html"><a href="qgis-maps.html#manipulate-data"><i class="fa fa-check"></i><b>8.21</b> Manipulate data</a></li>
<li class="chapter" data-level="8.22" data-path="qgis-maps.html"><a href="qgis-maps.html#map-data"><i class="fa fa-check"></i><b>8.22</b> Map data</a></li>
<li class="chapter" data-level="8.23" data-path="qgis-maps.html"><a href="qgis-maps.html#export-map"><i class="fa fa-check"></i><b>8.23</b> Export map</a></li>
<li class="chapter" data-level="8.24" data-path="qgis-maps.html"><a href="qgis-maps.html#graphical-modeler"><i class="fa fa-check"></i><b>8.24</b> Graphical modeler</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tmap-version-3.html"><a href="tmap-version-3.html"><i class="fa fa-check"></i>Tmap version 3</a>
<ul>
<li class="chapter" data-level="8.25" data-path="tmap-version-3.html"><a href="tmap-version-3.html#learning-outcomes-7"><i class="fa fa-check"></i><b>8.25</b> Learning outcomes</a></li>
<li class="chapter" data-level="8.26" data-path="tmap-version-3.html"><a href="tmap-version-3.html#homework-8"><i class="fa fa-check"></i><b>8.26</b> Homework</a></li>
<li class="chapter" data-level="8.27" data-path="tmap-version-3.html"><a href="tmap-version-3.html#recommended-listening-8"><i class="fa fa-check"></i><b>8.27</b> Recommended listening 🎧</a></li>
<li class="chapter" data-level="8.28" data-path="tmap-version-3.html"><a href="tmap-version-3.html#introduction-8"><i class="fa fa-check"></i><b>8.28</b> Introduction</a>
<ul>
<li class="chapter" data-level="8.28.1" data-path="tmap-version-3.html"><a href="tmap-version-3.html#osm-3"><i class="fa fa-check"></i><b>8.28.1</b> OSM</a></li>
<li class="chapter" data-level="8.28.2" data-path="tmap-version-3.html"><a href="tmap-version-3.html#airbnb-2"><i class="fa fa-check"></i><b>8.28.2</b> Airbnb</a></li>
</ul></li>
<li class="chapter" data-level="8.29" data-path="tmap-version-3.html"><a href="tmap-version-3.html#data-3"><i class="fa fa-check"></i><b>8.29</b> Data</a>
<ul>
<li class="chapter" data-level="8.29.1" data-path="tmap-version-3.html"><a href="tmap-version-3.html#osm-4"><i class="fa fa-check"></i><b>8.29.1</b> OSM</a></li>
<li class="chapter" data-level="8.29.2" data-path="tmap-version-3.html"><a href="tmap-version-3.html#london-boroughs-1"><i class="fa fa-check"></i><b>8.29.2</b> London boroughs</a></li>
<li class="chapter" data-level="8.29.3" data-path="tmap-version-3.html"><a href="tmap-version-3.html#world-cities-1"><i class="fa fa-check"></i><b>8.29.3</b> World cities</a></li>
<li class="chapter" data-level="8.29.4" data-path="tmap-version-3.html"><a href="tmap-version-3.html#uk-outline-1"><i class="fa fa-check"></i><b>8.29.4</b> Uk outline</a></li>
<li class="chapter" data-level="8.29.5" data-path="tmap-version-3.html"><a href="tmap-version-3.html#airbnb-3"><i class="fa fa-check"></i><b>8.29.5</b> Airbnb</a></li>
</ul></li>
<li class="chapter" data-level="8.30" data-path="tmap-version-3.html"><a href="tmap-version-3.html#spatial-joining"><i class="fa fa-check"></i><b>8.30</b> Spatial joining</a>
<ul>
<li class="chapter" data-level="8.30.1" data-path="tmap-version-3.html"><a href="tmap-version-3.html#static-map"><i class="fa fa-check"></i><b>8.30.1</b> Static map</a></li>
<li class="chapter" data-level="8.30.2" data-path="tmap-version-3.html"><a href="tmap-version-3.html#inset-map"><i class="fa fa-check"></i><b>8.30.2</b> Inset map</a></li>
<li class="chapter" data-level="8.30.3" data-path="tmap-version-3.html"><a href="tmap-version-3.html#export"><i class="fa fa-check"></i><b>8.30.3</b> Export</a></li>
<li class="chapter" data-level="8.30.4" data-path="tmap-version-3.html"><a href="tmap-version-3.html#basic-interactive-map"><i class="fa fa-check"></i><b>8.30.4</b> Basic interactive map</a></li>
<li class="chapter" data-level="8.30.5" data-path="tmap-version-3.html"><a href="tmap-version-3.html#advanced-interactive-map"><i class="fa fa-check"></i><b>8.30.5</b> Advanced interactive map</a></li>
</ul></li>
<li class="chapter" data-level="8.31" data-path="tmap-version-3.html"><a href="tmap-version-3.html#bad-maps-1"><i class="fa fa-check"></i><b>8.31</b> Bad maps</a></li>
<li class="chapter" data-level="8.32" data-path="tmap-version-3.html"><a href="tmap-version-3.html#feedback-8"><i class="fa fa-check"></i><b>8.32</b> Feedback</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="functions-1.html"><a href="functions-1.html"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="interactive-maps.html"><a href="interactive-maps.html"><i class="fa fa-check"></i>Interactive maps</a>
<ul>
<li class="chapter" data-level="8.33" data-path="interactive-maps.html"><a href="interactive-maps.html#advanced-interactive-map-1"><i class="fa fa-check"></i><b>8.33</b> Advanced interactive map</a></li>
</ul></li>
<li class="divider"></li>
<li><center>
  <a rel="license" href="./external-usage.html#license">
    License: CC-BY-SA<br>
    <i class = "fab fa-creative-commons fa-2x"></i>
    <i class = "fab fa-creative-commons-by fa-2x"></i>
    <i class = "fab fa-creative-commons-sa fa-2x"></i>
  </a>
</li></center>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">CASA0005 Geographic Information Systems and Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="detecting-spatial-patterns" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapter 6</span> Detecting spatial patterns<a href="detecting-spatial-patterns.html#detecting-spatial-patterns" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="learning-outcomes-5" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Learning outcomes<a href="detecting-spatial-patterns.html#learning-outcomes-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>By the end of this practical you should be able to:</p>
<ol style="list-style-type: decimal">
<li>Describe and evaluate methods for analysing spatial patterns</li>
<li>Execute data cleaning and manipulation appropriate for analysis</li>
<li>Determine the locations of spatial clusters using point pattern analysis methods</li>
</ol>
</div>
<div id="homework-5" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Homework<a href="detecting-spatial-patterns.html#homework-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Outside of our scheduled sessions you should be doing around 12 hours of extra study per week. Feel free to follow your own GIS interests, but good places to start include the following:</p>
<div class="infobox assignment">
<p><strong>Exam</strong></p>
<p>Each week we will provide a short task to test your knowledge, these should be used to guide your study for the final exam.</p>
<p>For the task this week use the tools you have learnt to start on a relevant practice exam question, <strong>however</strong>, next week we will explore spatial autocorrelation so you are not expected to finish your practice attempt this week.</p>
</div>
<div class="infobox note">
<p><strong>Reading</strong></p>
<p>This week:</p>
<ul>
<li><p><a href="https://mgimond.github.io/Spatial/chp11_0.html">Chapter 11 “Point Pattern Analysis”</a> from Intro to GIS and Spatial Analysis by Gimond (2019).</p></li>
<li><p><a href="https://moderndive.com/9-hypothesis-testing.html">Chapter 9 “Hypothesis testing”</a> from Modern Dive by Ismay and Kim (2019).</p></li>
<li><p><a href="https://www.vlebooks.com/Product/Index/2028147?page=0">Local models for spatial analysis</a> by Lloyd (2010)</p></li>
<li><p><a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0212606">Using OpenStreetMap point-of-interest data to model urban change—A feasibility study</a> by Zhang and Pfoser (2019).</p></li>
</ul>
<p>Remember this is just a starting point, explore the <a href="https://rl.talis.com/3/ucl/lists/139FBAF8-DACD-60FB-8BDC-E9C9E09BA885.html?lang=en-GB&amp;login=1">reading list</a>, practical and lecture for more ideas.</p>
</div>
</div>
<div id="recommended-listening-5" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Recommended listening 🎧<a href="#recommended-listening-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Some of these practicals are long, take regular breaks and have a listen to some of our fav tunes each week.</p>
<p><a href="https://www.youtube.com/watch?v=hlVBg7_08n0">Andy</a></p>
<p><a href="https://open.spotify.com/album/4OCAtcMneSzQKZGJK95ayo?si=YRtNrsspTF6XpTPRjv2XFg">Adam</a> This week it’s the head honcho himself, the man, the legend that is Tony Colman, CEO and founder of Hospital Records — his new album Building Better Worlds is a masterpiece! Enjoy!</p>
</div>
<div id="introduction-5" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Introduction<a href="detecting-spatial-patterns.html#introduction-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this practical you will learn how to begin to analyse patterns in spatial data. Using data you are already familiar with, this week, you will explore some techniques for analysing patterns of point data in R. Then, next week, you will explore spatial autocorrelation using R.</p>
<p>In this analysis we will analyse the patterns of Blue Plaques — you will see these placed on around the UK linking the buildings of the present to people of the past.</p>
<p>The question we want to answer is: <strong>“For any given London Borough, are the Blue Plaques within that borough distributed randomly or do they exhibit some kind of dispersed or clustered pattern?”</strong></p>
<p>Before we progress, take a minute to go back and refelct on <a href="#General%20data%20flow">Grolemund and Wickham’s typical workflow of a data science (or GIS) project from workshop 1</a></p>
<p>To answer this question, we will make use of some of the Point Pattern Analysis functions found in the <code>spatstat</code> package.</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="detecting-spatial-patterns.html#cb251-1" tabindex="-1"></a><span class="co">#first library a few packages that we will use during the practical</span></span>
<span id="cb251-2"><a href="detecting-spatial-patterns.html#cb251-2" tabindex="-1"></a><span class="co">#note you may need to install them first...</span></span>
<span id="cb251-3"><a href="detecting-spatial-patterns.html#cb251-3" tabindex="-1"></a><span class="fu">library</span>(spatstat)</span>
<span id="cb251-4"><a href="detecting-spatial-patterns.html#cb251-4" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb251-5"><a href="detecting-spatial-patterns.html#cb251-5" tabindex="-1"></a><span class="fu">library</span>(sp)</span>
<span id="cb251-6"><a href="detecting-spatial-patterns.html#cb251-6" tabindex="-1"></a><span class="fu">library</span>(tmap)</span>
<span id="cb251-7"><a href="detecting-spatial-patterns.html#cb251-7" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb251-8"><a href="detecting-spatial-patterns.html#cb251-8" tabindex="-1"></a><span class="fu">library</span>(tmaptools)</span></code></pre></div>
</div>
<div id="setting-up-your-data" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> Setting up your data<a href="detecting-spatial-patterns.html#setting-up-your-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now, assuming that you’ve got a copy of your London Boroughs shapefile (from week 1) in your new week 6 folder, along with a shapefile of your Blue Plaques. If not.. read in the data from <a href="http://geoportal.statistics.gov.uk/datasets/8edafbe3276d4b56aec60991cbddda50_2">the ONS geoportal</a></p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="detecting-spatial-patterns.html#cb252-1" tabindex="-1"></a><span class="do">##First, get the London Borough Boundaries</span></span>
<span id="cb252-2"><a href="detecting-spatial-patterns.html#cb252-2" tabindex="-1"></a>LondonBoroughs <span class="ot">&lt;-</span> <span class="fu">st_read</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Prac1_data&quot;</span>, <span class="st">&quot;statistical-gis-boundaries-london&quot;</span>, <span class="st">&quot;ESRI&quot;</span>, <span class="st">&quot;London_Borough_Excluding_MHW.shp&quot;</span>))</span></code></pre></div>
<pre><code>## Reading layer `London_Borough_Excluding_MHW&#39; from data source 
##   `C:\Users\Andy\OneDrive - University College London\Teaching\CASA0005\CASA0005repo\prac1_data\statistical-gis-boundaries-london\ESRI\London_Borough_Excluding_MHW.shp&#39; 
##   using driver `ESRI Shapefile&#39;
## Simple feature collection with 33 features and 8 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: 503568.2 ymin: 155850.8 xmax: 561957.5 ymax: 200933.9
## Projected CRS: OSGB36 / British National Grid</code></pre>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="detecting-spatial-patterns.html#cb254-1" tabindex="-1"></a><span class="co"># Or use this to read in directly.</span></span>
<span id="cb254-2"><a href="detecting-spatial-patterns.html#cb254-2" tabindex="-1"></a><span class="co">#LondonBoroughs &lt;- st_read(&quot;https://opendata.arcgis.com/datasets/8edafbe3276d4b56aec60991cbddda50_4.geojson&quot;)</span></span></code></pre></div>
<p>Pull out London using the <code>str_detect()</code> function from the <code>stringr</code> package in combination with <code>filter()</code> from <code>dplyr</code> (again!). We will look for the bit of the district code that relates to London (E09) from the ‘lad15cd’ column data frame of our <code>sf</code> object.</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="detecting-spatial-patterns.html#cb255-1" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb255-2"><a href="detecting-spatial-patterns.html#cb255-2" tabindex="-1"></a>BoroughMap <span class="ot">&lt;-</span> LondonBoroughs <span class="sc">%&gt;%</span></span>
<span id="cb255-3"><a href="detecting-spatial-patterns.html#cb255-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">str_detect</span>(GSS_CODE, <span class="st">&quot;^E09&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb255-4"><a href="detecting-spatial-patterns.html#cb255-4" tabindex="-1"></a>  <span class="fu">st_transform</span>(., <span class="dv">27700</span>)</span>
<span id="cb255-5"><a href="detecting-spatial-patterns.html#cb255-5" tabindex="-1"></a></span>
<span id="cb255-6"><a href="detecting-spatial-patterns.html#cb255-6" tabindex="-1"></a><span class="fu">qtm</span>(BoroughMap)</span></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-261-1.png" width="672" /></p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="detecting-spatial-patterns.html#cb256-1" tabindex="-1"></a><span class="fu">summary</span>(BoroughMap)</span></code></pre></div>
<pre><code>##      NAME             GSS_CODE            HECTARES         NONLD_AREA    
##  Length:33          Length:33          Min.   :  314.9   Min.   :  0.00  
##  Class :character   Class :character   1st Qu.: 2724.9   1st Qu.:  0.00  
##  Mode  :character   Mode  :character   Median : 3857.8   Median :  2.30  
##                                        Mean   : 4832.4   Mean   : 64.22  
##                                        3rd Qu.: 5658.5   3rd Qu.: 95.60  
##                                        Max.   :15013.5   Max.   :370.62  
##   ONS_INNER           SUB_2009           SUB_2006            numeruc     
##  Length:33          Length:33          Length:33          Min.   :    3  
##  Class :character   Class :character   Class :character   1st Qu.: 1443  
##  Mode  :character   Mode  :character   Mode  :character   Median : 3615  
##                                                           Mean   : 5038  
##                                                           3rd Qu.: 7231  
##                                                           Max.   :17036  
##           geometry 
##  MULTIPOLYGON :33  
##  epsg:27700   : 0  
##  +proj=tmer...: 0  
##                    
##                    
## </code></pre>
<p>Now get the location of all Blue Plaques in the City direct from the web</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="detecting-spatial-patterns.html#cb258-1" tabindex="-1"></a><span class="do">##Now get the location of all Blue Plaques in the City</span></span>
<span id="cb258-2"><a href="detecting-spatial-patterns.html#cb258-2" tabindex="-1"></a><span class="co">#BluePlaques &lt;- st_read(&quot;https://s3.eu-west-2.amazonaws.com/openplaques/open-plaques-london-2018-04-08.geojson&quot;)</span></span></code></pre></div>
<p>Or read them in from your project folder.</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="detecting-spatial-patterns.html#cb259-1" tabindex="-1"></a>BluePlaques <span class="ot">&lt;-</span> <span class="fu">st_read</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;prac6_data&quot;</span>,</span>
<span id="cb259-2"><a href="detecting-spatial-patterns.html#cb259-2" tabindex="-1"></a>                                  <span class="st">&quot;open-plaques-london-2018-04-08.geojson&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb259-3"><a href="detecting-spatial-patterns.html#cb259-3" tabindex="-1"></a>  <span class="fu">st_transform</span>(.,<span class="dv">27700</span>)</span></code></pre></div>
<pre><code>## Reading layer `open-plaques-london-2018-04-08&#39; from data source 
##   `C:\Users\Andy\OneDrive - University College London\Teaching\CASA0005\CASA0005repo\prac6_data\open-plaques-london-2018-04-08.geojson&#39; 
##   using driver `GeoJSON&#39;
## Simple feature collection with 2812 features and 2 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: -0.477 ymin: 0 xmax: 0.21903 ymax: 51.6783
## Geodetic CRS:  WGS 84</code></pre>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="detecting-spatial-patterns.html#cb261-1" tabindex="-1"></a><span class="fu">summary</span>(BluePlaques)</span></code></pre></div>
<pre><code>##        id          inscription                 geometry   
##  Min.   :    1.0   Length:2812        POINT        :2812  
##  1st Qu.:  711.8   Class :character   epsg:27700   :   0  
##  Median : 6089.0   Mode  :character   +proj=tmer...:   0  
##  Mean   :10622.0                                          
##  3rd Qu.:10358.2                                          
##  Max.   :49190.0</code></pre>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="detecting-spatial-patterns.html#cb263-1" tabindex="-1"></a><span class="co">#plot the blue plaques in the city</span></span>
<span id="cb263-2"><a href="detecting-spatial-patterns.html#cb263-2" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">&quot;plot&quot;</span>)</span>
<span id="cb263-3"><a href="detecting-spatial-patterns.html#cb263-3" tabindex="-1"></a></span>
<span id="cb263-4"><a href="detecting-spatial-patterns.html#cb263-4" tabindex="-1"></a><span class="fu">tm_shape</span>(BoroughMap) <span class="sc">+</span></span>
<span id="cb263-5"><a href="detecting-spatial-patterns.html#cb263-5" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">fill_alpha =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb263-6"><a href="detecting-spatial-patterns.html#cb263-6" tabindex="-1"></a><span class="fu">tm_shape</span>(BluePlaques) <span class="sc">+</span></span>
<span id="cb263-7"><a href="detecting-spatial-patterns.html#cb263-7" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size=</span><span class="fl">0.1</span>)</span></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-263-1.png" width="672" /></p>
<div id="data-cleaning" class="section level3 hasAnchor" number="6.5.1">
<h3><span class="header-section-number">6.5.1</span> Data cleaning<a href="detecting-spatial-patterns.html#data-cleaning" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now, you might have noticed that there is at least one Blue Plaque that falls outside of the Borough boundaries. Errant plaques will cause problems with our analysis, so we need to clip the plaques to the boundaries…First we’ll remove any Plaques with the same grid reference as this will cause problems later on in the analysis..</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="detecting-spatial-patterns.html#cb264-1" tabindex="-1"></a><span class="co">#remove duplicates</span></span>
<span id="cb264-2"><a href="detecting-spatial-patterns.html#cb264-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb264-3"><a href="detecting-spatial-patterns.html#cb264-3" tabindex="-1"></a></span>
<span id="cb264-4"><a href="detecting-spatial-patterns.html#cb264-4" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb264-5"><a href="detecting-spatial-patterns.html#cb264-5" tabindex="-1"></a>BluePlaques <span class="ot">&lt;-</span> <span class="fu">distinct</span>(BluePlaques)</span></code></pre></div>
</div>
<div id="spatial-subsetting" class="section level3 hasAnchor" number="6.5.2">
<h3><span class="header-section-number">6.5.2</span> Spatial subsetting<a href="detecting-spatial-patterns.html#spatial-subsetting" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now just select the points inside London - thanks to Robin Lovelace for posting how to do this one, very useful! Here, the second operator is blank <code>, ,</code> - this controls which attributes are kept, although I’d rather keep all of them and manipulate with the <code>tidyverse</code>.</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="detecting-spatial-patterns.html#cb265-1" tabindex="-1"></a>BluePlaquesSub <span class="ot">&lt;-</span> BluePlaques[BoroughMap,]</span>
<span id="cb265-2"><a href="detecting-spatial-patterns.html#cb265-2" tabindex="-1"></a></span>
<span id="cb265-3"><a href="detecting-spatial-patterns.html#cb265-3" tabindex="-1"></a><span class="co">#plot the blue plaques in the city</span></span>
<span id="cb265-4"><a href="detecting-spatial-patterns.html#cb265-4" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">&quot;plot&quot;</span>)</span>
<span id="cb265-5"><a href="detecting-spatial-patterns.html#cb265-5" tabindex="-1"></a></span>
<span id="cb265-6"><a href="detecting-spatial-patterns.html#cb265-6" tabindex="-1"></a><span class="co">#check to see that they&#39;ve been removed</span></span>
<span id="cb265-7"><a href="detecting-spatial-patterns.html#cb265-7" tabindex="-1"></a><span class="fu">tm_shape</span>(BoroughMap) <span class="sc">+</span></span>
<span id="cb265-8"><a href="detecting-spatial-patterns.html#cb265-8" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">fill_alpha =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb265-9"><a href="detecting-spatial-patterns.html#cb265-9" tabindex="-1"></a><span class="fu">tm_shape</span>(BluePlaquesSub) <span class="sc">+</span></span>
<span id="cb265-10"><a href="detecting-spatial-patterns.html#cb265-10" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size=</span><span class="fl">0.1</span>)</span></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-265-1.png" width="672" /></p>
<p>When we spatial subset data like this there are different topological relations we can specify. The default is intersects, but we could also use <code>BluePlaquesSub &lt;- BluePlaques[BoroughMap, , op = st_within]</code>, with the operator or op set to <code>st_within</code>, to identify points completely within the borough outline. Any topological operator from the mapping week can be used here!</p>
<p>We can also just use the function which will have the indices of where they intersect.</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="detecting-spatial-patterns.html#cb266-1" tabindex="-1"></a><span class="co"># add sparse=false to get the complete matrix.</span></span>
<span id="cb266-2"><a href="detecting-spatial-patterns.html#cb266-2" tabindex="-1"></a><span class="co"># this is the same as select by location in QGIS</span></span>
<span id="cb266-3"><a href="detecting-spatial-patterns.html#cb266-3" tabindex="-1"></a><span class="co"># filter from dplyr is the same as select by attribute </span></span>
<span id="cb266-4"><a href="detecting-spatial-patterns.html#cb266-4" tabindex="-1"></a>intersect_indices <span class="ot">&lt;-</span><span class="fu">st_intersects</span>(BoroughMap, BluePlaques)</span></code></pre></div>
</div>
<div id="spatial-clipping" class="section level3 hasAnchor" number="6.5.3">
<h3><span class="header-section-number">6.5.3</span> Spatial clipping<a href="detecting-spatial-patterns.html#spatial-clipping" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In a similar theme to topological relations we can also use spatial clipping. This is where we take to layers and extract something. For example, where do the polygons from two different datasets overlap? We want to make a new layer of just the overlapping area…this is somewhat similar to the joins we explored with attribute data (e.g. joining based on a unique attribute column) but here we use shapes…</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-267"></span>
<img src="prac6_images/venn-clip-1.png" alt="Topological relations between vector geometries. Source: [Lovelace et al. 2022](https://geocompr.robinlovelace.net/geometry-operations.html?q=st_intersection#clipping)" width="600px" />
<p class="caption">
Figure 6.1: Topological relations between vector geometries. Source: <a href="https://geocompr.robinlovelace.net/geometry-operations.html?q=st_intersection#clipping">Lovelace et al. 2022</a>
</p>
</div>
</div>
<div id="key-advice-1" class="section level3 hasAnchor" number="6.5.4">
<h3><span class="header-section-number">6.5.4</span> Key advice<a href="detecting-spatial-patterns.html#key-advice-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Over the last two weeks we’ve seen:</p>
<ul>
<li>Spatial joining</li>
<li>Spatial sub-setting</li>
<li>Spatial clipping</li>
</ul>
<p>Question….do i want to:</p>
<ul>
<li><p>Select points or polygons in a polygon (Selecting data by location) = <strong>spatial sub-setting</strong>. This is just presence or absence within (or whatever function we use) an sf object.</p>
<ul>
<li>This could also be a topological function (e.g. week 5 - <code>Hotels_example &lt;-st_contains(Londonborough, OSM)</code>). However, this can give us a <strong>geometric (geometry)</strong> intersection (e.g. a sf output of intersecting points), compared to just a binary presence or absence.</li>
</ul></li>
<li><p>Determine where datasets overlap (or touch, or don’t overlap) and extract those parts = <strong>spatial clipping</strong></p></li>
<li><p>Join two spatial datasets together = <strong>spatial joining</strong>, which can use spatial subsetting functions as the default is <code>st_intersects()</code>. This function joins spatial data.</p></li>
</ul>
<p>Finally,</p>
<ul>
<li>Selecting data by attributes = filtering or selecting rows / columns with dplyr</li>
</ul>
<p>Most of these functions are not R specific, you will find them other software such as PostGIS (a database for spatial data).</p>
<div class="infobox warning">
<p>What is the difference between <code>st_intersects()</code> and <code>st_intersection()</code></p>
</div>
</div>
<div id="study-area-1" class="section level3 hasAnchor" number="6.5.5">
<h3><span class="header-section-number">6.5.5</span> Study area<a href="detecting-spatial-patterns.html#study-area-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>From this point, we could try and carry out our analysis on the whole of London, but you might be waiting until next week for Ripley’s K to be calculated for this many points. Therefore to speed things up and to enable us to compare areas within London, we will select some individual boroughs. First we need to subset our sf object to pull out a borough we are interested in. I’m going to choose Harrow as I know there are few enough points for the analysis to definitely work. If you wish, feel free to choose another borough in London and run the same analysis, but beware that if it happens that there are a lot of blue plaques in your borough, the analysis could fall over!!</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="detecting-spatial-patterns.html#cb267-1" tabindex="-1"></a><span class="co">#extract the borough</span></span>
<span id="cb267-2"><a href="detecting-spatial-patterns.html#cb267-2" tabindex="-1"></a></span>
<span id="cb267-3"><a href="detecting-spatial-patterns.html#cb267-3" tabindex="-1"></a><span class="co"># select by attribute</span></span>
<span id="cb267-4"><a href="detecting-spatial-patterns.html#cb267-4" tabindex="-1"></a>Harrow <span class="ot">&lt;-</span> BoroughMap <span class="sc">%&gt;%</span></span>
<span id="cb267-5"><a href="detecting-spatial-patterns.html#cb267-5" tabindex="-1"></a>  <span class="fu">filter</span>(., NAME<span class="sc">==</span><span class="st">&quot;Harrow&quot;</span>)</span>
<span id="cb267-6"><a href="detecting-spatial-patterns.html#cb267-6" tabindex="-1"></a></span>
<span id="cb267-7"><a href="detecting-spatial-patterns.html#cb267-7" tabindex="-1"></a><span class="co">#Check to see that the correct borough has been pulled out</span></span>
<span id="cb267-8"><a href="detecting-spatial-patterns.html#cb267-8" tabindex="-1"></a><span class="fu">tm_shape</span>(Harrow) <span class="sc">+</span></span>
<span id="cb267-9"><a href="detecting-spatial-patterns.html#cb267-9" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="cn">NA</span>, <span class="at">fill_alpha =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-268-1.png" width="672" /></p>
<p>Next we need to clip our Blue Plaques so that we have a subset of just those that fall within the borough or interest</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="detecting-spatial-patterns.html#cb268-1" tabindex="-1"></a><span class="co">#clip the data to our single borough</span></span>
<span id="cb268-2"><a href="detecting-spatial-patterns.html#cb268-2" tabindex="-1"></a>BluePlaquesSub <span class="ot">&lt;-</span> BluePlaques[Harrow,]</span>
<span id="cb268-3"><a href="detecting-spatial-patterns.html#cb268-3" tabindex="-1"></a></span>
<span id="cb268-4"><a href="detecting-spatial-patterns.html#cb268-4" tabindex="-1"></a></span>
<span id="cb268-5"><a href="detecting-spatial-patterns.html#cb268-5" tabindex="-1"></a></span>
<span id="cb268-6"><a href="detecting-spatial-patterns.html#cb268-6" tabindex="-1"></a><span class="co">#check that it&#39;s worked</span></span>
<span id="cb268-7"><a href="detecting-spatial-patterns.html#cb268-7" tabindex="-1"></a><span class="fu">tm_shape</span>(Harrow) <span class="sc">+</span></span>
<span id="cb268-8"><a href="detecting-spatial-patterns.html#cb268-8" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">fill_alpha =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb268-9"><a href="detecting-spatial-patterns.html#cb268-9" tabindex="-1"></a><span class="fu">tm_shape</span>(BluePlaquesSub) <span class="sc">+</span></span>
<span id="cb268-10"><a href="detecting-spatial-patterns.html#cb268-10" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size=</span><span class="fl">0.1</span>)</span></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-269-1.png" width="672" /></p>
<p>We now have all of our data set up so that we can start the analysis using <code>spatstat</code>. The first thing we need to do is create an observation window for <code>spatstat</code> to carry out its analysis within — we’ll set this to the extent of the Harrow boundary</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="detecting-spatial-patterns.html#cb269-1" tabindex="-1"></a><span class="co">#now set a window as the borough boundary</span></span>
<span id="cb269-2"><a href="detecting-spatial-patterns.html#cb269-2" tabindex="-1"></a>window <span class="ot">&lt;-</span> <span class="fu">as.owin</span>(Harrow)</span>
<span id="cb269-3"><a href="detecting-spatial-patterns.html#cb269-3" tabindex="-1"></a><span class="fu">plot</span>(window)</span></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-270-1.png" width="672" /></p>
<p><a href="https://spatstat.org/"><code>spatstat</code></a> has its own set of spatial objects that it works with (one of the delights of R is that different packages are written by different people and many have developed their own data types) — it does not work directly with the SpatialPolygonsDataFrames, SpatialPointsDataFrames or <code>sf</code> objects that we are used to. For point pattern analysis, we need to create a point pattern (ppp) object.</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="detecting-spatial-patterns.html#cb270-1" tabindex="-1"></a><span class="co">#create a sp object</span></span>
<span id="cb270-2"><a href="detecting-spatial-patterns.html#cb270-2" tabindex="-1"></a>BluePlaquesSub<span class="ot">&lt;-</span> BluePlaquesSub <span class="sc">%&gt;%</span></span>
<span id="cb270-3"><a href="detecting-spatial-patterns.html#cb270-3" tabindex="-1"></a>  <span class="fu">as</span>(., <span class="st">&#39;Spatial&#39;</span>)</span>
<span id="cb270-4"><a href="detecting-spatial-patterns.html#cb270-4" tabindex="-1"></a><span class="co">#create a ppp object</span></span>
<span id="cb270-5"><a href="detecting-spatial-patterns.html#cb270-5" tabindex="-1"></a>BluePlaquesSub.ppp <span class="ot">&lt;-</span> <span class="fu">ppp</span>(<span class="at">x=</span>BluePlaquesSub<span class="sc">@</span>coords[,<span class="dv">1</span>],</span>
<span id="cb270-6"><a href="detecting-spatial-patterns.html#cb270-6" tabindex="-1"></a>                          <span class="at">y=</span>BluePlaquesSub<span class="sc">@</span>coords[,<span class="dv">2</span>],</span>
<span id="cb270-7"><a href="detecting-spatial-patterns.html#cb270-7" tabindex="-1"></a>                          <span class="at">window=</span>window)</span></code></pre></div>
<p>Try to understand what the different elements in command above is doing. If you are unsure, you can run elements of the code, for example:</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="detecting-spatial-patterns.html#cb271-1" tabindex="-1"></a>BluePlaquesSub<span class="sc">@</span>coords[,<span class="dv">1</span>]</span></code></pre></div>
<pre><code>##  [1] 516451.0 518560.0 514177.1 515166.2 513053.6 515093.1 515210.7 516746.3
##  [9] 513371.5 514971.1 517339.4 512215.1 515300.0 514966.0 512639.2 515561.8
## [17] 515561.8 511539.4 516725.5 512335.7 515370.2 518598.3 511792.6 515694.1
## [25] 513008.4 514805.8 513392.3 518187.5 513750.4 512466.7 515491.4 514789.8
## [33] 514022.4 519099.9 514183.4 512343.1 512508.2 512346.3 512269.5 515333.7</code></pre>
<p>Have a look at the new ppp object</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="detecting-spatial-patterns.html#cb273-1" tabindex="-1"></a>BluePlaquesSub.ppp <span class="sc">%&gt;%</span></span>
<span id="cb273-2"><a href="detecting-spatial-patterns.html#cb273-2" tabindex="-1"></a>  <span class="fu">plot</span>(.,<span class="at">pch=</span><span class="dv">16</span>,<span class="at">cex=</span><span class="fl">0.5</span>, </span>
<span id="cb273-3"><a href="detecting-spatial-patterns.html#cb273-3" tabindex="-1"></a>       <span class="at">main=</span><span class="st">&quot;Blue Plaques Harrow&quot;</span>)</span></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-273-1.png" width="672" /></p>
</div>
</div>
<div id="point-pattern-analysis" class="section level2 hasAnchor" number="6.6">
<h2><span class="header-section-number">6.6</span> Point pattern analysis<a href="detecting-spatial-patterns.html#point-pattern-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="kernel-density-estimation" class="section level3 hasAnchor" number="6.6.1">
<h3><span class="header-section-number">6.6.1</span> Kernel Density Estimation<a href="detecting-spatial-patterns.html#kernel-density-estimation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>One way to summarise your point data is to plot the density of your points under a window called a ‘Kernel’. The size and shape of the Kernel affects the density pattern produced, but it is very easy to produce a Kernel Density Estimation (KDE) map from a ppp object using the <code>density()</code> function.</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="detecting-spatial-patterns.html#cb274-1" tabindex="-1"></a>BluePlaquesSub.ppp <span class="sc">%&gt;%</span></span>
<span id="cb274-2"><a href="detecting-spatial-patterns.html#cb274-2" tabindex="-1"></a>  <span class="fu">density</span>(., <span class="at">sigma=</span><span class="dv">500</span>) <span class="sc">%&gt;%</span></span>
<span id="cb274-3"><a href="detecting-spatial-patterns.html#cb274-3" tabindex="-1"></a>  <span class="fu">plot</span>()</span></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-274-1.png" width="672" /></p>
<p>The sigma value sets the diameter of the Kernel (in the units your map is in — in this case, as we are in British National Grid the units are in metres). Try experimenting with different values of sigma to see how that affects the density estimate.</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="detecting-spatial-patterns.html#cb275-1" tabindex="-1"></a>BluePlaquesSub.ppp <span class="sc">%&gt;%</span></span>
<span id="cb275-2"><a href="detecting-spatial-patterns.html#cb275-2" tabindex="-1"></a>  <span class="fu">density</span>(., <span class="at">sigma=</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb275-3"><a href="detecting-spatial-patterns.html#cb275-3" tabindex="-1"></a>  <span class="fu">plot</span>()</span></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-275-1.png" width="672" /></p>
</div>
<div id="quadrat-analysis" class="section level3 hasAnchor" number="6.6.2">
<h3><span class="header-section-number">6.6.2</span> Quadrat Analysis<a href="detecting-spatial-patterns.html#quadrat-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>So as you saw in the lecture, we are interesting in knowing whether the distribution of points in our study area differs from ‘complete spatial randomness’ — CSR. That’s different from a CRS! Be careful!</p>
<p>The most basic test of CSR is a quadrat analysis. We can carry out a simple quadrat analysis on our data using the <code>quadrat count</code> function in <code>spatstat</code>. <em>Note, I wouldn’t recommend doing a quadrat analysis in any real piece of analysis you conduct, but it is useful for starting to understand the Poisson distribution…</em></p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="detecting-spatial-patterns.html#cb276-1" tabindex="-1"></a><span class="co">#First plot the points</span></span>
<span id="cb276-2"><a href="detecting-spatial-patterns.html#cb276-2" tabindex="-1"></a><span class="fu">plot</span>(BluePlaquesSub.ppp,</span>
<span id="cb276-3"><a href="detecting-spatial-patterns.html#cb276-3" tabindex="-1"></a>     <span class="at">pch=</span><span class="dv">16</span>,</span>
<span id="cb276-4"><a href="detecting-spatial-patterns.html#cb276-4" tabindex="-1"></a>     <span class="at">cex=</span><span class="fl">0.5</span>, </span>
<span id="cb276-5"><a href="detecting-spatial-patterns.html#cb276-5" tabindex="-1"></a>     <span class="at">main=</span><span class="st">&quot;Blue Plaques in Harrow&quot;</span>)</span>
<span id="cb276-6"><a href="detecting-spatial-patterns.html#cb276-6" tabindex="-1"></a></span>
<span id="cb276-7"><a href="detecting-spatial-patterns.html#cb276-7" tabindex="-1"></a><span class="co">#now count the points in that fall in a 6 x 6</span></span>
<span id="cb276-8"><a href="detecting-spatial-patterns.html#cb276-8" tabindex="-1"></a><span class="co">#grid overlaid across the windowBluePlaquesSub.ppp2&lt;-BluePlaquesSub.ppp %&gt;%</span></span>
<span id="cb276-9"><a href="detecting-spatial-patterns.html#cb276-9" tabindex="-1"></a>BluePlaquesSub.ppp <span class="sc">%&gt;%</span></span>
<span id="cb276-10"><a href="detecting-spatial-patterns.html#cb276-10" tabindex="-1"></a>  <span class="fu">quadratcount</span>(.,<span class="at">nx =</span> <span class="dv">6</span>, <span class="at">ny =</span> <span class="dv">6</span>)<span class="sc">%&gt;%</span></span>
<span id="cb276-11"><a href="detecting-spatial-patterns.html#cb276-11" tabindex="-1"></a>    <span class="fu">plot</span>(., <span class="at">add=</span>T, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-276-1.png" width="672" /></p>
<p>In our case here, want to know whether or not there is any kind of spatial patterning associated with the Blue Plaques in areas of London. If you recall from the lecture, this means comparing our observed distribution of points with a statistically likely (Complete Spatial Random) distibution, based on the Poisson distribution.</p>
<p>Using the same <code>quadratcount()</code> function again (for the same sized grid) we can save the results into a table:</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="detecting-spatial-patterns.html#cb277-1" tabindex="-1"></a><span class="co">#run the quadrat count</span></span>
<span id="cb277-2"><a href="detecting-spatial-patterns.html#cb277-2" tabindex="-1"></a>Qcount <span class="ot">&lt;-</span> BluePlaquesSub.ppp <span class="sc">%&gt;%</span></span>
<span id="cb277-3"><a href="detecting-spatial-patterns.html#cb277-3" tabindex="-1"></a>  <span class="fu">quadratcount</span>(.,<span class="at">nx =</span> <span class="dv">6</span>, <span class="at">ny =</span> <span class="dv">6</span>) <span class="sc">%&gt;%</span></span>
<span id="cb277-4"><a href="detecting-spatial-patterns.html#cb277-4" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb277-5"><a href="detecting-spatial-patterns.html#cb277-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">count</span>(<span class="at">Var1=</span>Freq)<span class="sc">%&gt;%</span></span>
<span id="cb277-6"><a href="detecting-spatial-patterns.html#cb277-6" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Freqquadratcount=</span>n)</span></code></pre></div>
<p>Check the data type in the first column — if it is factor, we will need to convert it to numeric</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="detecting-spatial-patterns.html#cb278-1" tabindex="-1"></a>Qcount <span class="sc">%&gt;%</span> </span>
<span id="cb278-2"><a href="detecting-spatial-patterns.html#cb278-2" tabindex="-1"></a>  <span class="fu">summarise_all</span>(class)</span></code></pre></div>
<pre><code>##      Var1 Freqquadratcount
## 1 integer          integer</code></pre>
<p>OK, so we now have a frequency table — next we need to calculate our expected values. The formula for calculating expected probabilities based on the Poisson distribution is:</p>
<p><span class="math display">\[Pr= (X =k) = \frac{\lambda^{k}e^{-\lambda}}{k!}\]</span>
where:</p>
<ul>
<li><p><code>x</code> is the number of occurrences</p></li>
<li><p><code>λ</code> is the mean number of occurrences</p></li>
<li><p><code>e</code> is a constant- 2.718</p></li>
</ul>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="detecting-spatial-patterns.html#cb280-1" tabindex="-1"></a>sums <span class="ot">&lt;-</span> Qcount <span class="sc">%&gt;%</span></span>
<span id="cb280-2"><a href="detecting-spatial-patterns.html#cb280-2" tabindex="-1"></a>  <span class="co">#calculate the total blue plaques (Var * Freq)</span></span>
<span id="cb280-3"><a href="detecting-spatial-patterns.html#cb280-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total =</span> Var1 <span class="sc">*</span> Freqquadratcount) <span class="sc">%&gt;%</span></span>
<span id="cb280-4"><a href="detecting-spatial-patterns.html#cb280-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), sum))<span class="sc">%&gt;%</span></span>
<span id="cb280-5"><a href="detecting-spatial-patterns.html#cb280-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>Var1) </span>
<span id="cb280-6"><a href="detecting-spatial-patterns.html#cb280-6" tabindex="-1"></a></span>
<span id="cb280-7"><a href="detecting-spatial-patterns.html#cb280-7" tabindex="-1"></a>lambda<span class="ot">&lt;-</span> Qcount<span class="sc">%&gt;%</span></span>
<span id="cb280-8"><a href="detecting-spatial-patterns.html#cb280-8" tabindex="-1"></a>  <span class="co">#calculate lambda</span></span>
<span id="cb280-9"><a href="detecting-spatial-patterns.html#cb280-9" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total =</span> Var1 <span class="sc">*</span> Freqquadratcount)<span class="sc">%&gt;%</span></span>
<span id="cb280-10"><a href="detecting-spatial-patterns.html#cb280-10" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), sum)) <span class="sc">%&gt;%</span></span>
<span id="cb280-11"><a href="detecting-spatial-patterns.html#cb280-11" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lambda=</span>total<span class="sc">/</span>Freqquadratcount) <span class="sc">%&gt;%</span></span>
<span id="cb280-12"><a href="detecting-spatial-patterns.html#cb280-12" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(lambda)<span class="sc">%&gt;%</span></span>
<span id="cb280-13"><a href="detecting-spatial-patterns.html#cb280-13" tabindex="-1"></a>  <span class="fu">pull</span>(lambda)</span></code></pre></div>
<p>Calculate expected using the Poisson formula from above <span class="math inline">\(k\)</span> is the number of blue plaques counted in a square and is found in the first column of our table…</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="detecting-spatial-patterns.html#cb281-1" tabindex="-1"></a>QCountTable <span class="ot">&lt;-</span> Qcount <span class="sc">%&gt;%</span></span>
<span id="cb281-2"><a href="detecting-spatial-patterns.html#cb281-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Pr=</span>((lambda<span class="sc">^</span>Var1)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda))<span class="sc">/</span><span class="fu">factorial</span>(Var1))<span class="sc">%&gt;%</span></span>
<span id="cb281-3"><a href="detecting-spatial-patterns.html#cb281-3" tabindex="-1"></a>  <span class="co">#now calculate the expected counts based on our total number of plaques</span></span>
<span id="cb281-4"><a href="detecting-spatial-patterns.html#cb281-4" tabindex="-1"></a>  <span class="co">#and save them to the table</span></span>
<span id="cb281-5"><a href="detecting-spatial-patterns.html#cb281-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Expected=</span> (<span class="fu">round</span>(Pr <span class="sc">*</span> sums<span class="sc">$</span>Freqquadratcount, <span class="dv">0</span>)))</span>
<span id="cb281-6"><a href="detecting-spatial-patterns.html#cb281-6" tabindex="-1"></a></span>
<span id="cb281-7"><a href="detecting-spatial-patterns.html#cb281-7" tabindex="-1"></a><span class="co">#Compare the frequency distributions of the observed and expected point patterns</span></span>
<span id="cb281-8"><a href="detecting-spatial-patterns.html#cb281-8" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">14</span>), <span class="at">type=</span><span class="st">&quot;n&quot;</span>,</span>
<span id="cb281-9"><a href="detecting-spatial-patterns.html#cb281-9" tabindex="-1"></a><span class="at">xlab=</span><span class="st">&quot;Number of Blue Plaques (Red=Observed,Blue=Expected)&quot;</span>, </span>
<span id="cb281-10"><a href="detecting-spatial-patterns.html#cb281-10" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;Frequency of Occurances&quot;</span>)</span>
<span id="cb281-11"><a href="detecting-spatial-patterns.html#cb281-11" tabindex="-1"></a><span class="fu">points</span>(QCountTable<span class="sc">$</span>Freqquadratcount, </span>
<span id="cb281-12"><a href="detecting-spatial-patterns.html#cb281-12" tabindex="-1"></a>       <span class="at">col=</span><span class="st">&quot;Red&quot;</span>, </span>
<span id="cb281-13"><a href="detecting-spatial-patterns.html#cb281-13" tabindex="-1"></a>       <span class="at">type=</span><span class="st">&quot;o&quot;</span>, </span>
<span id="cb281-14"><a href="detecting-spatial-patterns.html#cb281-14" tabindex="-1"></a>       <span class="at">lwd=</span><span class="dv">3</span>)</span>
<span id="cb281-15"><a href="detecting-spatial-patterns.html#cb281-15" tabindex="-1"></a><span class="fu">points</span>(QCountTable<span class="sc">$</span>Expected, <span class="at">col=</span><span class="st">&quot;Blue&quot;</span>, </span>
<span id="cb281-16"><a href="detecting-spatial-patterns.html#cb281-16" tabindex="-1"></a>       <span class="at">type=</span><span class="st">&quot;o&quot;</span>, </span>
<span id="cb281-17"><a href="detecting-spatial-patterns.html#cb281-17" tabindex="-1"></a>       <span class="at">lwd=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-280-1.png" width="672" />
Comparing the observed and expected frequencies for our quadrant counts, we can observe that they both have higher frequency counts at the lower end — something reminiscent of a Poisson distribution. This could indicate that for this particular set of quadrants, our pattern is close to Complete Spatial Randomness (i.e. no clustering or dispersal of points). But how do we confirm this?</p>
<p>To check for sure, we can use the <code>quadrat.test()</code> function, built into <code>spatstat</code>. This uses a Chi Squared test to compare the observed and expected frequencies for each quadrant (rather than for quadrant bins, as we have just computed above).</p>
<p>A Chi-Squared test determines if there is an association between two categorical variables. The higher the Chi-Squared value, the greater the difference.</p>
<p>If the p-value of our Chi-Squared test is &lt; 0.05, then we can reject a null hypothesis that says “there is no pattern - i.e. complete spatial randomness - in our data” (think of a null-hypothesis as the opposite of a hypothesis that says our data exhibit a pattern). What we need to look for is a value for p &gt; 0.05. If our p-value is &gt; 0.05 then this indicates that we have CSR and there is no pattern in our points. If it is &lt; 0.05, this indicates that we do have clustering in our points.</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="detecting-spatial-patterns.html#cb282-1" tabindex="-1"></a>teststats <span class="ot">&lt;-</span> <span class="fu">quadrat.test</span>(BluePlaquesSub.ppp, <span class="at">nx =</span> <span class="dv">6</span>, <span class="at">ny =</span> <span class="dv">6</span>)</span></code></pre></div>
<pre><code>## Warning: Some expected counts are small; chi^2 approximation may be inaccurate</code></pre>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="detecting-spatial-patterns.html#cb284-1" tabindex="-1"></a><span class="fu">plot</span>(BluePlaquesSub.ppp,<span class="at">pch=</span><span class="dv">16</span>,<span class="at">cex=</span><span class="fl">0.5</span>, <span class="at">main=</span><span class="st">&quot;Blue Plaques in Harrow&quot;</span>)</span>
<span id="cb284-2"><a href="detecting-spatial-patterns.html#cb284-2" tabindex="-1"></a><span class="fu">plot</span>(teststats, <span class="at">add=</span>T, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-281-1.png" width="672" /></p>
<p>Here our p-value = 0.2594, implying complete spatial randomness. But there are limitations of using qudrants like this…that we will explore next.</p>
<p>Note the warning message — some of the observed counts are very small (0) and this may affect the accuracy of the quadrant test. Recall that the Poisson distribution only describes observed occurrances that are counted in integers — where our occurrences = 0 (i.e. not observed), this can be an issue. We also know that there are various other problems that might affect our quadrat analysis, such as the <a href="https://www.youtube.com/watch?v=cZdlxDx4Nvs">modifiable areal unit problem</a>.</p>
<p>In the new plot, we can see three figures for each quadrant. The top-left figure is the observed count of points; the top-right is the Poisson expected number of points; the bottom value is the residual value (also known as Pearson residual value), or (Observed - Expected) / Sqrt(Expected).</p>
<div class="infobox note">
<p>This is the first mention of the mathematician Karl Pearson who founded the world’s first university statistics department here at UCL. Pearson was a eugenicist and the Unversity’s first Chair of Eugenics that was established on the request of Galton (who coined the term eugenics and Pearson studied under) for the residue of his estate. Throuhgout research you may encounter Pearson’s name as it is used to identify certain techniques, for example, Pearson’s product-moment coefficient (alternatively just product-moment coefficient). Where possible within this book I have removed references to Pearson, although as you will see later on some arguments in functions still require the value “pearson” and certain output messages default to include his name. UCL recently <a href="https://www.ucl.ac.uk/news/2020/jun/ucl-denames-buildings-named-after-eugenicists?utm_source=UCL%20%28Internal%20Communications%29&amp;utm_medium=email&amp;utm_campaign=11621861_Provost%27s%20View%3A%2019%20June%202020&amp;utm_content=UCL%20News%20denaming%20story">denamed spaces and buildings</a> named after Pearson and Galton.</p>
</div>
</div>
<div id="try-experimenting" class="section level3 hasAnchor" number="6.6.3">
<h3><span class="header-section-number">6.6.3</span> Try experimenting…<a href="detecting-spatial-patterns.html#try-experimenting" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Try running a quadrant analysis for different grid arrangements (2 x 2, 3 x 3, 10 x 10 etc.) — how does this affect your results?</p>
</div>
<div id="ripleys-k" class="section level3 hasAnchor" number="6.6.4">
<h3><span class="header-section-number">6.6.4</span> Ripley’s K<a href="detecting-spatial-patterns.html#ripleys-k" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>One way of getting around the limitations of quadrat analysis is to compare the observed distribution of points with the Poisson random model for a whole range of different distance radii. This is what Ripley’s K function computes.</p>
<p>We can conduct a Ripley’s K test on our data very simply with the <code>spatstat</code> package using the <code>kest()</code> function.</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="detecting-spatial-patterns.html#cb285-1" tabindex="-1"></a>K <span class="ot">&lt;-</span> BluePlaquesSub.ppp <span class="sc">%&gt;%</span></span>
<span id="cb285-2"><a href="detecting-spatial-patterns.html#cb285-2" tabindex="-1"></a>  <span class="fu">Kest</span>(., <span class="at">correction=</span><span class="st">&quot;border&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb285-3"><a href="detecting-spatial-patterns.html#cb285-3" tabindex="-1"></a>  <span class="fu">plot</span>()</span></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-282-1.png" width="672" /></p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="detecting-spatial-patterns.html#cb286-1" tabindex="-1"></a><span class="co"># we can also extract the plot into a dataframe</span></span>
<span id="cb286-2"><a href="detecting-spatial-patterns.html#cb286-2" tabindex="-1"></a>Kval <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">Kest</span>(BluePlaquesSub.ppp, <span class="at">correction =</span> <span class="st">&quot;Ripley&quot;</span>))</span></code></pre></div>
<p>Ripley’s K is defined as…</p>
<p><span class="math display">\[K(r) = \lambda^{-1} \sum{i}\sum{j}\frac{I(d_ij&lt;r)}{n}\]</span></p>
<ul>
<li><p>In English: Ripley’s K value for any circle radius <span class="math inline">\(r\)</span> =</p>
<ul>
<li><p>The average density of points for the <strong>entire study region (of all locations)</strong> <span class="math inline">\(\lambda = (n/ \Pi r^2))\)</span></p></li>
<li><p>Multiplied by the sum of the distances <span class="math inline">\(d_ij\)</span> between all points within that search radius, see <a href="https://www3.nd.edu/~mhaenggi/ee87021/Dixon-K-Function.pdf">Dixon page 2</a> and <a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0144404">Amgad et al. 2015</a></p></li>
<li><p>Divided by the total number of points, n</p></li>
<li><p>I = 1 or 0 depending if <span class="math inline">\(d_ij &lt; r\)</span></p></li>
</ul></li>
</ul>
<p>The plot for K has a number of elements that are worth explaining. First, the <em>Kpois(r)</em> line in Red is the theoretical value of K for each distance window (r) under a Poisson assumption of Complete Spatial Randomness. The Black line is the estimated values of K accounting for the effects of the edge of the study area.</p>
<p>Here, the correction specifies how points towards the edge are dealt with, in this case, border means that points towards the edge are ignored for the calculation but are included for the central points. <a href="https://www.statistics.gov.hk/wsc/IPS031-P2-S.pdf">Section 2.1, here</a> explains the different options.</p>
<p>Where the value of K falls above the line, the data appear to be clustered at that distance. Where the value of K is below the line, the data are dispersed. From the graph, we can see that up until distances of around 1300 metres, Blue Plaques appear to be clustered in Harrow, however, at around 1500 m, the distribution appears random and then dispersed between about 1600 and 2100 metres.</p>
</div>
<div id="alternatives-to-ripleys-k" class="section level3 hasAnchor" number="6.6.5">
<h3><span class="header-section-number">6.6.5</span> Alternatives to Ripley’s K<a href="detecting-spatial-patterns.html#alternatives-to-ripleys-k" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are a number of alternative measures of spatial clustering which can be computed in <code>spatstat</code> such as the G and the L functions — I won’t go into them now, but if you are interested, you should delve into the following references:</p>
<ul>
<li><p>Bivand, R. S., Pebesma, E. J., &amp; Gómez-Rubio, V. (2008). “Applied spatial data analysis with R.” New York: Springer.</p></li>
<li><p>Brundson, C., Comber, L. (2015) “An Introduction to R for Spatial Analysis &amp; Mapping”. Sage.</p></li>
<li><p>Baddeley, A. (2010) <a href="https://research.csiro.au/software/wp-content/uploads/sites/6/2015/02/Rspatialcourse_CMIS_PDF-Standard.pdf">“Analysing spatial point patterns in R”</a></p></li>
</ul>
</div>
</div>
<div id="density-based-spatial-clustering-of-applications-with-noise-dbscan" class="section level2 hasAnchor" number="6.7">
<h2><span class="header-section-number">6.7</span> Density-based spatial clustering of applications with noise: DBSCAN<a href="detecting-spatial-patterns.html#density-based-spatial-clustering-of-applications-with-noise-dbscan" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Quadrat and Ripley’s K analysis are useful exploratory techniques for telling us if we have spatial clusters present in our point data, but they are not able to tell us <strong>WHERE</strong> in our area of interest the clusters are occurring. To discover this we need to use alternative techniques. One popular technique for discovering clusters in space (be this physical space or variable space) is DBSCAN. For the complete overview of the DBSCAN algorithm, read the original paper by <a href="http://www.aaai.org/Papers/KDD/1996/KDD96-037.pdf">Ester et al. (1996)</a>
or consult the <a href="https://en.wikipedia.org/wiki/DBSCAN">wikipedia page</a></p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="detecting-spatial-patterns.html#cb287-1" tabindex="-1"></a><span class="fu">library</span>(fpc)</span></code></pre></div>
<p>We will now carry out a DBSCAN analysis of blue plaques in my borough to see if there are any clusters present.</p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="detecting-spatial-patterns.html#cb288-1" tabindex="-1"></a><span class="co">#first check the coordinate reference system of the Harrow spatial polygon:</span></span>
<span id="cb288-2"><a href="detecting-spatial-patterns.html#cb288-2" tabindex="-1"></a><span class="fu">st_geometry</span>(BoroughMap)</span></code></pre></div>
<pre><code>## Geometry set for 33 features 
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: 503568.2 ymin: 155850.8 xmax: 561957.5 ymax: 200933.9
## Projected CRS: OSGB36 / British National Grid
## First 5 geometries:</code></pre>
<p>DBSCAN requires you to input two parameters:
1. <em>Epsilon</em> - this is the radius within which the algorithm with search for clusters
2. <em>MinPts</em> - this is the minimum number of points that should be considered a cluster</p>
<p>Based on the results of the Ripley’s K analysis earlier, we can see that we are getting clustering up to a radius of around 1200m, with the largest bulge in the graph at around 700m. Therefore, 700m is probably a good place to start and we will begin by searching for clusters of at least 4 points…</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="detecting-spatial-patterns.html#cb290-1" tabindex="-1"></a><span class="co">#first extract the points from the spatial points data frame</span></span>
<span id="cb290-2"><a href="detecting-spatial-patterns.html#cb290-2" tabindex="-1"></a>BluePlaquesSubPoints <span class="ot">&lt;-</span> BluePlaquesSub <span class="sc">%&gt;%</span></span>
<span id="cb290-3"><a href="detecting-spatial-patterns.html#cb290-3" tabindex="-1"></a>  <span class="fu">coordinates</span>(.)<span class="sc">%&gt;%</span></span>
<span id="cb290-4"><a href="detecting-spatial-patterns.html#cb290-4" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb290-5"><a href="detecting-spatial-patterns.html#cb290-5" tabindex="-1"></a></span>
<span id="cb290-6"><a href="detecting-spatial-patterns.html#cb290-6" tabindex="-1"></a><span class="co">#now run the dbscan analysis</span></span>
<span id="cb290-7"><a href="detecting-spatial-patterns.html#cb290-7" tabindex="-1"></a>db <span class="ot">&lt;-</span> BluePlaquesSubPoints <span class="sc">%&gt;%</span></span>
<span id="cb290-8"><a href="detecting-spatial-patterns.html#cb290-8" tabindex="-1"></a>  fpc<span class="sc">::</span><span class="fu">dbscan</span>(.,<span class="at">eps =</span> <span class="dv">700</span>, <span class="at">MinPts =</span> <span class="dv">4</span>)</span>
<span id="cb290-9"><a href="detecting-spatial-patterns.html#cb290-9" tabindex="-1"></a></span>
<span id="cb290-10"><a href="detecting-spatial-patterns.html#cb290-10" tabindex="-1"></a><span class="co">#now plot the results</span></span>
<span id="cb290-11"><a href="detecting-spatial-patterns.html#cb290-11" tabindex="-1"></a><span class="fu">plot</span>(db, BluePlaquesSubPoints, <span class="at">main =</span> <span class="st">&quot;DBSCAN Output&quot;</span>, <span class="at">frame =</span> F)</span>
<span id="cb290-12"><a href="detecting-spatial-patterns.html#cb290-12" tabindex="-1"></a><span class="fu">plot</span>(BoroughMap<span class="sc">$</span>geometry, <span class="at">add=</span>T)</span></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-285-1.png" width="672" />
You could also use <code>kNNdistplot()</code> from the <code>dbscan</code> package to find a suitable eps value based on the ‘knee’ in the plot…</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="detecting-spatial-patterns.html#cb291-1" tabindex="-1"></a><span class="co"># used to find suitable eps value based on the knee in plot</span></span>
<span id="cb291-2"><a href="detecting-spatial-patterns.html#cb291-2" tabindex="-1"></a><span class="co"># k is no of nearest neighbours used, use min points</span></span>
<span id="cb291-3"><a href="detecting-spatial-patterns.html#cb291-3" tabindex="-1"></a><span class="fu">library</span>(dbscan)</span>
<span id="cb291-4"><a href="detecting-spatial-patterns.html#cb291-4" tabindex="-1"></a></span>
<span id="cb291-5"><a href="detecting-spatial-patterns.html#cb291-5" tabindex="-1"></a>BluePlaquesSubPoints<span class="sc">%&gt;%</span></span>
<span id="cb291-6"><a href="detecting-spatial-patterns.html#cb291-6" tabindex="-1"></a>  dbscan<span class="sc">::</span><span class="fu">kNNdistplot</span>(.,<span class="at">k=</span><span class="dv">4</span>)</span></code></pre></div>
<p>This plot shows for each point the average distance to the k neighbours, which are then plotted in ascending order. The knee is where this value (of distance to neighbours) increases. See <a href="https://www.datanovia.com/en/lessons/dbscan-density-based-clustering-essentials/">this article from Data Novia</a> for more information on this</p>
<p>So the DBSCAN analysis shows that for these values of eps and MinPts there are three clusters in the area I am analysing. Try varying eps and MinPts to see what difference it makes to the output.</p>
<p>Now of course the plot above is a little basic and doesn’t look very aesthetically pleasing. As this is R and R is brilliant, we can always produce a much nicer plot by extracting the useful information from the DBSCAN output and use <code>ggplot2</code> to produce a much cooler map…</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="detecting-spatial-patterns.html#cb292-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<p>Our new db object contains lots of info including the cluster each set of point coordinates belongs to, whether the point is a seed point or a border point etc. We can get a summary by just calling the object</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="detecting-spatial-patterns.html#cb293-1" tabindex="-1"></a>db</span></code></pre></div>
<pre><code>## dbscan Pts=40 MinPts=4 eps=700
##         0 1 2 3 4
## border 16 1 0 3 4
## seed    0 6 8 1 1
## total  16 7 8 4 5</code></pre>
<p>If you open up the object in the environment window in RStudio, you will also see the various slots in the object, including cluster</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="detecting-spatial-patterns.html#cb295-1" tabindex="-1"></a>db<span class="sc">$</span>cluster</span></code></pre></div>
<pre><code>##  [1] 0 3 0 1 4 0 1 0 4 1 0 2 1 1 2 0 0 0 0 2 1 3 0 0 0 0 4 3 4 2 0 0 4 3 0 2 2 2
## [39] 2 1</code></pre>
<p>We can now add this cluster membership info back into our dataframe</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="detecting-spatial-patterns.html#cb297-1" tabindex="-1"></a>BluePlaquesSubPoints<span class="ot">&lt;-</span> BluePlaquesSubPoints <span class="sc">%&gt;%</span></span>
<span id="cb297-2"><a href="detecting-spatial-patterns.html#cb297-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dbcluster=</span>db<span class="sc">$</span>cluster)</span></code></pre></div>
<p>Next we are going to create some convex hull polygons to wrap around the points in our clusters. This means we will create a smallest polygon that encloses the set of points of each cluster. We will</p>
<ul>
<li>convert this dataframe to an sf object</li>
<li>make convex hulls around the clusters</li>
<li>plot</li>
</ul>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="detecting-spatial-patterns.html#cb298-1" tabindex="-1"></a><span class="co"># convert the data frame to sf</span></span>
<span id="cb298-2"><a href="detecting-spatial-patterns.html#cb298-2" tabindex="-1"></a>BluePlaquesSubPoints_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(BluePlaquesSubPoints, </span>
<span id="cb298-3"><a href="detecting-spatial-patterns.html#cb298-3" tabindex="-1"></a>                                    <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;coords.x1&quot;</span>, <span class="st">&quot;coords.x2&quot;</span>), </span>
<span id="cb298-4"><a href="detecting-spatial-patterns.html#cb298-4" tabindex="-1"></a>                                    <span class="at">crs =</span> <span class="dv">27700</span>)</span>
<span id="cb298-5"><a href="detecting-spatial-patterns.html#cb298-5" tabindex="-1"></a></span>
<span id="cb298-6"><a href="detecting-spatial-patterns.html#cb298-6" tabindex="-1"></a><span class="co"># make the convex hulls around the cluster points</span></span>
<span id="cb298-7"><a href="detecting-spatial-patterns.html#cb298-7" tabindex="-1"></a>chull_polygons <span class="ot">&lt;-</span> BluePlaquesSubPoints_sf <span class="sc">%&gt;%</span></span>
<span id="cb298-8"><a href="detecting-spatial-patterns.html#cb298-8" tabindex="-1"></a>  <span class="co"># remove any points not in a cluster</span></span>
<span id="cb298-9"><a href="detecting-spatial-patterns.html#cb298-9" tabindex="-1"></a>  <span class="fu">filter</span>(dbcluster<span class="sc">&gt;</span><span class="dv">0</span>)<span class="sc">%&gt;%</span></span>
<span id="cb298-10"><a href="detecting-spatial-patterns.html#cb298-10" tabindex="-1"></a>  <span class="fu">group_by</span>(dbcluster) <span class="sc">%&gt;%</span></span>
<span id="cb298-11"><a href="detecting-spatial-patterns.html#cb298-11" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">geometry =</span> <span class="fu">st_combine</span>(geometry)) <span class="sc">%&gt;%</span>  <span class="co"># combine points</span></span>
<span id="cb298-12"><a href="detecting-spatial-patterns.html#cb298-12" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">geometry =</span> <span class="fu">st_convex_hull</span>(geometry)) <span class="sc">%&gt;%</span> <span class="co"># convex hull</span></span>
<span id="cb298-13"><a href="detecting-spatial-patterns.html#cb298-13" tabindex="-1"></a>  <span class="fu">st_as_sf</span>()</span></code></pre></div>
<p>Now create a <code>ggplot2</code> object from our data.</p>
<div class="infobox tip">
<p>In past iterations we used to get a base map we would:</p>
<ul>
<li>set a bounding box</li>
<li>Extract the coordinates of the bounding box</li>
<li>Pull an OSM base map from the OpenStreetMap package.</li>
</ul>
<p>However, now we can do this all from within the <code>annotation_map_tile()</code> function from the ggspatial package</p>
</div>
<p>Here:</p>
<ul>
<li><code>fill</code> is for the interior colour (e.g. polygons)</li>
<li><code>color</code> is for borders and points</li>
</ul>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="detecting-spatial-patterns.html#cb299-1" tabindex="-1"></a><span class="fu">library</span>(ggspatial)</span></code></pre></div>
<pre><code>## Warning: package &#39;ggspatial&#39; was built under R version 4.4.3</code></pre>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="detecting-spatial-patterns.html#cb301-1" tabindex="-1"></a><span class="co"># Create the map</span></span>
<span id="cb301-2"><a href="detecting-spatial-patterns.html#cb301-2" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb301-3"><a href="detecting-spatial-patterns.html#cb301-3" tabindex="-1"></a>  <span class="fu">annotation_map_tile</span>(<span class="at">zoom =</span> <span class="dv">13</span>) <span class="sc">+</span></span>
<span id="cb301-4"><a href="detecting-spatial-patterns.html#cb301-4" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> BluePlaquesSubPoints_sf, <span class="fu">aes</span>(<span class="at">color=</span>dbcluster), <span class="at">size =</span> <span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb301-5"><a href="detecting-spatial-patterns.html#cb301-5" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> chull_polygons, <span class="fu">aes</span>(<span class="at">fill =</span> dbcluster), </span>
<span id="cb301-6"><a href="detecting-spatial-patterns.html#cb301-6" tabindex="-1"></a>          <span class="at">alpha =</span> <span class="fl">0.8</span>, </span>
<span id="cb301-7"><a href="detecting-spatial-patterns.html#cb301-7" tabindex="-1"></a>          <span class="co"># remove polygon borders</span></span>
<span id="cb301-8"><a href="detecting-spatial-patterns.html#cb301-8" tabindex="-1"></a>          <span class="at">color =</span> <span class="cn">NA</span>, </span>
<span id="cb301-9"><a href="detecting-spatial-patterns.html#cb301-9" tabindex="-1"></a>          <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb301-10"><a href="detecting-spatial-patterns.html#cb301-10" tabindex="-1"></a></span>
<span id="cb301-11"><a href="detecting-spatial-patterns.html#cb301-11" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<pre><code>## Zoom: 13</code></pre>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-292-1.png" width="672" /></p>
</div>
<div id="point-pattern-analysis-summary" class="section level2 hasAnchor" number="6.8">
<h2><span class="header-section-number">6.8</span> Point pattern analysis summary<a href="detecting-spatial-patterns.html#point-pattern-analysis-summary" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This is end of the point pattern analysis section of the practical. You have been introduced to the basics of Point Pattern Analysis examining the distribution of Blue Plaques in a London Borough. At this point, you may wish to try running similar analyses on different boroughs (or indeed the whole city) and playing with some of the outputs — although you will find that Ripley’s K will fall over very quickly if you try to run the analysis on that many points)</p>
<p>This how you might make use of these techniques in another context or with different point data…</p>
</div>
<div id="feedback-5" class="section level2 hasAnchor" number="6.9">
<h2><span class="header-section-number">6.9</span> Feedback<a href="detecting-spatial-patterns.html#feedback-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Was anything that we explained unclear this week or was something really clear…let us know using the <a href="https://forms.gle/w2GUDYc7tSavGy7r6">feedback form</a>. It’s anonymous and we’ll use the responses to clear any issues up in the future / adapt the material.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="map-making.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="spatial-autocorrelation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": true,
    "facebook": false,
    "twitter": false,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": false
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/andrewmaclachlan/CASA0005repo/edit/master/06-prac6.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["https://github.com/andrewmaclachlan/CASA0005repo/raw/master/06-prac6.Rmd"],
  "search": {
    "engine": "fuse",
    "options": {
      "includeScore": true
    }
  },
  "toc": {
    "collapse": "section",
    "scroll_highlight": true
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
