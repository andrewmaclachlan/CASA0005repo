<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Spatial autocorrelation | CASA0005 Geographic Information Systems and Science</title>
  <meta name="description" content="The CASA0005 Geographic Information Systems and Science practical book" />
  <meta name="generator" content="bookdown 0.30 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Spatial autocorrelation | CASA0005 Geographic Information Systems and Science" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://andrewmaclachlan.github.io/CASA0005repo//general_images/casa_logo.png" />
  <meta property="og:description" content="The CASA0005 Geographic Information Systems and Science practical book" />
  <meta name="github-repo" content="andrewmaclachlan/CASA0005repo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Spatial autocorrelation | CASA0005 Geographic Information Systems and Science" />
  
  <meta name="twitter:description" content="The CASA0005 Geographic Information Systems and Science practical book" />
  <meta name="twitter:image" content="https://andrewmaclachlan.github.io/CASA0005repo//general_images/casa_logo.png" />

<meta name="author" content="Andy MacLachlan and Adam Dennett" />


<meta name="date" content="2022-12-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="assets/apple-touch-icon.png" />
  <link rel="shortcut icon" href="assets/favicon.ico" type="image/x-icon" />
<link rel="prev" href="detecting-spatial-patterns.html"/>
<link rel="next" href="explaining-spatial-patterns.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.23/datatables.js"></script>
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script>
<link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet" />
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet" />
<script src="libs/selectize-0.12.0/selectize.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<script src="libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.1/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.1.1/leaflet-providers-plugin.js"></script>
<script src="libs/clipboard-0.0.1/setClipboardText.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-151934476-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-151934476-1');
</script>
<script src="assets/book.js"></script>

<script>
/* ========================================================================
 * Bootstrap: transition.js v3.3.7
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // CSS TRANSITION SUPPORT (Shoutout: http://www.modernizr.com/)
  // ============================================================

  function transitionEnd() {
    var el = document.createElement('bootstrap')

    var transEndEventNames = {
      WebkitTransition : 'webkitTransitionEnd',
      MozTransition    : 'transitionend',
      OTransition      : 'oTransitionEnd otransitionend',
      transition       : 'transitionend'
    }

    for (var name in transEndEventNames) {
      if (el.style[name] !== undefined) {
        return { end: transEndEventNames[name] }
      }
    }

    return false // explicit for ie8 (  ._.)
  }

  // http://blog.alexmaccaw.com/css-transitions
  $.fn.emulateTransitionEnd = function (duration) {
    var called = false
    var $el = this
    $(this).one('bsTransitionEnd', function () { called = true })
    var callback = function () { if (!called) $($el).trigger($.support.transition.end) }
    setTimeout(callback, duration)
    return this
  }

  $(function () {
    $.support.transition = transitionEnd()

    if (!$.support.transition) return

    $.event.special.bsTransitionEnd = {
      bindType: $.support.transition.end,
      delegateType: $.support.transition.end,
      handle: function (e) {
        if ($(e.target).is(this)) return e.handleObj.handler.apply(this, arguments)
      }
    }
  })

}(jQuery);
</script>
<script>
/* ========================================================================
 * Bootstrap: collapse.js v3.3.7
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* jshint latedef: false */

+function ($) {
  'use strict';

  // COLLAPSE PUBLIC CLASS DEFINITION
  // ================================

  var Collapse = function (element, options) {
    this.$element      = $(element)
    this.options       = $.extend({}, Collapse.DEFAULTS, options)
    this.$trigger      = $('[data-toggle="collapse"][href="#' + element.id + '"],' +
                           '[data-toggle="collapse"][data-target="#' + element.id + '"]')
    this.transitioning = null

    if (this.options.parent) {
      this.$parent = this.getParent()
    } else {
      this.addAriaAndCollapsedClass(this.$element, this.$trigger)
    }

    if (this.options.toggle) this.toggle()
  }

  Collapse.VERSION  = '3.3.7'

  Collapse.TRANSITION_DURATION = 350

  Collapse.DEFAULTS = {
    toggle: true
  }

  Collapse.prototype.dimension = function () {
    var hasWidth = this.$element.hasClass('width')
    return hasWidth ? 'width' : 'height'
  }

  Collapse.prototype.show = function () {
    if (this.transitioning || this.$element.hasClass('in')) return

    var activesData
    var actives = this.$parent && this.$parent.children('.panel').children('.in, .collapsing')

    if (actives && actives.length) {
      activesData = actives.data('bs.collapse')
      if (activesData && activesData.transitioning) return
    }

    var startEvent = $.Event('show.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    if (actives && actives.length) {
      Plugin.call(actives, 'hide')
      activesData || actives.data('bs.collapse', null)
    }

    var dimension = this.dimension()

    this.$element
      .removeClass('collapse')
      .addClass('collapsing')[dimension](0)
      .attr('aria-expanded', true)

    this.$trigger
      .removeClass('collapsed')
      .attr('aria-expanded', true)

    this.transitioning = 1

    var complete = function () {
      this.$element
        .removeClass('collapsing')
        .addClass('collapse in')[dimension]('')
      this.transitioning = 0
      this.$element
        .trigger('shown.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    var scrollSize = $.camelCase(['scroll', dimension].join('-'))

    this.$element
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])
  }

  Collapse.prototype.hide = function () {
    if (this.transitioning || !this.$element.hasClass('in')) return

    var startEvent = $.Event('hide.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    var dimension = this.dimension()

    this.$element[dimension](this.$element[dimension]())[0].offsetHeight

    this.$element
      .addClass('collapsing')
      .removeClass('collapse in')
      .attr('aria-expanded', false)

    this.$trigger
      .addClass('collapsed')
      .attr('aria-expanded', false)

    this.transitioning = 1

    var complete = function () {
      this.transitioning = 0
      this.$element
        .removeClass('collapsing')
        .addClass('collapse')
        .trigger('hidden.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    this.$element
      [dimension](0)
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)
  }

  Collapse.prototype.toggle = function () {
    this[this.$element.hasClass('in') ? 'hide' : 'show']()
  }

  Collapse.prototype.getParent = function () {
    return $(this.options.parent)
      .find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]')
      .each($.proxy(function (i, element) {
        var $element = $(element)
        this.addAriaAndCollapsedClass(getTargetFromTrigger($element), $element)
      }, this))
      .end()
  }

  Collapse.prototype.addAriaAndCollapsedClass = function ($element, $trigger) {
    var isOpen = $element.hasClass('in')

    $element.attr('aria-expanded', isOpen)
    $trigger
      .toggleClass('collapsed', !isOpen)
      .attr('aria-expanded', isOpen)
  }

  function getTargetFromTrigger($trigger) {
    var href
    var target = $trigger.attr('data-target')
      || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '') // strip for ie7

    return $(target)
  }


  // COLLAPSE PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.collapse')
      var options = $.extend({}, Collapse.DEFAULTS, $this.data(), typeof option == 'object' && option)

      if (!data && options.toggle && /show|hide/.test(option)) options.toggle = false
      if (!data) $this.data('bs.collapse', (data = new Collapse(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.collapse

  $.fn.collapse             = Plugin
  $.fn.collapse.Constructor = Collapse


  // COLLAPSE NO CONFLICT
  // ====================

  $.fn.collapse.noConflict = function () {
    $.fn.collapse = old
    return this
  }


  // COLLAPSE DATA-API
  // =================

  $(document).on('click.bs.collapse.data-api', '[data-toggle="collapse"]', function (e) {
    var $this   = $(this)

    if (!$this.attr('data-target')) e.preventDefault()

    var $target = getTargetFromTrigger($this)
    var data    = $target.data('bs.collapse')
    var option  = data ? 'toggle' : $this.data()

    Plugin.call($target, option)
  })

}(jQuery);
</script>
<script>
window.initializeCodeFolding = function(show) {

  // handlers for show-all and hide all
  $("#rmd-show-all-code").click(function() {
    // close the dropdown menu when an option is clicked
    $("#allCodeButton").dropdown("toggle");
    $('div.r-code-collapse').each(function() {
      $(this).collapse('show');
    });
  });
  $("#rmd-hide-all-code").click(function() {
    // close the dropdown menu when an option is clicked
    $("#allCodeButton").dropdown("toggle");
    $('div.r-code-collapse').each(function() {
      $(this).collapse('hide');
    });
  });

  // index for unique code element ids
  var currentIndex = 1;

  // select all R code blocks
  var rCodeBlocks = $('pre.sourceCode, pre.r, pre.python, pre.bash, pre.sql, pre.cpp, pre.stan');
  rCodeBlocks.each(function() {

    // if code block has been labeled with class `fold-show`, show the code on init!
    var classList = $(this).attr('class').split(/\s+/);
    for (var i = 0; i < classList.length; i++) {
    if (classList[i] === 'fold-show') {
        show = true;
      }
    }

    // create a collapsable div to wrap the code in
    var div = $('<div class="collapse r-code-collapse"></div>');
    if (show)
      div.addClass('in');
    var id = 'rcode-643E0F36' + currentIndex++;
    div.attr('id', id);
    $(this).before(div);
    $(this).detach().appendTo(div);

    // add a show code button right above
    var showCodeText = $('<span>' + (show ? 'Hide' : 'Code') + '</span>');
    var showCodeButton = $('<button type="button" class="btn btn-default btn-xs code-folding-btn pull-right"></button>');
    showCodeButton.append(showCodeText);
    showCodeButton
        .attr('data-toggle', 'collapse')
        .attr('data-target', '#' + id)
        .attr('aria-expanded', show)
        .attr('aria-controls', id);

    var buttonRow = $('<div class="row"></div>');
    var buttonCol = $('<div class="col-md-12"></div>');

    buttonCol.append(showCodeButton);
    buttonRow.append(buttonCol);

    div.before(buttonRow);

    // hack: return show to false, otherwise all next codeBlocks will be shown!
    show = false;

    // update state of button on show/hide
    div.on('hidden.bs.collapse', function () {
      showCodeText.text('Code');
    });
    div.on('show.bs.collapse', function () {
      showCodeText.text('Hide');
    });
  });

}
</script>
<script>
/* ========================================================================
 * Bootstrap: dropdown.js v3.3.7
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // DROPDOWN CLASS DEFINITION
  // =========================

  var backdrop = '.dropdown-backdrop'
  var toggle   = '[data-toggle="dropdown"]'
  var Dropdown = function (element) {
    $(element).on('click.bs.dropdown', this.toggle)
  }

  Dropdown.VERSION = '3.3.7'

  function getParent($this) {
    var selector = $this.attr('data-target')

    if (!selector) {
      selector = $this.attr('href')
      selector = selector && /#[A-Za-z]/.test(selector) && selector.replace(/.*(?=#[^\s]*$)/, '') // strip for ie7
    }

    var $parent = selector && $(selector)

    return $parent && $parent.length ? $parent : $this.parent()
  }

  function clearMenus(e) {
    if (e && e.which === 3) return
    $(backdrop).remove()
    $(toggle).each(function () {
      var $this         = $(this)
      var $parent       = getParent($this)
      var relatedTarget = { relatedTarget: this }

      if (!$parent.hasClass('open')) return

      if (e && e.type == 'click' && /input|textarea/i.test(e.target.tagName) && $.contains($parent[0], e.target)) return

      $parent.trigger(e = $.Event('hide.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this.attr('aria-expanded', 'false')
      $parent.removeClass('open').trigger($.Event('hidden.bs.dropdown', relatedTarget))
    })
  }

  Dropdown.prototype.toggle = function (e) {
    var $this = $(this)

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    clearMenus()

    if (!isActive) {
      if ('ontouchstart' in document.documentElement && !$parent.closest('.navbar-nav').length) {
        // if mobile we use a backdrop because click events don't delegate
        $(document.createElement('div'))
          .addClass('dropdown-backdrop')
          .insertAfter($(this))
          .on('click', clearMenus)
      }

      var relatedTarget = { relatedTarget: this }
      $parent.trigger(e = $.Event('show.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this
        .trigger('focus')
        .attr('aria-expanded', 'true')

      $parent
        .toggleClass('open')
        .trigger($.Event('shown.bs.dropdown', relatedTarget))
    }

    return false
  }

  Dropdown.prototype.keydown = function (e) {
    if (!/(38|40|27|32)/.test(e.which) || /input|textarea/i.test(e.target.tagName)) return

    var $this = $(this)

    e.preventDefault()
    e.stopPropagation()

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    if (!isActive && e.which != 27 || isActive && e.which == 27) {
      if (e.which == 27) $parent.find(toggle).trigger('focus')
      return $this.trigger('click')
    }

    var desc = ' li:not(.disabled):visible a'
    var $items = $parent.find('.dropdown-menu' + desc)

    if (!$items.length) return

    var index = $items.index(e.target)

    if (e.which == 38 && index > 0)                 index--         // up
    if (e.which == 40 && index < $items.length - 1) index++         // down
    if (!~index)                                    index = 0

    $items.eq(index).trigger('focus')
  }


  // DROPDOWN PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this = $(this)
      var data  = $this.data('bs.dropdown')

      if (!data) $this.data('bs.dropdown', (data = new Dropdown(this)))
      if (typeof option == 'string') data[option].call($this)
    })
  }

  var old = $.fn.dropdown

  $.fn.dropdown             = Plugin
  $.fn.dropdown.Constructor = Dropdown


  // DROPDOWN NO CONFLICT
  // ====================

  $.fn.dropdown.noConflict = function () {
    $.fn.dropdown = old
    return this
  }


  // APPLY TO STANDARD DROPDOWN ELEMENTS
  // ===================================

  $(document)
    .on('click.bs.dropdown.data-api', clearMenus)
    .on('click.bs.dropdown.data-api', '.dropdown form', function (e) { e.stopPropagation() })
    .on('click.bs.dropdown.data-api', toggle, Dropdown.prototype.toggle)
    .on('keydown.bs.dropdown.data-api', toggle, Dropdown.prototype.keydown)
    .on('keydown.bs.dropdown.data-api', '.dropdown-menu', Dropdown.prototype.keydown)

}(jQuery);
</script>
<style type="text/css">
.code-folding-btn {
  margin-bottom: 4px;
}

.row { display: flex; }
.collapse { display: none; }
.in { display:block }
.pull-right > .dropdown-menu {
    right: 0;
    left: auto;
}

.dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0;
    z-index: 1000;
    display: none;
    float: left;
    min-width: 160px;
    padding: 5px 0;
    margin: 2px 0 0;
    font-size: 14px;
    text-align: left;
    list-style: none;
    background-color: #fff;
    -webkit-background-clip: padding-box;
    background-clip: padding-box;
    border: 1px solid #ccc;
    border: 1px solid rgba(0,0,0,.15);
    border-radius: 4px;
    -webkit-box-shadow: 0 6px 12px rgba(0,0,0,.175);
    box-shadow: 0 6px 12px rgba(0,0,0,.175);
}

.open > .dropdown-menu {
    display: block;
    color: #ffffff;
    background-color: #ffffff;
    background-image: none;
    border-color: #92897e;
}

.dropdown-menu > li > a {
  display: block;
  padding: 3px 20px;
  clear: both;
  font-weight: 400;
  line-height: 1.42857143;
  color: #000000;
  white-space: nowrap;
}

.dropdown-menu > li > a:hover,
.dropdown-menu > li > a:focus {
  color: #ffffff;
  text-decoration: none;
  background-color: #e95420;
}

.dropdown-menu > .active > a,
.dropdown-menu > .active > a:hover,
.dropdown-menu > .active > a:focus {
  color: #ffffff;
  text-decoration: none;
  background-color: #e95420;
  outline: 0;
}
.dropdown-menu > .disabled > a,
.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  color: #aea79f;
}

.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  text-decoration: none;
  cursor: not-allowed;
  background-color: transparent;
  background-image: none;
  filter: progid:DXImageTransform.Microsoft.gradient(enabled = false);
}

.btn {
  display: inline-block;
  margin-bottom: 1;
  font-weight: normal;
  text-align: center;
  white-space: nowrap;
  vertical-align: middle;
  -ms-touch-action: manipulation;
      touch-action: manipulation;
  cursor: pointer;
  background-image: none;
  border: 1px solid transparent;
  padding: 4px 8px;
  font-size: 14px;
  line-height: 1.42857143;
  border-radius: 4px;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.btn:focus,
.btn:active:focus,
.btn.active:focus,
.btn.focus,
.btn:active.focus,
.btn.active.focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
.btn:hover,
.btn:focus,
.btn.focus {
  color: #ffffff;
  text-decoration: none;
}
.btn:active,
.btn.active {
  background-image: none;
  outline: 0;
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn.disabled,
.btn[disabled],
fieldset[disabled] .btn {
  cursor: not-allowed;
  filter: alpha(opacity=65);
  opacity: 0.65;
  box-shadow: none;
}
a.btn.disabled,
fieldset[disabled] a.btn {
  pointer-events: none;
}
.btn-default {
  color: #ffffff;
  background-color: #aea79f; #important
  border-color: #aea79f;
}

.btn-default:focus,
.btn-default.focus {
  color: #ffffff;
  background-color: #978e83;
  border-color: #6f675e;
}

.btn-default:hover {
  color: #ffffff;
  background-color: #978e83;
  border-color: #92897e;
}
.btn-default:active,
.btn-default.active,
.btn-group > .btn:not(:first-child):not(:last-child):not(.dropdown-toggle) {
  border-radius: 0;
}
.btn-group > .btn:first-child {
  margin-left: 0;
}
.btn-group > .btn:first-child:not(:last-child):not(.dropdown-toggle) {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}
.btn-group > .btn:last-child:not(:first-child),
.btn-group > .dropdown-toggle:not(:first-child) {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group > .btn-group {
  float: left;
}
.btn-group > .btn-group:not(:first-child):not(:last-child) > .btn {
  border-radius: 0;
}
.btn-group > .btn-group:first-child:not(:last-child) > .btn:last-child,
.btn-group > .btn-group:first-child:not(:last-child) > .dropdown-toggle {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}
.btn-group > .btn-group:last-child:not(:first-child) > .btn:first-child {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group .dropdown-toggle:active,
.btn-group.open .dropdown-toggle {
  outline: 0;
}
.btn-group > .btn + .dropdown-toggle {
  padding-right: 8px;
  padding-left: 8px;
}
.btn-group > .btn-lg + .dropdown-toggle {
  padding-right: 12px;
  padding-left: 12px;
}
.btn-group.open .dropdown-toggle {
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn-group.open .dropdown-toggle.btn-link {
  box-shadow: none;
}

</style>
<script>
var str = '<div class="btn-group pull-right" style="position: fixed; right: 50px; top: 10px; z-index: 200"><button type="button" class="btn btn-default btn-xs dropdown-toggle" id="allCodeButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" data-_extension-text-contrast=""><span>Code</span> <span class="caret"></span></button><ul class="dropdown-menu" style="min-width: 50px;"><li><a id="rmd-show-all-code" href="#">Show All Code</a></li><li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li></ul></div>';
document.write(str);
</script>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "hide");
});
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="assets/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="https://www.ucl.ac.uk/module-catalogue/modules/geographic-information-systems-and-science-CASA0005"><img src="general_images/casa_logo.jpg"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgement"><i class="fa fa-check"></i>Acknowledgement</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#citation"><i class="fa fa-check"></i>Citation</a></li>
</ul></li>
<li class="part"><span><b>Course information</b></span></li>
<li class="chapter" data-level="" data-path="hello-gis.html"><a href="hello-gis.html"><i class="fa fa-check"></i>Hello GIS</a>
<ul>
<li class="chapter" data-level="" data-path="hello-gis.html"><a href="hello-gis.html#intended-course-learning-outcomes"><i class="fa fa-check"></i>Intended course learning outcomes</a></li>
<li class="chapter" data-level="" data-path="hello-gis.html"><a href="hello-gis.html#how-to-use-this-book"><i class="fa fa-check"></i>How to use this book</a></li>
<li class="chapter" data-level="" data-path="hello-gis.html"><a href="hello-gis.html#getting-started"><i class="fa fa-check"></i>Getting started</a></li>
<li class="chapter" data-level="" data-path="hello-gis.html"><a href="hello-gis.html#how-to-download-data-and-files-from-github"><i class="fa fa-check"></i>How to download data and files from GitHub</a>
<ul>
<li class="chapter" data-level="" data-path="hello-gis.html"><a href="hello-gis.html#option-1"><i class="fa fa-check"></i>Option 1</a></li>
<li class="chapter" data-level="" data-path="hello-gis.html"><a href="hello-gis.html#option-2"><i class="fa fa-check"></i>Option 2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hello-gis.html"><a href="hello-gis.html#self-guided-learning"><i class="fa fa-check"></i>Self guided learning</a></li>
<li class="chapter" data-level="" data-path="hello-gis.html"><a href="hello-gis.html#interactive-lectures"><i class="fa fa-check"></i>Interactive lectures</a></li>
<li class="chapter" data-level="" data-path="hello-gis.html"><a href="hello-gis.html#more-help"><i class="fa fa-check"></i>More help</a></li>
<li class="chapter" data-level="" data-path="hello-gis.html"><a href="hello-gis.html#reading-list"><i class="fa fa-check"></i>Reading list</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="software-installation.html"><a href="software-installation.html"><i class="fa fa-check"></i>Software installation</a>
<ul>
<li class="chapter" data-level="" data-path="software-installation.html"><a href="software-installation.html#qgis"><i class="fa fa-check"></i>QGIS</a></li>
<li class="chapter" data-level="" data-path="software-installation.html"><a href="software-installation.html#r"><i class="fa fa-check"></i>R</a>
<ul>
<li class="chapter" data-level="" data-path="software-installation.html"><a href="software-installation.html#r-java"><i class="fa fa-check"></i>R Java</a></li>
<li class="chapter" data-level="" data-path="software-installation.html"><a href="software-installation.html#basics"><i class="fa fa-check"></i>Basics</a></li>
<li class="chapter" data-level="" data-path="software-installation.html"><a href="software-installation.html#packages"><i class="fa fa-check"></i>Packages</a></li>
<li class="chapter" data-level="" data-path="software-installation.html"><a href="software-installation.html#macs"><i class="fa fa-check"></i>Macs</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="software-installation.html"><a href="software-installation.html#arcgis"><i class="fa fa-check"></i>ArcGIS</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="external-usage.html"><a href="external-usage.html"><i class="fa fa-check"></i>External usage</a>
<ul>
<li class="chapter" data-level="" data-path="external-usage.html"><a href="external-usage.html#how-to-adopt-this-course"><i class="fa fa-check"></i>How to adopt this course</a></li>
<li class="chapter" data-level="" data-path="external-usage.html"><a href="external-usage.html#how-to-contribute"><i class="fa fa-check"></i>How to contribute</a></li>
<li class="chapter" data-level="" data-path="external-usage.html"><a href="external-usage.html#supporting-the-module"><i class="fa fa-check"></i>Supporting the module</a></li>
<li class="chapter" data-level="" data-path="external-usage.html"><a href="external-usage.html#license"><i class="fa fa-check"></i>License</a></li>
<li class="chapter" data-level="" data-path="external-usage.html"><a href="external-usage.html#updates"><i class="fa fa-check"></i>Updates</a></li>
<li class="chapter" data-level="" data-path="external-usage.html"><a href="external-usage.html#packages-1"><i class="fa fa-check"></i>Packages</a></li>
</ul></li>
<li class="part"><span><b>I GIS tools</b></span></li>
<li class="chapter" data-level="1" data-path="geographic-information.html"><a href="geographic-information.html"><i class="fa fa-check"></i><b>1</b> Geographic Information</a>
<ul>
<li class="chapter" data-level="1.1" data-path="geographic-information.html"><a href="geographic-information.html#learning-outcomes"><i class="fa fa-check"></i><b>1.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="1.2" data-path="geographic-information.html"><a href="geographic-information.html#homework"><i class="fa fa-check"></i><b>1.2</b> Homework</a></li>
<li class="chapter" data-level="1.3" data-path="geographic-information.html"><a href="geographic-information.html#recommended-listening"><i class="fa fa-check"></i><b>1.3</b> Recommended listening ðŸŽ§</a></li>
<li class="chapter" data-level="1.4" data-path="geographic-information.html"><a href="geographic-information.html#the-basics-of-geographic-information"><i class="fa fa-check"></i><b>1.4</b> The Basics of Geographic Information</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="geographic-information.html"><a href="geographic-information.html#data-types-in-statistics"><i class="fa fa-check"></i><b>1.4.1</b> Data types in statistics</a></li>
<li class="chapter" data-level="1.4.2" data-path="geographic-information.html"><a href="geographic-information.html#important-gis-data-formats"><i class="fa fa-check"></i><b>1.4.2</b> Important GIS data formats</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="geographic-information.html"><a href="geographic-information.html#general-data-flow"><i class="fa fa-check"></i><b>1.5</b> General data flow</a></li>
<li class="chapter" data-level="1.6" data-path="geographic-information.html"><a href="geographic-information.html#data"><i class="fa fa-check"></i><b>1.6</b> Data</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="geographic-information.html"><a href="geographic-information.html#file-paths"><i class="fa fa-check"></i><b>1.6.1</b> File paths</a></li>
<li class="chapter" data-level="1.6.2" data-path="geographic-information.html"><a href="geographic-information.html#data-download"><i class="fa fa-check"></i><b>1.6.2</b> Data download</a></li>
<li class="chapter" data-level="1.6.3" data-path="geographic-information.html"><a href="geographic-information.html#data-pre-processing"><i class="fa fa-check"></i><b>1.6.3</b> Data pre-processing</a></li>
<li class="chapter" data-level="1.6.4" data-path="geographic-information.html"><a href="geographic-information.html#qgis-1"><i class="fa fa-check"></i><b>1.6.4</b> QGIS</a></li>
<li class="chapter" data-level="1.6.5" data-path="geographic-information.html"><a href="geographic-information.html#r-1"><i class="fa fa-check"></i><b>1.6.5</b> R</a></li>
<li class="chapter" data-level="1.6.6" data-path="geographic-information.html"><a href="geographic-information.html#export-data-1"><i class="fa fa-check"></i><b>1.6.6</b> Export data</a></li>
<li class="chapter" data-level="1.6.7" data-path="geographic-information.html"><a href="geographic-information.html#what-will-i-use-1"><i class="fa fa-check"></i><b>1.6.7</b> What will I use</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="geographic-information.html"><a href="geographic-information.html#data-sources-and-task"><i class="fa fa-check"></i><b>1.7</b> Data sources and task</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="geographic-information.html"><a href="geographic-information.html#uk-data-service"><i class="fa fa-check"></i><b>1.7.1</b> UK Data Service</a></li>
<li class="chapter" data-level="1.7.2" data-path="geographic-information.html"><a href="geographic-information.html#ons"><i class="fa fa-check"></i><b>1.7.2</b> ONS</a></li>
<li class="chapter" data-level="1.7.3" data-path="geographic-information.html"><a href="geographic-information.html#nomis"><i class="fa fa-check"></i><b>1.7.3</b> nomis</a></li>
<li class="chapter" data-level="1.7.4" data-path="geographic-information.html"><a href="geographic-information.html#os"><i class="fa fa-check"></i><b>1.7.4</b> OS</a></li>
<li class="chapter" data-level="1.7.5" data-path="geographic-information.html"><a href="geographic-information.html#edina-digimap"><i class="fa fa-check"></i><b>1.7.5</b> Edina Digimap</a></li>
<li class="chapter" data-level="1.7.6" data-path="geographic-information.html"><a href="geographic-information.html#osm"><i class="fa fa-check"></i><b>1.7.6</b> OSM</a></li>
<li class="chapter" data-level="1.7.7" data-path="geographic-information.html"><a href="geographic-information.html#defra"><i class="fa fa-check"></i><b>1.7.7</b> DEFRA</a></li>
<li class="chapter" data-level="1.7.8" data-path="geographic-information.html"><a href="geographic-information.html#data-lists"><i class="fa fa-check"></i><b>1.7.8</b> Data lists</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="geographic-information.html"><a href="geographic-information.html#summary"><i class="fa fa-check"></i><b>1.8</b> Summary</a></li>
<li class="chapter" data-level="1.9" data-path="geographic-information.html"><a href="geographic-information.html#feedback"><i class="fa fa-check"></i><b>1.9</b> Feedback</a></li>
<li class="chapter" data-level="1.10" data-path="geographic-information.html"><a href="geographic-information.html#mac-r-issues"><i class="fa fa-check"></i><b>1.10</b> Mac R issues</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><b>2</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#learning-outcomes-1"><i class="fa fa-check"></i><b>2.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#homework-1"><i class="fa fa-check"></i><b>2.2</b> Homework</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#recommended-listening-1"><i class="fa fa-check"></i><b>2.3</b> Recommended listening ðŸŽ§</a></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#introduction-1"><i class="fa fa-check"></i><b>2.4</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#online-forums-are-your-friend"><i class="fa fa-check"></i><b>2.4.1</b> Online forums are your friend!!</a></li>
<li class="chapter" data-level="2.4.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#health-warning"><i class="fa fa-check"></i><b>2.4.2</b> Health warning</a></li>
<li class="chapter" data-level="2.4.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#r-and-rstudio"><i class="fa fa-check"></i><b>2.4.3</b> R and RStudio</a></li>
<li class="chapter" data-level="2.4.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#getting-started-1"><i class="fa fa-check"></i><b>2.4.4</b> Getting started</a></li>
<li class="chapter" data-level="2.4.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#basics-1"><i class="fa fa-check"></i><b>2.4.5</b> Basics</a></li>
<li class="chapter" data-level="2.4.6" data-path="introduction-to-r.html"><a href="introduction-to-r.html#scripts-and-some-basic-commands"><i class="fa fa-check"></i><b>2.4.6</b> Scripts and some basic commands</a></li>
<li class="chapter" data-level="2.4.7" data-path="introduction-to-r.html"><a href="introduction-to-r.html#functions"><i class="fa fa-check"></i><b>2.4.7</b> Functions</a></li>
<li class="chapter" data-level="2.4.8" data-path="introduction-to-r.html"><a href="introduction-to-r.html#basic-plotting"><i class="fa fa-check"></i><b>2.4.8</b> Basic plotting</a></li>
<li class="chapter" data-level="2.4.9" data-path="introduction-to-r.html"><a href="introduction-to-r.html#help"><i class="fa fa-check"></i><b>2.4.9</b> Help</a></li>
<li class="chapter" data-level="2.4.10" data-path="introduction-to-r.html"><a href="introduction-to-r.html#data-structures"><i class="fa fa-check"></i><b>2.4.10</b> Data structures</a></li>
<li class="chapter" data-level="2.4.11" data-path="introduction-to-r.html"><a href="introduction-to-r.html#elements-of-a-data-frame"><i class="fa fa-check"></i><b>2.4.11</b> Elements of a data frame</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#reading-data-into-r"><i class="fa fa-check"></i><b>2.5</b> Reading data into R</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#old-skool-cleaning"><i class="fa fa-check"></i><b>2.5.1</b> Old skool cleaning</a></li>
<li class="chapter" data-level="2.5.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#here"><i class="fa fa-check"></i><b>2.5.2</b> Here</a></li>
<li class="chapter" data-level="2.5.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#new-skool-cleaning"><i class="fa fa-check"></i><b>2.5.3</b> New skool cleaning</a></li>
<li class="chapter" data-level="2.5.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#examining-your-new-data"><i class="fa fa-check"></i><b>2.5.4</b> Examining your new data</a></li>
<li class="chapter" data-level="2.5.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#data-manipulation-in-r"><i class="fa fa-check"></i><b>2.5.5</b> Data manipulation in R</a></li>
<li class="chapter" data-level="2.5.6" data-path="introduction-to-r.html"><a href="introduction-to-r.html#plotting"><i class="fa fa-check"></i><b>2.5.6</b> Plotting</a></li>
<li class="chapter" data-level="2.5.7" data-path="introduction-to-r.html"><a href="introduction-to-r.html#pimp-my-graph"><i class="fa fa-check"></i><b>2.5.7</b> Pimp my graph!</a></li>
<li class="chapter" data-level="2.5.8" data-path="introduction-to-r.html"><a href="introduction-to-r.html#spatial-data-in-r"><i class="fa fa-check"></i><b>2.5.8</b> Spatial Data in R</a></li>
<li class="chapter" data-level="2.5.9" data-path="introduction-to-r.html"><a href="introduction-to-r.html#simple-mapping"><i class="fa fa-check"></i><b>2.5.9</b> Simple mapping</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="introduction-to-r.html"><a href="introduction-to-r.html#tidying-data"><i class="fa fa-check"></i><b>2.6</b> Tidying data</a></li>
<li class="chapter" data-level="2.7" data-path="introduction-to-r.html"><a href="introduction-to-r.html#feedback-1"><i class="fa fa-check"></i><b>2.7</b> Feedback</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html"><i class="fa fa-check"></i><b>3</b> Spatial descriptive statistics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html#learning-outcomes-2"><i class="fa fa-check"></i><b>3.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="3.2" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html#homework-2"><i class="fa fa-check"></i><b>3.2</b> Homework</a></li>
<li class="chapter" data-level="3.3" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html#recommended-listening-2"><i class="fa fa-check"></i><b>3.3</b> Recommended listening ðŸŽ§</a></li>
<li class="chapter" data-level="3.4" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html#introduction-2"><i class="fa fa-check"></i><b>3.4</b> Introduction</a></li>
<li class="chapter" data-level="3.5" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html#part-1-projections"><i class="fa fa-check"></i><b>3.5</b> Part 1 projections</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html#changing-projections"><i class="fa fa-check"></i><b>3.5.1</b> Changing projections</a></li>
<li class="chapter" data-level="3.5.2" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html#worldclim-data"><i class="fa fa-check"></i><b>3.5.2</b> WorldClim data</a></li>
<li class="chapter" data-level="3.5.3" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html#data-loading"><i class="fa fa-check"></i><b>3.5.3</b> Data loading</a></li>
<li class="chapter" data-level="3.5.4" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html#raster-location"><i class="fa fa-check"></i><b>3.5.4</b> Raster location</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html#part-2-descriptive-statistics"><i class="fa fa-check"></i><b>3.6</b> Part 2 descriptive statistics</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html#data-preparation"><i class="fa fa-check"></i><b>3.6.1</b> Data preparation</a></li>
<li class="chapter" data-level="3.6.2" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html#histogram"><i class="fa fa-check"></i><b>3.6.2</b> Histogram</a></li>
<li class="chapter" data-level="3.6.3" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html#using-more-data"><i class="fa fa-check"></i><b>3.6.3</b> Using more data</a></li>
<li class="chapter" data-level="3.6.4" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html#histogram-with-ggplot"><i class="fa fa-check"></i><b>3.6.4</b> Histogram with ggplot</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html#feedback-2"><i class="fa fa-check"></i><b>3.7</b> Feedback</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html"><i class="fa fa-check"></i><b>4</b> Git, GitHub and RMarkdown</a>
<ul>
<li class="chapter" data-level="4.1" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#learning-outcomes-3"><i class="fa fa-check"></i><b>4.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="4.2" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#homework-3"><i class="fa fa-check"></i><b>4.2</b> Homework</a></li>
<li class="chapter" data-level="4.3" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#recommended-listening-3"><i class="fa fa-check"></i><b>4.3</b> Recommended listening ðŸŽ§</a></li>
<li class="chapter" data-level="4.4" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#introduction-3"><i class="fa fa-check"></i><b>4.4</b> Introduction</a></li>
<li class="chapter" data-level="4.5" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#git-and-github"><i class="fa fa-check"></i><b>4.5</b> Git and GitHub</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#the-three-ways"><i class="fa fa-check"></i><b>4.5.1</b> The three ways</a></li>
<li class="chapter" data-level="4.5.2" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#set-up-your-github"><i class="fa fa-check"></i><b>4.5.2</b> Set up your GitHub</a></li>
<li class="chapter" data-level="4.5.3" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#using-rstudio-with-git"><i class="fa fa-check"></i><b>4.5.3</b> Using RStudio with Git</a></li>
<li class="chapter" data-level="4.5.4" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#using-the-git-gui---way-1"><i class="fa fa-check"></i><b>4.5.4</b> Using the Git GUI - way 1</a></li>
<li class="chapter" data-level="4.5.5" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#create-a-new-version-control-in-rstudio---way-2"><i class="fa fa-check"></i><b>4.5.5</b> Create a new version control in RStudio - way 2</a></li>
<li class="chapter" data-level="4.5.6" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#if-have-an-existing-project---way-3"><i class="fa fa-check"></i><b>4.5.6</b> If have an existing project - way 3</a></li>
<li class="chapter" data-level="4.5.7" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#commiting-to-git"><i class="fa fa-check"></i><b>4.5.7</b> Commiting to Git</a></li>
<li class="chapter" data-level="4.5.8" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#push-to-github"><i class="fa fa-check"></i><b>4.5.8</b> Push to Github</a></li>
<li class="chapter" data-level="4.5.9" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#pull-from-github"><i class="fa fa-check"></i><b>4.5.9</b> Pull from GitHub</a></li>
<li class="chapter" data-level="4.5.10" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#using-git-outside-rstudio"><i class="fa fa-check"></i><b>4.5.10</b> Using Git outside RStudio</a></li>
<li class="chapter" data-level="4.5.11" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#troubleshooting"><i class="fa fa-check"></i><b>4.5.11</b> Troubleshooting</a></li>
<li class="chapter" data-level="4.5.12" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#fork-a-repository"><i class="fa fa-check"></i><b>4.5.12</b> Fork a repository</a></li>
<li class="chapter" data-level="4.5.13" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#branches"><i class="fa fa-check"></i><b>4.5.13</b> Branches</a></li>
<li class="chapter" data-level="4.5.14" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#health-warning-1"><i class="fa fa-check"></i><b>4.5.14</b> Health warning</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#rmarkdown"><i class="fa fa-check"></i><b>4.6</b> RMarkdown</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#html"><i class="fa fa-check"></i><b>4.6.1</b> HTML</a></li>
<li class="chapter" data-level="4.6.2" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#knit-options"><i class="fa fa-check"></i><b>4.6.2</b> Knit options</a></li>
<li class="chapter" data-level="4.6.3" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#shortcuts"><i class="fa fa-check"></i><b>4.6.3</b> Shortcuts</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#further-reading"><i class="fa fa-check"></i><b>4.7</b> Further reading</a></li>
<li class="chapter" data-level="4.8" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#feedback-3"><i class="fa fa-check"></i><b>4.8</b> Feedback</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="map-making.html"><a href="map-making.html"><i class="fa fa-check"></i><b>5</b> Map making</a>
<ul>
<li class="chapter" data-level="5.1" data-path="map-making.html"><a href="map-making.html#learning-outcomes-4"><i class="fa fa-check"></i><b>5.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="5.2" data-path="map-making.html"><a href="map-making.html#homework-4"><i class="fa fa-check"></i><b>5.2</b> Homework</a></li>
<li class="chapter" data-level="5.3" data-path="map-making.html"><a href="map-making.html#recommended-listening-4"><i class="fa fa-check"></i><b>5.3</b> Recommended listening ðŸŽ§</a></li>
<li class="chapter" data-level="5.4" data-path="map-making.html"><a href="map-making.html#introduction-4"><i class="fa fa-check"></i><b>5.4</b> Introduction</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="map-making.html"><a href="map-making.html#osm-1"><i class="fa fa-check"></i><b>5.4.1</b> OSM</a></li>
<li class="chapter" data-level="5.4.2" data-path="map-making.html"><a href="map-making.html#airbnb"><i class="fa fa-check"></i><b>5.4.2</b> Airbnb</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="map-making.html"><a href="map-making.html#data-1"><i class="fa fa-check"></i><b>5.5</b> Data</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="map-making.html"><a href="map-making.html#osm-2"><i class="fa fa-check"></i><b>5.5.1</b> OSM</a></li>
<li class="chapter" data-level="5.5.2" data-path="map-making.html"><a href="map-making.html#london-boroughs"><i class="fa fa-check"></i><b>5.5.2</b> London boroughs</a></li>
<li class="chapter" data-level="5.5.3" data-path="map-making.html"><a href="map-making.html#world-cities"><i class="fa fa-check"></i><b>5.5.3</b> World cities</a></li>
<li class="chapter" data-level="5.5.4" data-path="map-making.html"><a href="map-making.html#uk-outline"><i class="fa fa-check"></i><b>5.5.4</b> Uk outline</a></li>
<li class="chapter" data-level="5.5.5" data-path="map-making.html"><a href="map-making.html#airbnb-1"><i class="fa fa-check"></i><b>5.5.5</b> Airbnb</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="map-making.html"><a href="map-making.html#qgis-2"><i class="fa fa-check"></i><b>5.6</b> QGIS</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="map-making.html"><a href="map-making.html#load-data-2"><i class="fa fa-check"></i><b>5.6.1</b> Load data</a></li>
<li class="chapter" data-level="5.6.2" data-path="map-making.html"><a href="map-making.html#manipulate-data"><i class="fa fa-check"></i><b>5.6.2</b> Manipulate data</a></li>
<li class="chapter" data-level="5.6.3" data-path="map-making.html"><a href="map-making.html#map-data"><i class="fa fa-check"></i><b>5.6.3</b> Map data</a></li>
<li class="chapter" data-level="5.6.4" data-path="map-making.html"><a href="map-making.html#export-map"><i class="fa fa-check"></i><b>5.6.4</b> Export map</a></li>
<li class="chapter" data-level="5.6.5" data-path="map-making.html"><a href="map-making.html#graphical-modeler"><i class="fa fa-check"></i><b>5.6.5</b> Graphical modeler</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="map-making.html"><a href="map-making.html#r-2"><i class="fa fa-check"></i><b>5.7</b> R</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="map-making.html"><a href="map-making.html#spatial-joining"><i class="fa fa-check"></i><b>5.7.1</b> Spatial joining</a></li>
<li class="chapter" data-level="5.7.2" data-path="map-making.html"><a href="map-making.html#static-map"><i class="fa fa-check"></i><b>5.7.2</b> Static map</a></li>
<li class="chapter" data-level="5.7.3" data-path="map-making.html"><a href="map-making.html#inset-map"><i class="fa fa-check"></i><b>5.7.3</b> Inset map</a></li>
<li class="chapter" data-level="5.7.4" data-path="map-making.html"><a href="map-making.html#export"><i class="fa fa-check"></i><b>5.7.4</b> Export</a></li>
<li class="chapter" data-level="5.7.5" data-path="map-making.html"><a href="map-making.html#basic-interactive-map"><i class="fa fa-check"></i><b>5.7.5</b> Basic interactive map</a></li>
<li class="chapter" data-level="5.7.6" data-path="map-making.html"><a href="map-making.html#advanced-interactive-map"><i class="fa fa-check"></i><b>5.7.6</b> Advanced interactive map</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="map-making.html"><a href="map-making.html#bad-maps"><i class="fa fa-check"></i><b>5.8</b> Bad maps</a></li>
<li class="chapter" data-level="5.9" data-path="map-making.html"><a href="map-making.html#feedback-4"><i class="fa fa-check"></i><b>5.9</b> Feedback</a></li>
</ul></li>
<li class="part"><span><b>II GIS analysis</b></span></li>
<li class="chapter" data-level="6" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html"><i class="fa fa-check"></i><b>6</b> Detecting spatial patterns</a>
<ul>
<li class="chapter" data-level="6.1" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#learning-outcomes-5"><i class="fa fa-check"></i><b>6.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="6.2" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#homework-5"><i class="fa fa-check"></i><b>6.2</b> Homework</a></li>
<li class="chapter" data-level="6.3" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#recommended-listening-5"><i class="fa fa-check"></i><b>6.3</b> Recommended listening ðŸŽ§</a></li>
<li class="chapter" data-level="6.4" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#introduction-5"><i class="fa fa-check"></i><b>6.4</b> Introduction</a></li>
<li class="chapter" data-level="6.5" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#setting-up-your-data"><i class="fa fa-check"></i><b>6.5</b> Setting up your data</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#data-cleaning"><i class="fa fa-check"></i><b>6.5.1</b> Data cleaning</a></li>
<li class="chapter" data-level="6.5.2" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#spatial-subsetting"><i class="fa fa-check"></i><b>6.5.2</b> Spatial subsetting</a></li>
<li class="chapter" data-level="6.5.3" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#spatial-clipping"><i class="fa fa-check"></i><b>6.5.3</b> Spatial clipping</a></li>
<li class="chapter" data-level="6.5.4" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#spatial-joining-1"><i class="fa fa-check"></i><b>6.5.4</b> Spatial joining</a></li>
<li class="chapter" data-level="6.5.5" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#key-advice"><i class="fa fa-check"></i><b>6.5.5</b> Key advice</a></li>
<li class="chapter" data-level="6.5.6" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#study-area"><i class="fa fa-check"></i><b>6.5.6</b> Study area</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#point-pattern-analysis"><i class="fa fa-check"></i><b>6.6</b> Point pattern analysis</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#kernel-density-estimation"><i class="fa fa-check"></i><b>6.6.1</b> Kernel Density Estimation</a></li>
<li class="chapter" data-level="6.6.2" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#quadrat-analysis"><i class="fa fa-check"></i><b>6.6.2</b> Quadrat Analysis</a></li>
<li class="chapter" data-level="6.6.3" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#try-experimenting"><i class="fa fa-check"></i><b>6.6.3</b> Try experimentingâ€¦</a></li>
<li class="chapter" data-level="6.6.4" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#ripleys-k"><i class="fa fa-check"></i><b>6.6.4</b> Ripleyâ€™s K</a></li>
<li class="chapter" data-level="6.6.5" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#alternatives-to-ripleys-k"><i class="fa fa-check"></i><b>6.6.5</b> Alternatives to Ripleyâ€™s K</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#density-based-spatial-clustering-of-applications-with-noise-dbscan"><i class="fa fa-check"></i><b>6.7</b> Density-based spatial clustering of applications with noise: DBSCAN</a></li>
<li class="chapter" data-level="6.8" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#point-pattern-analysis-summary"><i class="fa fa-check"></i><b>6.8</b> Point pattern analysis summary</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html"><i class="fa fa-check"></i><b>7</b> Spatial autocorrelation</a>
<ul>
<li class="chapter" data-level="7.1" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#learning-outcomes-6"><i class="fa fa-check"></i><b>7.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="7.2" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#homework-6"><i class="fa fa-check"></i><b>7.2</b> Homework</a></li>
<li class="chapter" data-level="7.3" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#recommended-listening-6"><i class="fa fa-check"></i><b>7.3</b> Recommended listening ðŸŽ§</a></li>
<li class="chapter" data-level="7.4" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#introduction-6"><i class="fa fa-check"></i><b>7.4</b> Introduction</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#analysing-spatial-autocorrelation-with-morans-i-lisa-and-friends"><i class="fa fa-check"></i><b>7.4.1</b> Analysing Spatial Autocorrelation with Moranâ€™s I, LISA and friends</a></li>
<li class="chapter" data-level="7.4.2" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#data-download-1"><i class="fa fa-check"></i><b>7.4.2</b> Data download</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#data-cleaning-1"><i class="fa fa-check"></i><b>7.5</b> Data cleaning</a></li>
<li class="chapter" data-level="7.6" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#data-manipulation"><i class="fa fa-check"></i><b>7.6</b> Data manipulation</a></li>
<li class="chapter" data-level="7.7" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#weight-matrix"><i class="fa fa-check"></i><b>7.7</b> Weight matrix</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#matrix-style"><i class="fa fa-check"></i><b>7.7.1</b> Matrix style</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#autocorrelation"><i class="fa fa-check"></i><b>7.8</b> Autocorrelation</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#morans-i"><i class="fa fa-check"></i><b>7.8.1</b> Moranâ€™s I</a></li>
<li class="chapter" data-level="7.8.2" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#gearys-c"><i class="fa fa-check"></i><b>7.8.2</b> Gearyâ€™s C</a></li>
<li class="chapter" data-level="7.8.3" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#getis-ord"><i class="fa fa-check"></i><b>7.8.3</b> Getis Ord</a></li>
<li class="chapter" data-level="7.8.4" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#summary-1"><i class="fa fa-check"></i><b>7.8.4</b> Summary</a></li>
<li class="chapter" data-level="7.8.5" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#local-morans-i"><i class="fa fa-check"></i><b>7.8.5</b> Local Moranâ€™s I</a></li>
<li class="chapter" data-level="7.8.6" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#local-getis-ord-g_i"><i class="fa fa-check"></i><b>7.8.6</b> Local Getis Ord <span class="math inline">\(G_{i}^{*}\)</span></a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#other-variables"><i class="fa fa-check"></i><b>7.9</b> Other variables</a></li>
<li class="chapter" data-level="7.10" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#feedback-5"><i class="fa fa-check"></i><b>7.10</b> Feedback</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html"><i class="fa fa-check"></i><b>8</b> Explaining spatial patterns</a>
<ul>
<li class="chapter" data-level="8.1" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#learning-objectives"><i class="fa fa-check"></i><b>8.1</b> Learning objectives</a></li>
<li class="chapter" data-level="8.2" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#homework-7"><i class="fa fa-check"></i><b>8.2</b> Homework</a></li>
<li class="chapter" data-level="8.3" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#recommended-listening-7"><i class="fa fa-check"></i><b>8.3</b> Recommended listening ðŸŽ§</a></li>
<li class="chapter" data-level="8.4" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#introduction-7"><i class="fa fa-check"></i><b>8.4</b> Introduction</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#setting-up-your-data-1"><i class="fa fa-check"></i><b>8.4.1</b> Setting up your Data</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#analysing-gcse-exam-performance---testing-a-research-hypothesis"><i class="fa fa-check"></i><b>8.5</b> Analysing GCSE exam performance - testing a research hypothesis</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#research-question-and-hypothesis"><i class="fa fa-check"></i><b>8.5.1</b> Research Question and Hypothesis</a></li>
<li class="chapter" data-level="8.5.2" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#regression-basics"><i class="fa fa-check"></i><b>8.5.2</b> Regression Basics</a></li>
<li class="chapter" data-level="8.5.3" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#running-a-regression-model-in-r"><i class="fa fa-check"></i><b>8.5.3</b> Running a Regression Model in R</a></li>
<li class="chapter" data-level="8.5.4" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#tidymodels"><i class="fa fa-check"></i><b>8.5.4</b> tidymodels</a></li>
<li class="chapter" data-level="8.5.5" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#bootstrap-resampling"><i class="fa fa-check"></i><b>8.5.5</b> Bootstrap resampling</a></li>
<li class="chapter" data-level="8.5.6" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#variables"><i class="fa fa-check"></i><b>8.5.6</b> Variables</a></li>
<li class="chapter" data-level="8.5.7" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#assumptions-underpinning-linear-regression"><i class="fa fa-check"></i><b>8.5.7</b> Assumptions Underpinning Linear Regression</a></li>
<li class="chapter" data-level="8.5.8" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#assumption-1---there-is-a-linear-relationship-between-the-dependent-and-independent-variables"><i class="fa fa-check"></i><b>8.5.8</b> Assumption 1 - There is a linear relationship between the dependent and independent variables</a></li>
<li class="chapter" data-level="8.5.9" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#assumption-2---the-residuals-in-your-model-should-be-normally-distributed"><i class="fa fa-check"></i><b>8.5.9</b> Assumption 2 - The residuals in your model should be normally distributed</a></li>
<li class="chapter" data-level="8.5.10" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#assumption-3---no-multicolinearity-in-the-independent-variables"><i class="fa fa-check"></i><b>8.5.10</b> Assumption 3 - No Multicolinearity in the independent variables</a></li>
<li class="chapter" data-level="8.5.11" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#assumption-4---homoscedasticity"><i class="fa fa-check"></i><b>8.5.11</b> Assumption 4 - Homoscedasticity</a></li>
<li class="chapter" data-level="8.5.12" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#assumption-5---independence-of-errors"><i class="fa fa-check"></i><b>8.5.12</b> Assumption 5 - Independence of Errors</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#spatial-regression-models"><i class="fa fa-check"></i><b>8.6</b> Spatial Regression Models</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#dealing-with-spatially-autocorrelated-residuals---spatial-lag-and-spatial-error-models"><i class="fa fa-check"></i><b>8.6.1</b> Dealing with Spatially Autocorrelated Residuals - Spatial Lag and Spatial Error models</a></li>
<li class="chapter" data-level="8.6.2" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#key-advice-1"><i class="fa fa-check"></i><b>8.6.2</b> Key advice</a></li>
<li class="chapter" data-level="8.6.3" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#which-model-to-use"><i class="fa fa-check"></i><b>8.6.3</b> Which model to use</a></li>
<li class="chapter" data-level="8.6.4" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#more-data"><i class="fa fa-check"></i><b>8.6.4</b> More data</a></li>
<li class="chapter" data-level="8.6.5" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#extending-your-regression-model---dummy-variables"><i class="fa fa-check"></i><b>8.6.5</b> Extending your regression model - Dummy Variables</a></li>
<li class="chapter" data-level="8.6.6" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#task-investigating-further---adding-more-explanatory-variables-into-a-multiple-regression-model"><i class="fa fa-check"></i><b>8.6.6</b> TASK: Investigating Further - Adding More Explanatory Variables into a multiple regression model</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#task-3---spatial-non-stationarity-and-geographically-weighted-regression-models-gwr"><i class="fa fa-check"></i><b>8.7</b> Task 3 - Spatial Non-stationarity and Geographically Weighted Regression Models (GWR)</a></li>
<li class="chapter" data-level="8.8" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#feedback-6"><i class="fa fa-check"></i><b>8.8</b> Feedback</a></li>
</ul></li>
<li class="part"><span><b>Extra</b></span></li>
<li class="chapter" data-level="" data-path="module-resources.html"><a href="module-resources.html"><i class="fa fa-check"></i>Module resources</a>
<ul>
<li class="chapter" data-level="8.9" data-path="module-resources.html"><a href="module-resources.html#markscheme"><i class="fa fa-check"></i><b>8.9</b> Markscheme</a></li>
<li class="chapter" data-level="8.10" data-path="module-resources.html"><a href="module-resources.html#old-practicals"><i class="fa fa-check"></i><b>8.10</b> Old practicals</a></li>
<li class="chapter" data-level="8.11" data-path="module-resources.html"><a href="module-resources.html#events-meet-other-spatial-data-professionals"><i class="fa fa-check"></i><b>8.11</b> Events / meet other spatial data professionals</a></li>
<li class="chapter" data-level="8.12" data-path="module-resources.html"><a href="module-resources.html#cool-stuff-to-explore"><i class="fa fa-check"></i><b>8.12</b> Cool stuff to explore</a></li>
<li class="chapter" data-level="8.13" data-path="module-resources.html"><a href="module-resources.html#booksreading-resources"><i class="fa fa-check"></i><b>8.13</b> Books/reading resources</a></li>
<li class="chapter" data-level="8.14" data-path="module-resources.html"><a href="module-resources.html#new-developments"><i class="fa fa-check"></i><b>8.14</b> New developments</a>
<ul>
<li class="chapter" data-level="8.14.1" data-path="module-resources.html"><a href="module-resources.html#twitter"><i class="fa fa-check"></i><b>8.14.1</b> Twitter</a></li>
</ul></li>
<li class="chapter" data-level="8.15" data-path="module-resources.html"><a href="module-resources.html#data-2"><i class="fa fa-check"></i><b>8.15</b> Data</a></li>
<li class="chapter" data-level="8.16" data-path="module-resources.html"><a href="module-resources.html#data-lists-1"><i class="fa fa-check"></i><b>8.16</b> Data lists</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="extra-reproducibility.html"><a href="extra-reproducibility.html"><i class="fa fa-check"></i>Extra reproducibility</a>
<ul>
<li class="chapter" data-level="8.17" data-path="extra-reproducibility.html"><a href="extra-reproducibility.html#git-and-github-1"><i class="fa fa-check"></i><b>8.17</b> Git and GitHub</a>
<ul>
<li class="chapter" data-level="8.17.1" data-path="extra-reproducibility.html"><a href="extra-reproducibility.html#back-in-time"><i class="fa fa-check"></i><b>8.17.1</b> Back in time</a></li>
</ul></li>
<li class="chapter" data-level="8.18" data-path="extra-reproducibility.html"><a href="extra-reproducibility.html#renv"><i class="fa fa-check"></i><b>8.18</b> renv</a></li>
<li class="chapter" data-level="8.19" data-path="extra-reproducibility.html"><a href="extra-reproducibility.html#referencing-and-more"><i class="fa fa-check"></i><b>8.19</b> Referencing and more</a></li>
</ul></li>
<li class="divider"></li>
<li><center>
  <a rel="license" href="./external-usage.html#license">
    License: CC-BY-SA<br>
    <i class = "fab fa-creative-commons fa-2x"></i>
    <i class = "fab fa-creative-commons-by fa-2x"></i>
    <i class = "fab fa-creative-commons-sa fa-2x"></i>
  </a>
</li></center>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">CASA0005 Geographic Information Systems and Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="spatial-autocorrelation" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Chapter 7</span> Spatial autocorrelation<a href="spatial-autocorrelation.html#spatial-autocorrelation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="learning-outcomes-6" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Learning outcomes<a href="spatial-autocorrelation.html#learning-outcomes-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>By the end of this practical you should be able to:</p>
<ol style="list-style-type: decimal">
<li>Execute data cleaning and manipulation appropriate for analysis</li>
<li>Explain and implement different models for spatial relationships (e.g.Â spatial weights)</li>
<li>Investigate the degree to which values at spatial points are similar (or different) to each other</li>
<li>Interpret the meaning of spatial autocorrleation in spatial data</li>
</ol>
</div>
<div id="homework-6" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Homework<a href="spatial-autocorrelation.html#homework-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Outside of our scheduled sessions you should be doing around 12 hours of extra study per week. Feel free to follow your own GIS interests, but good places to start include the following:</p>
<div class="infobox assignment">
<p><strong>Exam</strong></p>
<p>Each week we will provide a short task to test your knowledge, these should be used to guide your study for the final exam.</p>
<p>For the task this week complete the practice exam question you started last week with the new tools you have learnt.</p>
</div>
<div class="infobox note">
<p><strong>Reading</strong></p>
<p>This week:</p>
<ul>
<li><p><a href="https://onlinelibrary.wiley.com/doi/10.1111/j.1538-4632.2009.00769.x">What Problem? Spatial Autocorrelation and Geographic Information Science</a> by Goodchild (2009).</p></li>
<li><p><a href="https://mgimond.github.io/Spatial/spatial-autocorrelation.html">Chapter 13 â€œSpatial Autocorrelationâ€</a> from Intro to GIS and Spatial Analysis by Gimond (2019).</p></li>
<li><p><a href="https://www.jstor.org/stable/pdf/622936.pdf">Spatial Point Pattern Analysis and Its Application in Geographical Epidemiology</a> by Gatrell et al.Â (1996)</p></li>
</ul>
<p>Remember this is just a starting point, explore the <a href="https://rl.talis.com/3/ucl/lists/139FBAF8-DACD-60FB-8BDC-E9C9E09BA885.html?lang=en-GB&amp;login=1">reading list</a>, practical and lecture for more ideas.</p>
</div>
</div>
<div id="recommended-listening-6" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Recommended listening ðŸŽ§<a href="#recommended-listening-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Some of these practicals are long, take regular breaks and have a listen to some of our fav tunes each week.</p>
<p><a href="https://www.youtube.com/watch?v=hlVBg7_08n0">Andy</a></p>
<p><a href="https://open.spotify.com/album/4OCAtcMneSzQKZGJK95ayo?si=YRtNrsspTF6XpTPRjv2XFg">Adam</a> This week itâ€™s the head honcho himself, the man, the legend that is Tony Colman, CEO and founder of Hospital Records â€” his new album Building Better Worlds is a masterpiece! Enjoy!</p>
</div>
<div id="introduction-6" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> Introduction<a href="spatial-autocorrelation.html#introduction-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="analysing-spatial-autocorrelation-with-morans-i-lisa-and-friends" class="section level3 hasAnchor" number="7.4.1">
<h3><span class="header-section-number">7.4.1</span> Analysing Spatial Autocorrelation with Moranâ€™s I, LISA and friends<a href="spatial-autocorrelation.html#analysing-spatial-autocorrelation-with-morans-i-lisa-and-friends" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this section we are going to explore patterns of spatially referenced continuous observations using various measures of spatial autocorrelation. Spatial autocorrelation is a measure of similarity between nearby data. Check out the various references in the reading list for more information about the methods we will explore today. There are also useful links in the help file of the <code>spdep</code> package which we will be using here.</p>
<p>This week my question might be <strong>Are the values (in this case the density of blue plaques) similar (or dissimilar) across the wards of London</strong></p>
</div>
<div id="data-download-1" class="section level3 hasAnchor" number="7.4.2">
<h3><span class="header-section-number">7.4.2</span> Data download<a href="spatial-autocorrelation.html#data-download-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Before we get any further, letâ€™s get some ward boundaries read in to R â€” download LondonWardData from <a href="https://data.london.gov.uk/dataset/statistical-gis-boundary-files-london">the London Data store</a> and read it inâ€¦</p>
<p><strong>Use the data in the statistical-gis-boundaries-london.zip</strong></p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="spatial-autocorrelation.html#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb287-2"><a href="spatial-autocorrelation.html#cb287-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb287-3"><a href="spatial-autocorrelation.html#cb287-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb287-4"><a href="spatial-autocorrelation.html#cb287-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb287-5"><a href="spatial-autocorrelation.html#cb287-5" aria-hidden="true" tabindex="-1"></a><span class="co">#read the ward data in</span></span>
<span id="cb287-6"><a href="spatial-autocorrelation.html#cb287-6" aria-hidden="true" tabindex="-1"></a>LondonWards <span class="ot">&lt;-</span> <span class="fu">st_read</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;prac6_data&quot;</span>, <span class="st">&quot;LondonWards.shp&quot;</span>))</span></code></pre></div>
<pre><code>## Reading layer `LondonWards&#39; from data source 
##   `C:\Users\Andy\OneDrive - University College London\Teaching\CASA0005\2022_2023\CASA0005repo\prac6_data\LondonWards.shp&#39; 
##   using driver `ESRI Shapefile&#39;
## Simple feature collection with 625 features and 77 fields
## Geometry type: POLYGON
## Dimension:     XY
## Bounding box:  xmin: 503568.2 ymin: 155850.8 xmax: 561957.5 ymax: 200933.9
## Projected CRS: OSGB 1936 / British National Grid</code></pre>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="spatial-autocorrelation.html#cb289-1" aria-hidden="true" tabindex="-1"></a>LondonWardsMerged <span class="ot">&lt;-</span> <span class="fu">st_read</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;prac6_data&quot;</span>, </span>
<span id="cb289-2"><a href="spatial-autocorrelation.html#cb289-2" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">&quot;statistical-gis-boundaries-london&quot;</span>, </span>
<span id="cb289-3"><a href="spatial-autocorrelation.html#cb289-3" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">&quot;statistical-gis-boundaries-london&quot;</span>, </span>
<span id="cb289-4"><a href="spatial-autocorrelation.html#cb289-4" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">&quot;ESRI&quot;</span>,</span>
<span id="cb289-5"><a href="spatial-autocorrelation.html#cb289-5" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">&quot;London_Ward_CityMerged.shp&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb289-6"><a href="spatial-autocorrelation.html#cb289-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(.,<span class="dv">27700</span>)</span></code></pre></div>
<pre><code>## Reading layer `London_Ward_CityMerged&#39; from data source 
##   `C:\Users\Andy\OneDrive - University College London\Teaching\CASA0005\2022_2023\CASA0005repo\prac6_data\statistical-gis-boundaries-london\statistical-gis-boundaries-london\ESRI\London_Ward_CityMerged.shp&#39; 
##   using driver `ESRI Shapefile&#39;
## Simple feature collection with 625 features and 7 fields
## Geometry type: POLYGON
## Dimension:     XY
## Bounding box:  xmin: 503568.2 ymin: 155850.8 xmax: 561957.5 ymax: 200933.9
## Projected CRS: OSGB 1936 / British National Grid</code></pre>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="spatial-autocorrelation.html#cb291-1" aria-hidden="true" tabindex="-1"></a>WardData <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://data.london.gov.uk/download/ward-profiles-and-atlas/772d2d64-e8c6-46cb-86f9-e52b4c7851bc/ward-profiles-excel-version.csv&quot;</span>,</span>
<span id="cb291-2"><a href="spatial-autocorrelation.html#cb291-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">locale =</span> <span class="fu">locale</span>(<span class="at">encoding =</span> <span class="st">&quot;latin1&quot;</span>),</span>
<span id="cb291-3"><a href="spatial-autocorrelation.html#cb291-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">na =</span> <span class="fu">c</span>(<span class="st">&quot;NA&quot;</span>, <span class="st">&quot;n/a&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb291-4"><a href="spatial-autocorrelation.html#cb291-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>()</span>
<span id="cb291-5"><a href="spatial-autocorrelation.html#cb291-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-6"><a href="spatial-autocorrelation.html#cb291-6" aria-hidden="true" tabindex="-1"></a>LondonWardsMerged <span class="ot">&lt;-</span> LondonWardsMerged <span class="sc">%&gt;%</span> </span>
<span id="cb291-7"><a href="spatial-autocorrelation.html#cb291-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(WardData, </span>
<span id="cb291-8"><a href="spatial-autocorrelation.html#cb291-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;GSS_CODE&quot;</span> <span class="ot">=</span> <span class="st">&quot;new_code&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb291-9"><a href="spatial-autocorrelation.html#cb291-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(GSS_CODE, <span class="at">.keep_all =</span> T)<span class="sc">%&gt;%</span></span>
<span id="cb291-10"><a href="spatial-autocorrelation.html#cb291-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(GSS_CODE, ward_name, average_gcse_capped_point_scores_2014)</span></code></pre></div>
<p>Itâ€™s probably projected correctly, but in case it isnâ€™t give it a projection using the <code>st_crs()</code> function in the <code>sf</code> package</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="spatial-autocorrelation.html#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="co">#have a look to check that it&#39;s </span></span>
<span id="cb292-2"><a href="spatial-autocorrelation.html#cb292-2" aria-hidden="true" tabindex="-1"></a><span class="co">#in the right projection</span></span>
<span id="cb292-3"><a href="spatial-autocorrelation.html#cb292-3" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(LondonWardsMerged)</span></code></pre></div>
<pre><code>## Coordinate Reference System:
##   User input: EPSG:27700 
##   wkt:
## PROJCRS[&quot;OSGB 1936 / British National Grid&quot;,
##     BASEGEOGCRS[&quot;OSGB 1936&quot;,
##         DATUM[&quot;OSGB 1936&quot;,
##             ELLIPSOID[&quot;Airy 1830&quot;,6377563.396,299.3249646,
##                 LENGTHUNIT[&quot;metre&quot;,1]]],
##         PRIMEM[&quot;Greenwich&quot;,0,
##             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
##         ID[&quot;EPSG&quot;,4277]],
##     CONVERSION[&quot;British National Grid&quot;,
##         METHOD[&quot;Transverse Mercator&quot;,
##             ID[&quot;EPSG&quot;,9807]],
##         PARAMETER[&quot;Latitude of natural origin&quot;,49,
##             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
##             ID[&quot;EPSG&quot;,8801]],
##         PARAMETER[&quot;Longitude of natural origin&quot;,-2,
##             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
##             ID[&quot;EPSG&quot;,8802]],
##         PARAMETER[&quot;Scale factor at natural origin&quot;,0.9996012717,
##             SCALEUNIT[&quot;unity&quot;,1],
##             ID[&quot;EPSG&quot;,8805]],
##         PARAMETER[&quot;False easting&quot;,400000,
##             LENGTHUNIT[&quot;metre&quot;,1],
##             ID[&quot;EPSG&quot;,8806]],
##         PARAMETER[&quot;False northing&quot;,-100000,
##             LENGTHUNIT[&quot;metre&quot;,1],
##             ID[&quot;EPSG&quot;,8807]]],
##     CS[Cartesian,2],
##         AXIS[&quot;(E)&quot;,east,
##             ORDER[1],
##             LENGTHUNIT[&quot;metre&quot;,1]],
##         AXIS[&quot;(N)&quot;,north,
##             ORDER[2],
##             LENGTHUNIT[&quot;metre&quot;,1]],
##     USAGE[
##         SCOPE[&quot;Engineering survey, topographic mapping.&quot;],
##         AREA[&quot;United Kingdom (UK) - offshore to boundary of UKCS within 49Â°45&#39;N to 61Â°N and 9Â°W to 2Â°E; onshore Great Britain (England, Wales and Scotland). Isle of Man onshore.&quot;],
##         BBOX[49.75,-9,61.01,2.01]],
##     ID[&quot;EPSG&quot;,27700]]</code></pre>
<p>Always plot the data to check it looks reasonable (e.g.Â there are no points in other countries / the latitude and longitude are correct)</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="spatial-autocorrelation.html#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tmap)</span>
<span id="cb294-2"><a href="spatial-autocorrelation.html#cb294-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-3"><a href="spatial-autocorrelation.html#cb294-3" aria-hidden="true" tabindex="-1"></a>BluePlaques <span class="ot">&lt;-</span> <span class="fu">st_read</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;prac6_data&quot;</span>,</span>
<span id="cb294-4"><a href="spatial-autocorrelation.html#cb294-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">&quot;open-plaques-london-2018-04-08.geojson&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb294-5"><a href="spatial-autocorrelation.html#cb294-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_transform</span>(.,<span class="dv">27700</span>)</span></code></pre></div>
<pre><code>## Reading layer `open-plaques-london-2018-04-08&#39; from data source 
##   `C:\Users\Andy\OneDrive - University College London\Teaching\CASA0005\2022_2023\CASA0005repo\prac6_data\open-plaques-london-2018-04-08.geojson&#39; 
##   using driver `GeoJSON&#39;
## Simple feature collection with 2812 features and 2 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: -0.477 ymin: 0 xmax: 0.21903 ymax: 51.6783
## Geodetic CRS:  WGS 84</code></pre>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="spatial-autocorrelation.html#cb296-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">&quot;plot&quot;</span>)</span>
<span id="cb296-2"><a href="spatial-autocorrelation.html#cb296-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(LondonWardsMerged) <span class="sc">+</span></span>
<span id="cb296-3"><a href="spatial-autocorrelation.html#cb296-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb296-4"><a href="spatial-autocorrelation.html#cb296-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(BluePlaques) <span class="sc">+</span></span>
<span id="cb296-5"><a href="spatial-autocorrelation.html#cb296-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-297-1.png" width="672" /></p>
</div>
</div>
<div id="data-cleaning-1" class="section level2 hasAnchor" number="7.5">
<h2><span class="header-section-number">7.5</span> Data cleaning<a href="spatial-autocorrelation.html#data-cleaning-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Ah yes, we might need to lose the blue plaques that fall outside of London</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="spatial-autocorrelation.html#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(BluePlaques)</span></code></pre></div>
<pre><code>##        id          inscription                 geometry   
##  Min.   :    1.0   Length:2812        POINT        :2812  
##  1st Qu.:  711.8   Class :character   epsg:27700   :   0  
##  Median : 6089.0   Mode  :character   +proj=tmer...:   0  
##  Mean   :10622.0                                          
##  3rd Qu.:10358.2                                          
##  Max.   :49190.0</code></pre>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="spatial-autocorrelation.html#cb299-1" aria-hidden="true" tabindex="-1"></a>BluePlaquesSub <span class="ot">&lt;-</span> BluePlaques[LondonWardsMerged,]</span>
<span id="cb299-2"><a href="spatial-autocorrelation.html#cb299-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3"><a href="spatial-autocorrelation.html#cb299-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(LondonWardsMerged) <span class="sc">+</span></span>
<span id="cb299-4"><a href="spatial-autocorrelation.html#cb299-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb299-5"><a href="spatial-autocorrelation.html#cb299-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(BluePlaquesSub) <span class="sc">+</span></span>
<span id="cb299-6"><a href="spatial-autocorrelation.html#cb299-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-298-1.png" width="672" /></p>
</div>
<div id="data-manipulation" class="section level2 hasAnchor" number="7.6">
<h2><span class="header-section-number">7.6</span> Data manipulation<a href="spatial-autocorrelation.html#data-manipulation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The measures of spatial autocorrelation that we will be using require continuous observations (counts of blue plaques, average GCSE scores, average incomes etc.) to be spatially referenced (i.e.Â attached to a spatial unit like a ward or a borough). The file you have already has the various obervations associated with the London Ward data file already attached to it, but letâ€™s continue with our blue plaques example for now.</p>
<p>To create a continuous observation from the blue plaques data we need to count all of the blue plaques that fall within each Ward in the City. Luckily, we can do this using the <code>st_intersects()</code> function from the <code>sf</code> package.</p>
<p><code>st_intersects()</code> will return a list of which points (plaques) are in each polygon (wards). So each row will be a polygon and the ID are the point IDs that intersect the polygon.</p>
<p>In this case we donâ€™t want to use <code>st_join()</code> (which by default uses <code>st_intersects()</code>) as <code>st_join()</code> is like a left join and will retain all the data in on the left. So if a ward is empty, there will still be a row for that ward. So, we use <code>st_intersects()</code> on its own. We could also use other topological relationship functions such as <code>st_within()</code> insteadâ€¦</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="spatial-autocorrelation.html#cb300-1" aria-hidden="true" tabindex="-1"></a>example<span class="ot">&lt;-</span><span class="fu">st_intersects</span>(LondonWardsMerged, BluePlaquesSub)</span>
<span id="cb300-2"><a href="spatial-autocorrelation.html#cb300-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-3"><a href="spatial-autocorrelation.html#cb300-3" aria-hidden="true" tabindex="-1"></a>example</span></code></pre></div>
<p>Here the polygon with the ID of 6 Kingston upon Thames - Coombe Hill has three plaques within itâ€¦we can check this with st_join (or using QGIS by opening the data)â€¦we have three plaquesâ€¦But note the ID column added is different to the ID of the dataâ€¦open blueplaques from the environment window and you will see the IDs that were returned in <code>st_intersects()</code>.</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="spatial-autocorrelation.html#cb301-1" aria-hidden="true" tabindex="-1"></a>check_example <span class="ot">&lt;-</span> LondonWardsMerged<span class="sc">%&gt;%</span></span>
<span id="cb301-2"><a href="spatial-autocorrelation.html#cb301-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_join</span>(BluePlaquesSub)<span class="sc">%&gt;%</span></span>
<span id="cb301-3"><a href="spatial-autocorrelation.html#cb301-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ward_name<span class="sc">==</span><span class="st">&quot;Kingston upon Thames - Coombe Hill&quot;</span>)</span></code></pre></div>
<p>Now we just take the length of each list per polygon and add this as new columnâ€¦</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="spatial-autocorrelation.html#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb302-2"><a href="spatial-autocorrelation.html#cb302-2" aria-hidden="true" tabindex="-1"></a>points_sf_joined <span class="ot">&lt;-</span> LondonWardsMerged<span class="sc">%&gt;%</span></span>
<span id="cb302-3"><a href="spatial-autocorrelation.html#cb302-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n =</span> <span class="fu">lengths</span>(<span class="fu">st_intersects</span>(., BluePlaquesSub)))<span class="sc">%&gt;%</span></span>
<span id="cb302-4"><a href="spatial-autocorrelation.html#cb302-4" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>()<span class="sc">%&gt;%</span></span>
<span id="cb302-5"><a href="spatial-autocorrelation.html#cb302-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#calculate area</span></span>
<span id="cb302-6"><a href="spatial-autocorrelation.html#cb302-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">area=</span><span class="fu">st_area</span>(.))<span class="sc">%&gt;%</span></span>
<span id="cb302-7"><a href="spatial-autocorrelation.html#cb302-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#then density of the points per ward</span></span>
<span id="cb302-8"><a href="spatial-autocorrelation.html#cb302-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">density=</span>n<span class="sc">/</span>area)<span class="sc">%&gt;%</span></span>
<span id="cb302-9"><a href="spatial-autocorrelation.html#cb302-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#select density and some other variables </span></span>
<span id="cb302-10"><a href="spatial-autocorrelation.html#cb302-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(density, ward_name, gss_code, n, average_gcse_capped_point_scores_2014)</span></code></pre></div>
<p>How about a quick choropleth map to see how we are getting onâ€¦</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="spatial-autocorrelation.html#cb303-1" aria-hidden="true" tabindex="-1"></a>points_sf_joined<span class="ot">&lt;-</span> points_sf_joined <span class="sc">%&gt;%</span>                    </span>
<span id="cb303-2"><a href="spatial-autocorrelation.html#cb303-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(gss_code) <span class="sc">%&gt;%</span>         </span>
<span id="cb303-3"><a href="spatial-autocorrelation.html#cb303-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">density =</span> <span class="fu">first</span>(density),</span>
<span id="cb303-4"><a href="spatial-autocorrelation.html#cb303-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">wardname=</span> <span class="fu">first</span>(ward_name),</span>
<span id="cb303-5"><a href="spatial-autocorrelation.html#cb303-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">plaquecount=</span> <span class="fu">first</span>(n))</span>
<span id="cb303-6"><a href="spatial-autocorrelation.html#cb303-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb303-7"><a href="spatial-autocorrelation.html#cb303-7" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(points_sf_joined) <span class="sc">+</span></span>
<span id="cb303-8"><a href="spatial-autocorrelation.html#cb303-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_polygons</span>(<span class="st">&quot;density&quot;</span>,</span>
<span id="cb303-9"><a href="spatial-autocorrelation.html#cb303-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">style=</span><span class="st">&quot;jenks&quot;</span>,</span>
<span id="cb303-10"><a href="spatial-autocorrelation.html#cb303-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">palette=</span><span class="st">&quot;PuOr&quot;</span>,</span>
<span id="cb303-11"><a href="spatial-autocorrelation.html#cb303-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">midpoint=</span><span class="cn">NA</span>,</span>
<span id="cb303-12"><a href="spatial-autocorrelation.html#cb303-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">popup.vars=</span><span class="fu">c</span>(<span class="st">&quot;wardname&quot;</span>, <span class="st">&quot;density&quot;</span>),</span>
<span id="cb303-13"><a href="spatial-autocorrelation.html#cb303-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">title=</span><span class="st">&quot;Blue Plaque Density&quot;</span>)</span></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-302-1.png" width="672" /></p>
<p>So, from the map, it looks as though we might have some clustering of blue plaques in the centre of London so letâ€™s check this with Moranâ€™s I and some other statistics.</p>
</div>
<div id="weight-matrix" class="section level2 hasAnchor" number="7.7">
<h2><span class="header-section-number">7.7</span> Weight matrix<a href="spatial-autocorrelation.html#weight-matrix" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before being able to calculate Moranâ€™s I and any similar statistics, we need to first define a <span class="math inline">\(W_{ij}\)</span> spatial weights matrix</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="spatial-autocorrelation.html#cb304-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spdep)</span></code></pre></div>
<p>First calculate the centroids of all Wards in London</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="spatial-autocorrelation.html#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="co">#First calculate the centroids of all Wards in London</span></span>
<span id="cb305-2"><a href="spatial-autocorrelation.html#cb305-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-3"><a href="spatial-autocorrelation.html#cb305-3" aria-hidden="true" tabindex="-1"></a>coordsW <span class="ot">&lt;-</span> points_sf_joined<span class="sc">%&gt;%</span></span>
<span id="cb305-4"><a href="spatial-autocorrelation.html#cb305-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_centroid</span>()<span class="sc">%&gt;%</span></span>
<span id="cb305-5"><a href="spatial-autocorrelation.html#cb305-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_geometry</span>()</span>
<span id="cb305-6"><a href="spatial-autocorrelation.html#cb305-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb305-7"><a href="spatial-autocorrelation.html#cb305-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(coordsW,<span class="at">axes=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-304-1.png" width="672" /></p>
<p>Now we need to generate a spatial weights matrix (remember from the lecture). Weâ€™ll start with a simple binary matrix of queenâ€™s case neighbours (otherwise known as Contiguity edges corners). This method means that polygons with a shared edge or a corner will be included in computations for the target polygonâ€¦A <strong>spatial weight matrix represents the spatial element of our data</strong>, this means we are trying to conceptualize and model how parts of the data are linked (or not linked) to each other spatially, using rules that we will set.</p>
<p><strong>A note on spatial weight matrices</strong></p>
<p>If the features share a boundary they are <strong>contiguous</strong>, this can also be classed as only common boundaries â€” a <strong>rook</strong> (like chess a rook can move forwards or side wards) or any point in common (e.g.Â corners / other boundaries) â€” a <strong>queen</strong> (like chess a queen can move forwards, backwards or on a diagonal).</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-305"></span>
<img src="prac6_images/weights.png" alt="Source: [Manuel S. Gonzalez Canche](https://rpubs.com/msgc/matrices_influence)" width="450pt" />
<p class="caption">
Figure 7.1: Source: <a href="https://rpubs.com/msgc/matrices_influence">Manuel S. Gonzalez Canche</a>
</p>
</div>
<p><strong>Alternatively</strong> instead of using contiguous relationships you can use <strong>distance</strong> based relationships. This is frequently done with k nearest neighbours in which k is set to the closest observations. e.g.Â K=3 means the three closest observations.</p>
<p>In the first instance we must create a neighbours list â€” which is a list of all the neighbours. To do so we will use <code>poly2nb()</code> with the argument <code>queen=T</code> saying we want a to use Queens case. Letâ€™s see a summary of the output</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="spatial-autocorrelation.html#cb306-1" aria-hidden="true" tabindex="-1"></a><span class="co">#create a neighbours list</span></span>
<span id="cb306-2"><a href="spatial-autocorrelation.html#cb306-2" aria-hidden="true" tabindex="-1"></a>LWard_nb <span class="ot">&lt;-</span> points_sf_joined <span class="sc">%&gt;%</span></span>
<span id="cb306-3"><a href="spatial-autocorrelation.html#cb306-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">poly2nb</span>(., <span class="at">queen=</span>T)</span></code></pre></div>
<p>The output is a neighbour list object hence why iâ€™ve called the object <code>LWard_nb</code>. We can get some summary info and plot the matrix.</p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="spatial-autocorrelation.html#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(LWard_nb)</span></code></pre></div>
<pre><code>## Neighbour list object:
## Number of regions: 625 
## Number of nonzero links: 3680 
## Percentage nonzero weights: 0.94208 
## Average number of links: 5.888 
## Link number distribution:
## 
##   1   2   3   4   5   6   7   8   9  10  11  12 
##   1   4  15  72 162 182 112  55  14   4   2   2 
## 1 least connected region:
## 380 with 1 link
## 2 most connected regions:
## 313 612 with 12 links</code></pre>
<p>Here it is telling us that the average number of neighbours is 5.88. Now letâ€™s plot the neighbours.</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="spatial-autocorrelation.html#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot them</span></span>
<span id="cb309-2"><a href="spatial-autocorrelation.html#cb309-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(LWard_nb, <span class="fu">st_geometry</span>(coordsW), <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb309-3"><a href="spatial-autocorrelation.html#cb309-3" aria-hidden="true" tabindex="-1"></a><span class="co">#add a map underneath</span></span>
<span id="cb309-4"><a href="spatial-autocorrelation.html#cb309-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(points_sf_joined<span class="sc">$</span>geometry, <span class="at">add=</span>T)</span></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-308-1.png" width="672" /></p>
<div id="matrix-style" class="section level3 hasAnchor" number="7.7.1">
<h3><span class="header-section-number">7.7.1</span> Matrix style<a href="spatial-autocorrelation.html#matrix-style" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>From the weights list we must now make a spatial weight matrix. This makes a matrix the size of the number of neighbourhoods with values indicating if the elements in the rows are a neighbour or not. The style of weight is especially important here:</p>
<ul>
<li>B is the basic binary coding (1/0)</li>
<li>W is <strong>row</strong> standardised (sums over all links to n)</li>
<li>C is <strong>globally</strong> standardised (sums over all links to n)</li>
<li>U is equal to C divided by the number of neighbours (sums over all links to unity)</li>
<li>S is the variance-stabilizing coding scheme proposed by Tiefelsdorf et al.Â 1999, p.Â 167-168 (sums over all links to n).</li>
</ul>
<p>To understand this further letâ€™s start with binary.</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="spatial-autocorrelation.html#cb310-1" aria-hidden="true" tabindex="-1"></a><span class="co">#create a spatial weights matrix from these weights</span></span>
<span id="cb310-2"><a href="spatial-autocorrelation.html#cb310-2" aria-hidden="true" tabindex="-1"></a>Lward.lw <span class="ot">&lt;-</span> LWard_nb <span class="sc">%&gt;%</span></span>
<span id="cb310-3"><a href="spatial-autocorrelation.html#cb310-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nb2mat</span>(., <span class="at">style=</span><span class="st">&quot;B&quot;</span>)</span>
<span id="cb310-4"><a href="spatial-autocorrelation.html#cb310-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb310-5"><a href="spatial-autocorrelation.html#cb310-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(Lward.lw)</span></code></pre></div>
<pre><code>## [1] 3680</code></pre>
<p>Summing the binary (1/0) shows that we have 3680 neighbours. Now if we were to do <strong>global</strong> standardisation this would mean dividing our 625 wards by the total number of neighbours meaning each spatial weight has a value of 0.169.</p>
<p>Alternatively we can do <strong>row</strong> standardisation where 1 is divided by the sum of the number of neighbours in each row. For example, row 1 here sums to 6, meaning each weight would be 0.166 in row 1 only.</p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="spatial-autocorrelation.html#cb312-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(Lward.lw[<span class="dv">1</span>,])</span></code></pre></div>
<pre><code>## [1] 6</code></pre>
<p>Standardisation permits comparable spatial parameters. But you also need to consider geographical features â€” should a neighbour be a neighbour if there is a river between them?</p>
</div>
</div>
<div id="autocorrelation" class="section level2 hasAnchor" number="7.8">
<h2><span class="header-section-number">7.8</span> Autocorrelation<a href="spatial-autocorrelation.html#autocorrelation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now we have defined our <span class="math inline">\(W_{ij}\)</span> matrix, we can calculate the Moranâ€™s I and other associated statistics. However, Moranâ€™s I requires a spatial weight <strong>list</strong> type object as opposed to <strong>matrix</strong>, this is simplyâ€¦</p>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="spatial-autocorrelation.html#cb314-1" aria-hidden="true" tabindex="-1"></a>Lward.lw <span class="ot">&lt;-</span> LWard_nb <span class="sc">%&gt;%</span></span>
<span id="cb314-2"><a href="spatial-autocorrelation.html#cb314-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nb2listw</span>(., <span class="at">style=</span><span class="st">&quot;C&quot;</span>)</span></code></pre></div>
<div id="morans-i" class="section level3 hasAnchor" number="7.8.1">
<h3><span class="header-section-number">7.8.1</span> Moranâ€™s I<a href="spatial-autocorrelation.html#morans-i" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Moranâ€™s I test tells us whether we have clustered values (close to 1) or dispersed values (close to -1), we will calculate for the densities rather than raw values (think about why this is?).</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="spatial-autocorrelation.html#cb315-1" aria-hidden="true" tabindex="-1"></a>I_LWard_Global_Density <span class="ot">&lt;-</span> points_sf_joined <span class="sc">%&gt;%</span></span>
<span id="cb315-2"><a href="spatial-autocorrelation.html#cb315-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(density) <span class="sc">%&gt;%</span></span>
<span id="cb315-3"><a href="spatial-autocorrelation.html#cb315-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.vector</span>()<span class="sc">%&gt;%</span></span>
<span id="cb315-4"><a href="spatial-autocorrelation.html#cb315-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">moran.test</span>(., Lward.lw)</span>
<span id="cb315-5"><a href="spatial-autocorrelation.html#cb315-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb315-6"><a href="spatial-autocorrelation.html#cb315-6" aria-hidden="true" tabindex="-1"></a>I_LWard_Global_Density</span></code></pre></div>
<pre><code>## 
##  Moran I test under randomisation
## 
## data:  .  
## weights: Lward.lw    
## 
## Moran I statistic standard deviate = 29.88, p-value &lt; 2.2e-16
## alternative hypothesis: greater
## sample estimates:
## Moran I statistic       Expectation          Variance 
##      0.6651530207     -0.0016025641      0.0004979282</code></pre>
</div>
<div id="gearys-c" class="section level3 hasAnchor" number="7.8.2">
<h3><span class="header-section-number">7.8.2</span> Gearyâ€™s C<a href="spatial-autocorrelation.html#gearys-c" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Gearyâ€™s C as well..? This tells us whether similar values or dissimilar values are clustering</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="spatial-autocorrelation.html#cb317-1" aria-hidden="true" tabindex="-1"></a>C_LWard_Global_Density <span class="ot">&lt;-</span> </span>
<span id="cb317-2"><a href="spatial-autocorrelation.html#cb317-2" aria-hidden="true" tabindex="-1"></a>  points_sf_joined <span class="sc">%&gt;%</span></span>
<span id="cb317-3"><a href="spatial-autocorrelation.html#cb317-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(density) <span class="sc">%&gt;%</span></span>
<span id="cb317-4"><a href="spatial-autocorrelation.html#cb317-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.vector</span>()<span class="sc">%&gt;%</span></span>
<span id="cb317-5"><a href="spatial-autocorrelation.html#cb317-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geary.test</span>(., Lward.lw)</span>
<span id="cb317-6"><a href="spatial-autocorrelation.html#cb317-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb317-7"><a href="spatial-autocorrelation.html#cb317-7" aria-hidden="true" tabindex="-1"></a>C_LWard_Global_Density</span></code></pre></div>
<pre><code>## 
##  Geary C test under randomisation
## 
## data:  . 
## weights: Lward.lw 
## 
## Geary C statistic standard deviate = 8.1813, p-value &lt; 2.2e-16
## alternative hypothesis: Expectation greater than statistic
## sample estimates:
## Geary C statistic       Expectation          Variance 
##       0.412516628       1.000000000       0.005156405</code></pre>
</div>
<div id="getis-ord" class="section level3 hasAnchor" number="7.8.3">
<h3><span class="header-section-number">7.8.3</span> Getis Ord<a href="spatial-autocorrelation.html#getis-ord" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Getis Ord General Gâ€¦? This tells us whether high or low values are clustering. If G &gt; Expected = High values clustering; if G &lt; expected = low values clustering</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="spatial-autocorrelation.html#cb319-1" aria-hidden="true" tabindex="-1"></a>G_LWard_Global_Density <span class="ot">&lt;-</span> </span>
<span id="cb319-2"><a href="spatial-autocorrelation.html#cb319-2" aria-hidden="true" tabindex="-1"></a>  points_sf_joined <span class="sc">%&gt;%</span></span>
<span id="cb319-3"><a href="spatial-autocorrelation.html#cb319-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(density) <span class="sc">%&gt;%</span></span>
<span id="cb319-4"><a href="spatial-autocorrelation.html#cb319-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.vector</span>()<span class="sc">%&gt;%</span></span>
<span id="cb319-5"><a href="spatial-autocorrelation.html#cb319-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">globalG.test</span>(., Lward.lw)</span>
<span id="cb319-6"><a href="spatial-autocorrelation.html#cb319-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb319-7"><a href="spatial-autocorrelation.html#cb319-7" aria-hidden="true" tabindex="-1"></a>G_LWard_Global_Density</span></code></pre></div>
<pre><code>## 
##  Getis-Ord global G statistic
## 
## data:  . 
## weights: Lward.lw 
## 
## standard deviate = 29.225, p-value &lt; 2.2e-16
## alternative hypothesis: greater
## sample estimates:
## Global G statistic        Expectation           Variance 
##       1.126545e-02       1.602564e-03       1.093203e-07</code></pre>
<p>So the global statistics are indicating that we have spatial autocorrelation of Blue Plaques in London:</p>
</div>
<div id="summary-1" class="section level3 hasAnchor" number="7.8.4">
<h3><span class="header-section-number">7.8.4</span> Summary<a href="spatial-autocorrelation.html#summary-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Moranâ€™s I statistic = 0.67 (remember 1 = clustered, 0 = no pattern, -1 = dispersed) which shows that we have some distinctive clustering</p>
<p>The Gearyâ€™s C statistic = 0.41 (remember Gearyâ€™s C falls between 0 and 2; 1 means no spatial autocorrelation, &lt;1 - positive spatial autocorrelation or similar values clustering, &gt;1 - negative spatial autocorreation or dissimilar values clustering) which shows that similar values are clustering</p>
<p>The General G statistic = G &gt; expected, so high values are tending to cluster.</p>
</div>
<div id="local-morans-i" class="section level3 hasAnchor" number="7.8.5">
<h3><span class="header-section-number">7.8.5</span> Local Moranâ€™s I<a href="spatial-autocorrelation.html#local-morans-i" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can now also calculate local versions of the Moranâ€™s I statistic (for each Ward) and a Getis Ord <span class="math inline">\(G_{i}^{*}\)</span> statistic to see <em>where</em> we have hot-spotsâ€¦</p>
<p>Local Moranâ€™s I is:</p>
<ul>
<li>The difference between a value and neighbours * the sum of differences between neighbours and the mean</li>
<li>Where the the difference between a value and neighbours is divided by the standard deviation (how much values in neighbourhood vary about the mean)</li>
</ul>
<p>It returns several columns, of most interest is the Z score. A Z-score is <strong>how many standard deviations a value is away (above or below) from the mean</strong>. This allows us to state if our value is significantly different than expected value at this location considering the neighours.</p>
<p>We are comparing our value of Moranâ€™s I to that of an expected value (computed from a separate equation that uses the spatial weight matrix, and therefore considers the neighbouring values). We are expecting our value of Moranâ€™s I to be in the middle of the distribution of the expected values. These expected values follow a normal distribution, with the middle part representing complete spatial randomness. This is <strong>typically</strong> between &lt; -1.65 or &gt; +1.65 standard deviations from the mean</p>
<p>The <strong>null hypothesis</strong> is always there is complete spatial randomness. A null hypothesis means:</p>
<blockquote>
<p>no statistical significance exists in a set of given observations</p>
</blockquote>
<p>If our value is towards the tails of the distribution then it is unlikely that the value is completely spatially random and we can reject the null hypothesisâ€¦as it is not what we expect at this location.</p>
<p>In the example where we use a z-score of &gt;2.58 or &lt;-2.58 we interpret this asâ€¦</p>
<p>â€¦&gt; 2.58 or &lt;-2.58 standard deviations away from the mean are significant at the 99% levelâ€¦this means there is a &lt;1% chance that autocorrelation is not present</p>
<p>The <a href="https://storymaps.arcgis.com/stories/5b26f25bb81a437b89003423505e2f71">Global vs location spatial autocorrelation resource</a> goes through the specific formulas here, but the most important parts are knowing</p>
<ul>
<li>What we are comparing values to in Local Moranâ€™s I</li>
<li>What the results mean</li>
<li>Why the results could be important</li>
</ul>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="spatial-autocorrelation.html#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="co">#use the localmoran function to generate I for each ward in the city</span></span>
<span id="cb321-2"><a href="spatial-autocorrelation.html#cb321-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb321-3"><a href="spatial-autocorrelation.html#cb321-3" aria-hidden="true" tabindex="-1"></a>I_LWard_Local_count <span class="ot">&lt;-</span> points_sf_joined <span class="sc">%&gt;%</span></span>
<span id="cb321-4"><a href="spatial-autocorrelation.html#cb321-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(plaquecount) <span class="sc">%&gt;%</span></span>
<span id="cb321-5"><a href="spatial-autocorrelation.html#cb321-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.vector</span>()<span class="sc">%&gt;%</span></span>
<span id="cb321-6"><a href="spatial-autocorrelation.html#cb321-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">localmoran</span>(., Lward.lw)<span class="sc">%&gt;%</span></span>
<span id="cb321-7"><a href="spatial-autocorrelation.html#cb321-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb321-8"><a href="spatial-autocorrelation.html#cb321-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb321-9"><a href="spatial-autocorrelation.html#cb321-9" aria-hidden="true" tabindex="-1"></a>I_LWard_Local_Density <span class="ot">&lt;-</span> points_sf_joined <span class="sc">%&gt;%</span></span>
<span id="cb321-10"><a href="spatial-autocorrelation.html#cb321-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(density) <span class="sc">%&gt;%</span></span>
<span id="cb321-11"><a href="spatial-autocorrelation.html#cb321-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.vector</span>()<span class="sc">%&gt;%</span></span>
<span id="cb321-12"><a href="spatial-autocorrelation.html#cb321-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">localmoran</span>(., Lward.lw)<span class="sc">%&gt;%</span></span>
<span id="cb321-13"><a href="spatial-autocorrelation.html#cb321-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb321-14"><a href="spatial-autocorrelation.html#cb321-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb321-15"><a href="spatial-autocorrelation.html#cb321-15" aria-hidden="true" tabindex="-1"></a><span class="co">#what does the output (the localMoran object) look like?</span></span>
<span id="cb321-16"><a href="spatial-autocorrelation.html#cb321-16" aria-hidden="true" tabindex="-1"></a><span class="fu">slice_head</span>(I_LWard_Local_Density, <span class="at">n=</span><span class="dv">5</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 Ã— 5
##   Ii         E.Ii          Var.Ii     Z.Ii       `Pr(z != E(Ii))`
##   &lt;localmrn&gt; &lt;localmrn&gt;    &lt;localmrn&gt; &lt;localmrn&gt; &lt;localmrn&gt;      
## 1 0.0888413  -0.0001086963 0.01144408 0.8314871  0.4056985       
## 2 0.1310300  -0.0002175669 0.02286771 0.8679202  0.3854380       
## 3 0.1070829  -0.0001864859 0.01963267 0.7655724  0.4439308       
## 4 0.1163672  -0.0001864859 0.01963267 0.8318337  0.4055028       
## 5 0.1163672  -0.0001864859 0.01963267 0.8318337  0.4055028</code></pre>
<p>There are 5 columns of data. We want to copy some of the columns (the I score (column 1) and the z-score standard deviation (column 4)) back into the LondonWards spatialPolygonsDataframe</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="spatial-autocorrelation.html#cb323-1" aria-hidden="true" tabindex="-1"></a>points_sf_joined <span class="ot">&lt;-</span> points_sf_joined <span class="sc">%&gt;%</span></span>
<span id="cb323-2"><a href="spatial-autocorrelation.html#cb323-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">plaque_count_I =</span> <span class="fu">as.numeric</span>(I_LWard_Local_count<span class="sc">$</span>Ii))<span class="sc">%&gt;%</span></span>
<span id="cb323-3"><a href="spatial-autocorrelation.html#cb323-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">plaque_count_Iz =</span><span class="fu">as.numeric</span>(I_LWard_Local_count<span class="sc">$</span>Z.Ii))<span class="sc">%&gt;%</span></span>
<span id="cb323-4"><a href="spatial-autocorrelation.html#cb323-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">density_I =</span><span class="fu">as.numeric</span>(I_LWard_Local_Density<span class="sc">$</span>Ii))<span class="sc">%&gt;%</span></span>
<span id="cb323-5"><a href="spatial-autocorrelation.html#cb323-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">density_Iz =</span><span class="fu">as.numeric</span>(I_LWard_Local_Density<span class="sc">$</span>Z.Ii))</span></code></pre></div>
<div id="mapping" class="section level4 hasAnchor" number="7.8.5.1">
<h4><span class="header-section-number">7.8.5.1</span> Mapping<a href="spatial-autocorrelation.html#mapping" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>No we can plot a map of the local Moranâ€™s I outputsâ€¦</p>
<p>Weâ€™ll set the breaks manually based on the rule that data points &gt;2.58 or &lt;-2.58 standard deviations away from the mean are significant at the 99% level (&lt;1% chance that autocorrelation not present); &gt;1.96 - &lt;2.58 or &lt;-1.96 to &gt;-2.58 standard deviations are significant at the 95% level (&lt;5% change that autocorrelation not present). &gt;1.65 = 90% etc.</p>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="spatial-autocorrelation.html#cb324-1" aria-hidden="true" tabindex="-1"></a>breaks1<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1000</span>,<span class="sc">-</span><span class="fl">2.58</span>,<span class="sc">-</span><span class="fl">1.96</span>,<span class="sc">-</span><span class="fl">1.65</span>,<span class="fl">1.65</span>,<span class="fl">1.96</span>,<span class="fl">2.58</span>,<span class="dv">1000</span>)</span></code></pre></div>
<p>Now create a new diverging colour brewer palette and reverse the order using <code>rev()</code> (reverse) so higher values correspond to red</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="spatial-autocorrelation.html#cb325-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb325-2"><a href="spatial-autocorrelation.html#cb325-2" aria-hidden="true" tabindex="-1"></a>MoranColours<span class="ot">&lt;-</span> <span class="fu">rev</span>(<span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">&quot;RdGy&quot;</span>))</span></code></pre></div>
<p>Plot on an interactive map</p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="spatial-autocorrelation.html#cb326-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(points_sf_joined) <span class="sc">+</span></span>
<span id="cb326-2"><a href="spatial-autocorrelation.html#cb326-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_polygons</span>(<span class="st">&quot;plaque_count_Iz&quot;</span>,</span>
<span id="cb326-3"><a href="spatial-autocorrelation.html#cb326-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">style=</span><span class="st">&quot;fixed&quot;</span>,</span>
<span id="cb326-4"><a href="spatial-autocorrelation.html#cb326-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">breaks=</span>breaks1,</span>
<span id="cb326-5"><a href="spatial-autocorrelation.html#cb326-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">palette=</span>MoranColours,</span>
<span id="cb326-6"><a href="spatial-autocorrelation.html#cb326-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">midpoint=</span><span class="cn">NA</span>,</span>
<span id="cb326-7"><a href="spatial-autocorrelation.html#cb326-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">title=</span><span class="st">&quot;Local Moran&#39;s I, Blue Plaques in London&quot;</span>)</span></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-319-1.png" width="672" /></p>
<p>This map shows some areas in the centre of London that have relatively high scores, indicating areas with lots of blue plaques neighbouring other areas with lots of blue plaques.</p>
</div>
</div>
<div id="local-getis-ord-g_i" class="section level3 hasAnchor" number="7.8.6">
<h3><span class="header-section-number">7.8.6</span> Local Getis Ord <span class="math inline">\(G_{i}^{*}\)</span><a href="spatial-autocorrelation.html#local-getis-ord-g_i" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>What about the Getis Ord <span class="math inline">\(G_{i}^{*}\)</span> statistic for hot and cold spotsâ€¦</p>
<p>This is a very similar concept to Local Moranâ€™s I except it just returns a z-scoreâ€¦remember that a z-score shows <strong>how many standard deviations a value (our value) is away (above or below) from the mean (of the expected values)</strong></p>
<p>Ultimately a z-score is defined as:</p>
<p><span class="math display">\[Z = \frac{x-\mu}{\sigma}\]</span>
Where:</p>
<ul>
<li><span class="math inline">\(x\)</span> = the observed value</li>
<li><span class="math inline">\(\mu\)</span> = the mean of the sample</li>
<li><span class="math inline">\(\sigma\)</span> = standard deviation of sample</li>
</ul>
<p><strong>Note</strong>, consult the <a href="https://storymaps.arcgis.com/stories/5b26f25bb81a437b89003423505e2f71">Global vs location spatial autocorrelation resource</a> for how this is computed in Local Moranâ€™s I if you are interested, although interpretation is the most important part here.</p>
<p><strong>However</strong>, in the case of Getis Ord <span class="math inline">\(G_{i}^{*}\)</span> this is the local sum (of the neighbourhood) compared to the sum of all features</p>
<p>In Moranâ€™s I this is just the value of the spatial unit (e.g.Â polygon of the ward) compared to the neighbouring units.</p>
<p>Here, to be significant (or a hot spot) we will have a high value surrounded by high values. The local sum of these values will be different to the expected sum (think of this as all the values in the area) then where this difference is large we can consider it to be not by chanceâ€¦</p>
<p>The same z-score criteria then applies as before..</p>
<p>This summary from L3 Harris nicely summaries the Getis Ord <span class="math inline">\(G_{i}^{*}\)</span> outputâ€¦</p>
<blockquote>
<p>The result of Getis Ord <span class="math inline">\(G_{i}^{*}\)</span> analysis is an array of Z-scores, one for each pixel [or polygon], which is the number of standard deviations that the pixel [or polygon] and its neighbors are from the global mean. High Z-scores indicate more intense clustering of high pixel values, indicating hot spots. Low Z-scores indicate more intense clustering of low values, indicating cold spots. Individual pixels with high or low values by themselves might be interesting but not necessarily significant.</p>
</blockquote>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="spatial-autocorrelation.html#cb327-1" aria-hidden="true" tabindex="-1"></a>Gi_LWard_Local_Density <span class="ot">&lt;-</span> points_sf_joined <span class="sc">%&gt;%</span></span>
<span id="cb327-2"><a href="spatial-autocorrelation.html#cb327-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(density) <span class="sc">%&gt;%</span></span>
<span id="cb327-3"><a href="spatial-autocorrelation.html#cb327-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.vector</span>()<span class="sc">%&gt;%</span></span>
<span id="cb327-4"><a href="spatial-autocorrelation.html#cb327-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">localG</span>(., Lward.lw)</span>
<span id="cb327-5"><a href="spatial-autocorrelation.html#cb327-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb327-6"><a href="spatial-autocorrelation.html#cb327-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Gi_LWard_Local_Density)</span></code></pre></div>
<pre><code>## [1] -0.8314871 -0.8679202 -0.7655724 -0.8318337 -0.8318337 -0.7937671</code></pre>
<p>Check the help file (?localG) to see what a localG object looks like</p>
<p><strong>Note</strong> that because of the differences in Moranâ€™s I and Getis Ord <span class="math inline">\(G_{i}^{*}\)</span> there will be differences between polyogons that are classed as significant.</p>
<p>Add the Getis Ord <span class="math inline">\(G_{i}^{*}\)</span> data to the simple featureâ€¦</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="spatial-autocorrelation.html#cb329-1" aria-hidden="true" tabindex="-1"></a>points_sf_joined <span class="ot">&lt;-</span> points_sf_joined <span class="sc">%&gt;%</span></span>
<span id="cb329-2"><a href="spatial-autocorrelation.html#cb329-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">density_G =</span> <span class="fu">as.numeric</span>(Gi_LWard_Local_Density))</span></code></pre></div>
<p>And map the outputsâ€¦</p>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="spatial-autocorrelation.html#cb330-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb330-2"><a href="spatial-autocorrelation.html#cb330-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb330-3"><a href="spatial-autocorrelation.html#cb330-3" aria-hidden="true" tabindex="-1"></a>GIColours<span class="ot">&lt;-</span> <span class="fu">rev</span>(<span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">&quot;RdBu&quot;</span>))</span>
<span id="cb330-4"><a href="spatial-autocorrelation.html#cb330-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb330-5"><a href="spatial-autocorrelation.html#cb330-5" aria-hidden="true" tabindex="-1"></a><span class="co">#now plot on an interactive map</span></span>
<span id="cb330-6"><a href="spatial-autocorrelation.html#cb330-6" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(points_sf_joined) <span class="sc">+</span></span>
<span id="cb330-7"><a href="spatial-autocorrelation.html#cb330-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_polygons</span>(<span class="st">&quot;density_G&quot;</span>,</span>
<span id="cb330-8"><a href="spatial-autocorrelation.html#cb330-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">style=</span><span class="st">&quot;fixed&quot;</span>,</span>
<span id="cb330-9"><a href="spatial-autocorrelation.html#cb330-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">breaks=</span>breaks1,</span>
<span id="cb330-10"><a href="spatial-autocorrelation.html#cb330-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">palette=</span>GIColours,</span>
<span id="cb330-11"><a href="spatial-autocorrelation.html#cb330-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">midpoint=</span><span class="cn">NA</span>,</span>
<span id="cb330-12"><a href="spatial-autocorrelation.html#cb330-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">title=</span><span class="st">&quot;Gi*, Blue Plaques in London&quot;</span>)</span></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-322-1.png" width="672" /></p>
</div>
</div>
<div id="other-variables" class="section level2 hasAnchor" number="7.9">
<h2><span class="header-section-number">7.9</span> Other variables<a href="spatial-autocorrelation.html#other-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The local Moranâ€™s I and <span class="math inline">\(G_{i}^{*}\)</span> statistics for wards clearly show that the density of blue plaques in the centre of the city exhibits strong (and positive) spatial autocorrelation, but neither of these maps are very interesting. Why not try some alternative variables and see what patterns emergeâ€¦ here Iâ€™m going to have a look at Average GSCE scoresâ€¦</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="spatial-autocorrelation.html#cb331-1" aria-hidden="true" tabindex="-1"></a><span class="co">#use head to see what other variables are in the data file</span></span>
<span id="cb331-2"><a href="spatial-autocorrelation.html#cb331-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb331-3"><a href="spatial-autocorrelation.html#cb331-3" aria-hidden="true" tabindex="-1"></a><span class="fu">slice_head</span>(points_sf_joined, <span class="at">n=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## Simple feature collection with 2 features and 9 fields
## Geometry type: POLYGON
## Dimension:     XY
## Bounding box:  xmin: 543417.3 ymin: 183674.3 xmax: 549991.5 ymax: 185809.7
## Projected CRS: OSGB 1936 / British National Grid
## # A tibble: 2 Ã— 10
##   gss_code     density wardnâ€¦Â¹ plaquâ€¦Â²                  geometry plaquâ€¦Â³ plaquâ€¦â´
##   &lt;chr&gt;        [1/m^2] &lt;chr&gt;     &lt;int&gt;             &lt;POLYGON [m]&gt;   &lt;dbl&gt;   &lt;dbl&gt;
## 1 E05000026    7.79e-7 Barkinâ€¦       1 ((543595.5 184832.8, 543â€¦  0.0563   0.656
## 2 E05000027    0       Barkinâ€¦       0 ((547932.4 184916.6, 547â€¦  0.0819   0.687
## # â€¦ with 3 more variables: density_I &lt;dbl&gt;, density_Iz &lt;dbl&gt;, density_G &lt;dbl&gt;,
## #   and abbreviated variable names Â¹â€‹wardname, Â²â€‹plaquecount, Â³â€‹plaque_count_I,
## #   â´â€‹plaque_count_Iz
## # â„¹ Use `colnames()` to see all variable names</code></pre>
<p>Or print out the class of each column like we did in week 2, although we need to drop the geometry.</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="spatial-autocorrelation.html#cb333-1" aria-hidden="true" tabindex="-1"></a>Datatypelist <span class="ot">&lt;-</span> LondonWardsMerged <span class="sc">%&gt;%</span> </span>
<span id="cb333-2"><a href="spatial-autocorrelation.html#cb333-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>()<span class="sc">%&gt;%</span></span>
<span id="cb333-3"><a href="spatial-autocorrelation.html#cb333-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(class) <span class="sc">%&gt;%</span></span>
<span id="cb333-4"><a href="spatial-autocorrelation.html#cb333-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), </span>
<span id="cb333-5"><a href="spatial-autocorrelation.html#cb333-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to=</span><span class="st">&quot;All_variables&quot;</span>, </span>
<span id="cb333-6"><a href="spatial-autocorrelation.html#cb333-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to=</span><span class="st">&quot;Variable_class&quot;</span>)</span>
<span id="cb333-7"><a href="spatial-autocorrelation.html#cb333-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-8"><a href="spatial-autocorrelation.html#cb333-8" aria-hidden="true" tabindex="-1"></a>Datatypelist</span></code></pre></div>
<pre><code>## # A tibble: 3 Ã— 2
##   All_variables                         Variable_class
##   &lt;chr&gt;                                 &lt;chr&gt;         
## 1 GSS_CODE                              character     
## 2 ward_name                             character     
## 3 average_gcse_capped_point_scores_2014 numeric</code></pre>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="spatial-autocorrelation.html#cb335-1" aria-hidden="true" tabindex="-1"></a>I_LWard_Local_GCSE <span class="ot">&lt;-</span> LondonWardsMerged <span class="sc">%&gt;%</span></span>
<span id="cb335-2"><a href="spatial-autocorrelation.html#cb335-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(GSS_CODE)<span class="sc">%&gt;%</span></span>
<span id="cb335-3"><a href="spatial-autocorrelation.html#cb335-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(average_gcse_capped_point_scores_2014) <span class="sc">%&gt;%</span></span>
<span id="cb335-4"><a href="spatial-autocorrelation.html#cb335-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.vector</span>()<span class="sc">%&gt;%</span></span>
<span id="cb335-5"><a href="spatial-autocorrelation.html#cb335-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">localmoran</span>(., Lward.lw)<span class="sc">%&gt;%</span></span>
<span id="cb335-6"><a href="spatial-autocorrelation.html#cb335-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb335-7"><a href="spatial-autocorrelation.html#cb335-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-8"><a href="spatial-autocorrelation.html#cb335-8" aria-hidden="true" tabindex="-1"></a>points_sf_joined <span class="ot">&lt;-</span> points_sf_joined <span class="sc">%&gt;%</span></span>
<span id="cb335-9"><a href="spatial-autocorrelation.html#cb335-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(gss_code)<span class="sc">%&gt;%</span></span>
<span id="cb335-10"><a href="spatial-autocorrelation.html#cb335-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">GCSE_LocIz =</span> <span class="fu">as.numeric</span>(I_LWard_Local_GCSE<span class="sc">$</span>Z.Ii))</span>
<span id="cb335-11"><a href="spatial-autocorrelation.html#cb335-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-12"><a href="spatial-autocorrelation.html#cb335-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-13"><a href="spatial-autocorrelation.html#cb335-13" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(points_sf_joined) <span class="sc">+</span></span>
<span id="cb335-14"><a href="spatial-autocorrelation.html#cb335-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_polygons</span>(<span class="st">&quot;GCSE_LocIz&quot;</span>,</span>
<span id="cb335-15"><a href="spatial-autocorrelation.html#cb335-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">style=</span><span class="st">&quot;fixed&quot;</span>,</span>
<span id="cb335-16"><a href="spatial-autocorrelation.html#cb335-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">breaks=</span>breaks1,</span>
<span id="cb335-17"><a href="spatial-autocorrelation.html#cb335-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">palette=</span>MoranColours,</span>
<span id="cb335-18"><a href="spatial-autocorrelation.html#cb335-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">midpoint=</span><span class="cn">NA</span>,</span>
<span id="cb335-19"><a href="spatial-autocorrelation.html#cb335-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">title=</span><span class="st">&quot;Local Moran&#39;s I, GCSE Scores&quot;</span>)</span></code></pre></div>
<p>Now the Gi* statistic to look at clusters of high and low scores and explain what the output map is showing and what other questions this can lead us to ask next weekâ€¦..</p>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="spatial-autocorrelation.html#cb336-1" aria-hidden="true" tabindex="-1"></a>G_LWard_Local_GCSE <span class="ot">&lt;-</span> LondonWardsMerged <span class="sc">%&gt;%</span></span>
<span id="cb336-2"><a href="spatial-autocorrelation.html#cb336-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(GSS_CODE)<span class="sc">%&gt;%</span></span>
<span id="cb336-3"><a href="spatial-autocorrelation.html#cb336-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(average_gcse_capped_point_scores_2014) <span class="sc">%&gt;%</span></span>
<span id="cb336-4"><a href="spatial-autocorrelation.html#cb336-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.vector</span>()<span class="sc">%&gt;%</span></span>
<span id="cb336-5"><a href="spatial-autocorrelation.html#cb336-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">localG</span>(., Lward.lw)</span>
<span id="cb336-6"><a href="spatial-autocorrelation.html#cb336-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb336-7"><a href="spatial-autocorrelation.html#cb336-7" aria-hidden="true" tabindex="-1"></a>points_sf_joined <span class="ot">&lt;-</span> points_sf_joined <span class="sc">%&gt;%</span></span>
<span id="cb336-8"><a href="spatial-autocorrelation.html#cb336-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(gss_code)<span class="sc">%&gt;%</span></span>
<span id="cb336-9"><a href="spatial-autocorrelation.html#cb336-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">GCSE_LocGiz =</span> <span class="fu">as.numeric</span>(G_LWard_Local_GCSE))</span>
<span id="cb336-10"><a href="spatial-autocorrelation.html#cb336-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb336-11"><a href="spatial-autocorrelation.html#cb336-11" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(points_sf_joined) <span class="sc">+</span></span>
<span id="cb336-12"><a href="spatial-autocorrelation.html#cb336-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_polygons</span>(<span class="st">&quot;GCSE_LocGiz&quot;</span>,</span>
<span id="cb336-13"><a href="spatial-autocorrelation.html#cb336-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">style=</span><span class="st">&quot;fixed&quot;</span>,</span>
<span id="cb336-14"><a href="spatial-autocorrelation.html#cb336-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">breaks=</span>breaks1,</span>
<span id="cb336-15"><a href="spatial-autocorrelation.html#cb336-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">palette=</span>GIColours,</span>
<span id="cb336-16"><a href="spatial-autocorrelation.html#cb336-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">midpoint=</span><span class="cn">NA</span>,</span>
<span id="cb336-17"><a href="spatial-autocorrelation.html#cb336-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">title=</span><span class="st">&quot;Gi*, GCSE Scores&quot;</span>)</span></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-326-1.png" width="672" /></p>
<p>So this is the end of the practical. Hopefully you have learned a lot about the different methods we can employ to analyse patterns in spatial data.</p>
</div>
<div id="feedback-5" class="section level2 hasAnchor" number="7.10">
<h2><span class="header-section-number">7.10</span> Feedback<a href="spatial-autocorrelation.html#feedback-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Was anything that we explained unclear this week or was something really clearâ€¦let us know using the <a href="https://forms.gle/w2GUDYc7tSavGy7r6">feedback form</a>. Itâ€™s anonymous and weâ€™ll use the responses to clear any issues up in the future / adapt the material.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="detecting-spatial-patterns.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="explaining-spatial-patterns.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/andrewmaclachlan/CASA0005repo/edit/master/07-prac7.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["https://github.com/andrewmaclachlan/CASA0005repo/raw/master/07-prac7.Rmd"],
"search": {
"engine": "fuse",
"options": {
"includeScore": true
}
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
